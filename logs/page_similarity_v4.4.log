2023-09-13 07:49:40,290 [INFO] - Load pretrained SentenceTransformer: distilbert-base-nli-mean-tokens
2023-09-13 07:49:40,294 [DEBUG] - Starting new HTTPS connection (1): huggingface.co:443
2023-09-13 07:49:42,785 [DEBUG] - https://huggingface.co:443 "GET /api/models/sentence-transformers/distilbert-base-nli-mean-tokens HTTP/1.1" 200 1389
2023-09-13 07:49:43,224 [DEBUG] - https://huggingface.co:443 "HEAD /sentence-transformers/distilbert-base-nli-mean-tokens/resolve/683b927b0b0f77e70b9a7d15f7f7601a515925a9/.gitattributes HTTP/1.1" 200 0
2023-09-13 07:49:43,225 [DEBUG] - Attempting to acquire lock 1960143289408 on C:\Users\Umi/.cache\torch\sentence_transformers\sentence-transformers_distilbert-base-nli-mean-tokens\.gitattributes.lock
2023-09-13 07:49:43,258 [DEBUG] - Lock 1960143289408 acquired on C:\Users\Umi/.cache\torch\sentence_transformers\sentence-transformers_distilbert-base-nli-mean-tokens\.gitattributes.lock
2023-09-13 07:49:44,043 [DEBUG] - https://huggingface.co:443 "GET /sentence-transformers/distilbert-base-nli-mean-tokens/resolve/683b927b0b0f77e70b9a7d15f7f7601a515925a9/.gitattributes HTTP/1.1" 200 690
2023-09-13 07:49:44,078 [DEBUG] - Attempting to release lock 1960143289408 on C:\Users\Umi/.cache\torch\sentence_transformers\sentence-transformers_distilbert-base-nli-mean-tokens\.gitattributes.lock
2023-09-13 07:49:44,078 [DEBUG] - Lock 1960143289408 released on C:\Users\Umi/.cache\torch\sentence_transformers\sentence-transformers_distilbert-base-nli-mean-tokens\.gitattributes.lock
2023-09-13 07:49:44,497 [DEBUG] - https://huggingface.co:443 "HEAD /sentence-transformers/distilbert-base-nli-mean-tokens/resolve/683b927b0b0f77e70b9a7d15f7f7601a515925a9/1_Pooling/config.json HTTP/1.1" 200 0
2023-09-13 07:49:44,498 [DEBUG] - Attempting to acquire lock 1960143289504 on C:\Users\Umi/.cache\torch\sentence_transformers\sentence-transformers_distilbert-base-nli-mean-tokens\1_Pooling\config.json.lock
2023-09-13 07:49:44,498 [DEBUG] - Lock 1960143289504 acquired on C:\Users\Umi/.cache\torch\sentence_transformers\sentence-transformers_distilbert-base-nli-mean-tokens\1_Pooling\config.json.lock
2023-09-13 07:49:44,929 [DEBUG] - https://huggingface.co:443 "GET /sentence-transformers/distilbert-base-nli-mean-tokens/resolve/683b927b0b0f77e70b9a7d15f7f7601a515925a9/1_Pooling/config.json HTTP/1.1" 200 190
2023-09-13 07:49:44,933 [DEBUG] - Attempting to release lock 1960143289504 on C:\Users\Umi/.cache\torch\sentence_transformers\sentence-transformers_distilbert-base-nli-mean-tokens\1_Pooling\config.json.lock
2023-09-13 07:49:44,933 [DEBUG] - Lock 1960143289504 released on C:\Users\Umi/.cache\torch\sentence_transformers\sentence-transformers_distilbert-base-nli-mean-tokens\1_Pooling\config.json.lock
2023-09-13 07:49:45,352 [DEBUG] - https://huggingface.co:443 "HEAD /sentence-transformers/distilbert-base-nli-mean-tokens/resolve/683b927b0b0f77e70b9a7d15f7f7601a515925a9/README.md HTTP/1.1" 200 0
2023-09-13 07:49:45,354 [DEBUG] - Attempting to acquire lock 1960143290128 on C:\Users\Umi/.cache\torch\sentence_transformers\sentence-transformers_distilbert-base-nli-mean-tokens\README.md.lock
2023-09-13 07:49:45,355 [DEBUG] - Lock 1960143290128 acquired on C:\Users\Umi/.cache\torch\sentence_transformers\sentence-transformers_distilbert-base-nli-mean-tokens\README.md.lock
2023-09-13 07:49:46,095 [DEBUG] - https://huggingface.co:443 "GET /sentence-transformers/distilbert-base-nli-mean-tokens/resolve/683b927b0b0f77e70b9a7d15f7f7601a515925a9/README.md HTTP/1.1" 200 3988
2023-09-13 07:49:46,101 [DEBUG] - Attempting to release lock 1960143290128 on C:\Users\Umi/.cache\torch\sentence_transformers\sentence-transformers_distilbert-base-nli-mean-tokens\README.md.lock
2023-09-13 07:49:46,102 [DEBUG] - Lock 1960143290128 released on C:\Users\Umi/.cache\torch\sentence_transformers\sentence-transformers_distilbert-base-nli-mean-tokens\README.md.lock
2023-09-13 07:49:46,507 [DEBUG] - https://huggingface.co:443 "HEAD /sentence-transformers/distilbert-base-nli-mean-tokens/resolve/683b927b0b0f77e70b9a7d15f7f7601a515925a9/config.json HTTP/1.1" 200 0
2023-09-13 07:49:46,509 [DEBUG] - Attempting to acquire lock 1960143289936 on C:\Users\Umi/.cache\torch\sentence_transformers\sentence-transformers_distilbert-base-nli-mean-tokens\config.json.lock
2023-09-13 07:49:46,511 [DEBUG] - Lock 1960143289936 acquired on C:\Users\Umi/.cache\torch\sentence_transformers\sentence-transformers_distilbert-base-nli-mean-tokens\config.json.lock
2023-09-13 07:49:46,928 [DEBUG] - https://huggingface.co:443 "GET /sentence-transformers/distilbert-base-nli-mean-tokens/resolve/683b927b0b0f77e70b9a7d15f7f7601a515925a9/config.json HTTP/1.1" 200 550
2023-09-13 07:49:46,932 [DEBUG] - Attempting to release lock 1960143289936 on C:\Users\Umi/.cache\torch\sentence_transformers\sentence-transformers_distilbert-base-nli-mean-tokens\config.json.lock
2023-09-13 07:49:46,932 [DEBUG] - Lock 1960143289936 released on C:\Users\Umi/.cache\torch\sentence_transformers\sentence-transformers_distilbert-base-nli-mean-tokens\config.json.lock
2023-09-13 07:49:47,367 [DEBUG] - https://huggingface.co:443 "HEAD /sentence-transformers/distilbert-base-nli-mean-tokens/resolve/683b927b0b0f77e70b9a7d15f7f7601a515925a9/config_sentence_transformers.json HTTP/1.1" 200 0
2023-09-13 07:49:47,368 [DEBUG] - Attempting to acquire lock 1960143290080 on C:\Users\Umi/.cache\torch\sentence_transformers\sentence-transformers_distilbert-base-nli-mean-tokens\config_sentence_transformers.json.lock
2023-09-13 07:49:47,369 [DEBUG] - Lock 1960143290080 acquired on C:\Users\Umi/.cache\torch\sentence_transformers\sentence-transformers_distilbert-base-nli-mean-tokens\config_sentence_transformers.json.lock
2023-09-13 07:49:47,781 [DEBUG] - https://huggingface.co:443 "GET /sentence-transformers/distilbert-base-nli-mean-tokens/resolve/683b927b0b0f77e70b9a7d15f7f7601a515925a9/config_sentence_transformers.json HTTP/1.1" 200 122
2023-09-13 07:49:47,788 [DEBUG] - Attempting to release lock 1960143290080 on C:\Users\Umi/.cache\torch\sentence_transformers\sentence-transformers_distilbert-base-nli-mean-tokens\config_sentence_transformers.json.lock
2023-09-13 07:49:47,788 [DEBUG] - Lock 1960143290080 released on C:\Users\Umi/.cache\torch\sentence_transformers\sentence-transformers_distilbert-base-nli-mean-tokens\config_sentence_transformers.json.lock
2023-09-13 07:49:48,616 [DEBUG] - https://huggingface.co:443 "HEAD /sentence-transformers/distilbert-base-nli-mean-tokens/resolve/683b927b0b0f77e70b9a7d15f7f7601a515925a9/pytorch_model.bin HTTP/1.1" 302 0
2023-09-13 07:49:48,618 [DEBUG] - Attempting to acquire lock 1960143289936 on C:\Users\Umi/.cache\torch\sentence_transformers\sentence-transformers_distilbert-base-nli-mean-tokens\pytorch_model.bin.lock
2023-09-13 07:49:48,619 [DEBUG] - Lock 1960143289936 acquired on C:\Users\Umi/.cache\torch\sentence_transformers\sentence-transformers_distilbert-base-nli-mean-tokens\pytorch_model.bin.lock
2023-09-13 07:49:48,624 [DEBUG] - Starting new HTTPS connection (1): cdn-lfs.huggingface.co:443
2023-09-13 07:49:50,704 [DEBUG] - https://cdn-lfs.huggingface.co:443 "GET /sentence-transformers/distilbert-base-nli-mean-tokens/5d4551851fc88a3b212a38316b255c3c160b768c167a982e9570fd2e482fe10e?response-content-disposition=attachment%3B+filename*%3DUTF-8%27%27pytorch_model.bin%3B+filename%3D%22pytorch_model.bin%22%3B&response-content-type=application%2Foctet-stream&Expires=1694866709&Policy=eyJTdGF0ZW1lbnQiOlt7IkNvbmRpdGlvbiI6eyJEYXRlTGVzc1RoYW4iOnsiQVdTOkVwb2NoVGltZSI6MTY5NDg2NjcwOX19LCJSZXNvdXJjZSI6Imh0dHBzOi8vY2RuLWxmcy5odWdnaW5nZmFjZS5jby9zZW50ZW5jZS10cmFuc2Zvcm1lcnMvZGlzdGlsYmVydC1iYXNlLW5saS1tZWFuLXRva2Vucy81ZDQ1NTE4NTFmYzg4YTNiMjEyYTM4MzE2YjI1NWMzYzE2MGI3NjhjMTY3YTk4MmU5NTcwZmQyZTQ4MmZlMTBlP3Jlc3BvbnNlLWNvbnRlbnQtZGlzcG9zaXRpb249KiZyZXNwb25zZS1jb250ZW50LXR5cGU9KiJ9XX0_&Signature=eNBzMF7BBl9zHxlyop7EHjgJxcyN6j~SZzgWp5tXQH0Rm0SkvF~xraQLc-lz8YtpvjUf6M39LylXOvCPyv3WtxlZk6BSYYKWXsS~H4s~RTjCx-3Nn5F-n5akonl5QhdvAxBWe1bxExMsNYMofrgLk-xb0N~c4Pt2AQHBTQ6q5bA18uc2YTnZTB7-6FSt177SpstbpKp~894Pd~yz24-m3XQ3cNZB6VSP5adSrTah9PmzH-4xoIC~AfoXBYEbhzA9wHs4g6iOnMSpDMkEzi4MoOBxwZJnCgAm8WKtqq3s9cxJtzqgyrAq-Biqtl9ug6KSGneIK-S3BLOQfdBnRPFvuw__&Key-Pair-Id=KVTP0A1DKRTAX HTTP/1.1" 200 265486777
2023-09-13 07:54:50,671 [DEBUG] - Attempting to release lock 1960143289936 on C:\Users\Umi/.cache\torch\sentence_transformers\sentence-transformers_distilbert-base-nli-mean-tokens\pytorch_model.bin.lock
2023-09-13 07:54:50,671 [DEBUG] - Lock 1960143289936 released on C:\Users\Umi/.cache\torch\sentence_transformers\sentence-transformers_distilbert-base-nli-mean-tokens\pytorch_model.bin.lock
2023-09-13 07:54:50,677 [DEBUG] - Resetting dropped connection: huggingface.co
2023-09-13 07:54:53,006 [DEBUG] - https://huggingface.co:443 "HEAD /sentence-transformers/distilbert-base-nli-mean-tokens/resolve/683b927b0b0f77e70b9a7d15f7f7601a515925a9/sentence_bert_config.json HTTP/1.1" 200 0
2023-09-13 07:54:53,007 [DEBUG] - Attempting to acquire lock 1960143289888 on C:\Users\Umi/.cache\torch\sentence_transformers\sentence-transformers_distilbert-base-nli-mean-tokens\sentence_bert_config.json.lock
2023-09-13 07:54:53,008 [DEBUG] - Lock 1960143289888 acquired on C:\Users\Umi/.cache\torch\sentence_transformers\sentence-transformers_distilbert-base-nli-mean-tokens\sentence_bert_config.json.lock
2023-09-13 07:54:53,450 [DEBUG] - https://huggingface.co:443 "GET /sentence-transformers/distilbert-base-nli-mean-tokens/resolve/683b927b0b0f77e70b9a7d15f7f7601a515925a9/sentence_bert_config.json HTTP/1.1" 200 53
2023-09-13 07:54:53,457 [DEBUG] - Attempting to release lock 1960143289888 on C:\Users\Umi/.cache\torch\sentence_transformers\sentence-transformers_distilbert-base-nli-mean-tokens\sentence_bert_config.json.lock
2023-09-13 07:54:53,457 [DEBUG] - Lock 1960143289888 released on C:\Users\Umi/.cache\torch\sentence_transformers\sentence-transformers_distilbert-base-nli-mean-tokens\sentence_bert_config.json.lock
2023-09-13 07:54:53,839 [DEBUG] - https://huggingface.co:443 "HEAD /sentence-transformers/distilbert-base-nli-mean-tokens/resolve/683b927b0b0f77e70b9a7d15f7f7601a515925a9/special_tokens_map.json HTTP/1.1" 200 0
2023-09-13 07:54:53,840 [DEBUG] - Attempting to acquire lock 1960143289408 on C:\Users\Umi/.cache\torch\sentence_transformers\sentence-transformers_distilbert-base-nli-mean-tokens\special_tokens_map.json.lock
2023-09-13 07:54:53,841 [DEBUG] - Lock 1960143289408 acquired on C:\Users\Umi/.cache\torch\sentence_transformers\sentence-transformers_distilbert-base-nli-mean-tokens\special_tokens_map.json.lock
2023-09-13 07:54:54,222 [DEBUG] - https://huggingface.co:443 "GET /sentence-transformers/distilbert-base-nli-mean-tokens/resolve/683b927b0b0f77e70b9a7d15f7f7601a515925a9/special_tokens_map.json HTTP/1.1" 200 112
2023-09-13 07:54:54,226 [DEBUG] - Attempting to release lock 1960143289408 on C:\Users\Umi/.cache\torch\sentence_transformers\sentence-transformers_distilbert-base-nli-mean-tokens\special_tokens_map.json.lock
2023-09-13 07:54:54,226 [DEBUG] - Lock 1960143289408 released on C:\Users\Umi/.cache\torch\sentence_transformers\sentence-transformers_distilbert-base-nli-mean-tokens\special_tokens_map.json.lock
2023-09-13 07:54:54,662 [DEBUG] - https://huggingface.co:443 "HEAD /sentence-transformers/distilbert-base-nli-mean-tokens/resolve/683b927b0b0f77e70b9a7d15f7f7601a515925a9/tokenizer.json HTTP/1.1" 200 0
2023-09-13 07:54:54,663 [DEBUG] - Attempting to acquire lock 1960143290080 on C:\Users\Umi/.cache\torch\sentence_transformers\sentence-transformers_distilbert-base-nli-mean-tokens\tokenizer.json.lock
2023-09-13 07:54:54,663 [DEBUG] - Lock 1960143290080 acquired on C:\Users\Umi/.cache\torch\sentence_transformers\sentence-transformers_distilbert-base-nli-mean-tokens\tokenizer.json.lock
2023-09-13 07:54:55,727 [DEBUG] - https://huggingface.co:443 "GET /sentence-transformers/distilbert-base-nli-mean-tokens/resolve/683b927b0b0f77e70b9a7d15f7f7601a515925a9/tokenizer.json HTTP/1.1" 200 466081
2023-09-13 07:54:58,331 [DEBUG] - Attempting to release lock 1960143290080 on C:\Users\Umi/.cache\torch\sentence_transformers\sentence-transformers_distilbert-base-nli-mean-tokens\tokenizer.json.lock
2023-09-13 07:54:58,331 [DEBUG] - Lock 1960143290080 released on C:\Users\Umi/.cache\torch\sentence_transformers\sentence-transformers_distilbert-base-nli-mean-tokens\tokenizer.json.lock
2023-09-13 07:54:58,743 [DEBUG] - https://huggingface.co:443 "HEAD /sentence-transformers/distilbert-base-nli-mean-tokens/resolve/683b927b0b0f77e70b9a7d15f7f7601a515925a9/tokenizer_config.json HTTP/1.1" 200 0
2023-09-13 07:54:58,745 [DEBUG] - Attempting to acquire lock 1960143289936 on C:\Users\Umi/.cache\torch\sentence_transformers\sentence-transformers_distilbert-base-nli-mean-tokens\tokenizer_config.json.lock
2023-09-13 07:54:58,746 [DEBUG] - Lock 1960143289936 acquired on C:\Users\Umi/.cache\torch\sentence_transformers\sentence-transformers_distilbert-base-nli-mean-tokens\tokenizer_config.json.lock
2023-09-13 07:54:59,146 [DEBUG] - https://huggingface.co:443 "GET /sentence-transformers/distilbert-base-nli-mean-tokens/resolve/683b927b0b0f77e70b9a7d15f7f7601a515925a9/tokenizer_config.json HTTP/1.1" 200 450
2023-09-13 07:54:59,149 [DEBUG] - Attempting to release lock 1960143289936 on C:\Users\Umi/.cache\torch\sentence_transformers\sentence-transformers_distilbert-base-nli-mean-tokens\tokenizer_config.json.lock
2023-09-13 07:54:59,150 [DEBUG] - Lock 1960143289936 released on C:\Users\Umi/.cache\torch\sentence_transformers\sentence-transformers_distilbert-base-nli-mean-tokens\tokenizer_config.json.lock
2023-09-13 07:54:59,537 [DEBUG] - https://huggingface.co:443 "HEAD /sentence-transformers/distilbert-base-nli-mean-tokens/resolve/683b927b0b0f77e70b9a7d15f7f7601a515925a9/vocab.txt HTTP/1.1" 200 0
2023-09-13 07:54:59,538 [DEBUG] - Attempting to acquire lock 1960143289216 on C:\Users\Umi/.cache\torch\sentence_transformers\sentence-transformers_distilbert-base-nli-mean-tokens\vocab.txt.lock
2023-09-13 07:54:59,539 [DEBUG] - Lock 1960143289216 acquired on C:\Users\Umi/.cache\torch\sentence_transformers\sentence-transformers_distilbert-base-nli-mean-tokens\vocab.txt.lock
2023-09-13 07:54:59,939 [DEBUG] - https://huggingface.co:443 "GET /sentence-transformers/distilbert-base-nli-mean-tokens/resolve/683b927b0b0f77e70b9a7d15f7f7601a515925a9/vocab.txt HTTP/1.1" 200 231508
2023-09-13 07:55:00,589 [DEBUG] - Attempting to release lock 1960143289216 on C:\Users\Umi/.cache\torch\sentence_transformers\sentence-transformers_distilbert-base-nli-mean-tokens\vocab.txt.lock
2023-09-13 07:55:00,590 [DEBUG] - Lock 1960143289216 released on C:\Users\Umi/.cache\torch\sentence_transformers\sentence-transformers_distilbert-base-nli-mean-tokens\vocab.txt.lock
2023-09-13 07:55:01,013 [DEBUG] - https://huggingface.co:443 "HEAD /sentence-transformers/distilbert-base-nli-mean-tokens/resolve/683b927b0b0f77e70b9a7d15f7f7601a515925a9/modules.json HTTP/1.1" 200 0
2023-09-13 07:55:01,014 [DEBUG] - Attempting to acquire lock 1960143289504 on C:\Users\Umi/.cache\torch\sentence_transformers\sentence-transformers_distilbert-base-nli-mean-tokens\modules.json.lock
2023-09-13 07:55:01,014 [DEBUG] - Lock 1960143289504 acquired on C:\Users\Umi/.cache\torch\sentence_transformers\sentence-transformers_distilbert-base-nli-mean-tokens\modules.json.lock
2023-09-13 07:55:01,408 [DEBUG] - https://huggingface.co:443 "GET /sentence-transformers/distilbert-base-nli-mean-tokens/resolve/683b927b0b0f77e70b9a7d15f7f7601a515925a9/modules.json HTTP/1.1" 200 229
2023-09-13 07:55:01,411 [DEBUG] - Attempting to release lock 1960143289504 on C:\Users\Umi/.cache\torch\sentence_transformers\sentence-transformers_distilbert-base-nli-mean-tokens\modules.json.lock
2023-09-13 07:55:01,412 [DEBUG] - Lock 1960143289504 released on C:\Users\Umi/.cache\torch\sentence_transformers\sentence-transformers_distilbert-base-nli-mean-tokens\modules.json.lock
2023-09-13 07:55:05,015 [INFO] - Use pytorch device: cpu
2023-09-13 08:23:28,393 [INFO] - Load pretrained SentenceTransformer: distilbert-base-nli-mean-tokens
2023-09-13 08:23:30,216 [INFO] - Use pytorch device: cpu
2023-09-13 08:24:07,204 [INFO] - Load pretrained SentenceTransformer: distilbert-base-nli-mean-tokens
2023-09-13 08:24:09,042 [INFO] - Use pytorch device: cpu
2023-09-13 08:25:44,523 [INFO] - Load pretrained SentenceTransformer: distilbert-base-nli-mean-tokens
2023-09-13 08:25:46,284 [INFO] - Use pytorch device: cpu
2023-09-13 08:25:59,026 [INFO] - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5010
 * Running on http://198.18.192.80:5010
2023-09-13 08:25:59,026 [INFO] - [33mPress CTRL+C to quit[0m
2023-09-13 08:25:59,425 [INFO] -  * Restarting with watchdog (windowsapi)
2023-09-13 08:26:07,509 [INFO] - Load pretrained SentenceTransformer: distilbert-base-nli-mean-tokens
2023-09-13 08:26:09,393 [INFO] - Use pytorch device: cpu
2023-09-13 08:26:09,414 [WARNING] -  * Debugger is active!
2023-09-13 08:26:09,420 [INFO] -  * Debugger PIN: 102-032-839
2023-09-13 08:31:23,172 [INFO] - Load pretrained SentenceTransformer: distilbert-base-nli-mean-tokens
2023-09-13 08:31:24,932 [INFO] - Use pytorch device: cpu
2023-09-13 08:31:24,958 [INFO] - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5010
2023-09-13 08:31:24,958 [INFO] - [33mPress CTRL+C to quit[0m
2023-09-13 08:31:24,974 [INFO] -  * Restarting with watchdog (windowsapi)
2023-09-13 08:31:33,055 [INFO] - Load pretrained SentenceTransformer: distilbert-base-nli-mean-tokens
2023-09-13 08:31:34,870 [INFO] - Use pytorch device: cpu
2023-09-13 08:31:34,886 [WARNING] -  * Debugger is active!
2023-09-13 08:31:34,892 [INFO] -  * Debugger PIN: 102-032-839
2023-09-13 10:46:53,979 [INFO] - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5010
2023-09-13 10:46:54,003 [INFO] - [33mPress CTRL+C to quit[0m
2023-09-13 10:46:54,189 [INFO] -  * Restarting with watchdog (windowsapi)
2023-09-13 10:47:02,480 [WARNING] -  * Debugger is active!
2023-09-13 10:47:02,505 [INFO] -  * Debugger PIN: 102-032-839
2023-09-14 02:15:12,556 [INFO] - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
2023-09-14 02:15:12,583 [INFO] - [33mPress CTRL+C to quit[0m
2023-09-14 02:21:51,417 [INFO] - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
2023-09-14 02:21:51,417 [INFO] - [33mPress CTRL+C to quit[0m
2023-09-14 02:26:19,547 [INFO] - Processing /selected_papers request...
2023-09-14 02:26:19,548 [INFO] - Data received: {'user_id': 'nereus@outlook.com', 'query': 'tell me which features are related to momentum stock trading'}
2023-09-14 02:26:19,720 [DEBUG] - message='Request to OpenAI API' method=post path=https://api.openai.com/v1/chat/completions
2023-09-14 02:26:19,720 [DEBUG] - api_version=None data='{"model": "gpt-4", "messages": [{"role": "system", "content": "You are an AI assistant that provides helpful answers."}, {"role": "user", "content": "\\n    As an AI, I should understand question and provide information about 10 features in a specific format. For each feature, I need to provide feature in following format\\n\\n    1A) Feature Name: The name of the feature\\n    1B) Feature Formula: The mathematical formula for the feature\\n    1C) Feature Definition: A brief description or definition of the feature\\n    1D) Feature Parameters: Parameters or variables used in the feature formula as json format\\n\\n    and number each one incrementally (so feature #2 is 2A, 2B..feature #3 is 3A, feature #4 is 4A, feature #5 is 5A... feature #10 is 10A\\n    This is my question:\\n    tell me which features are related to momentum stock trading\\n\\n    Please provide the 10 feature information according to the above format.\\n    "}], "max_tokens": 2000, "n": 1, "stop": null, "temperature": 0.7}' message='Post details'
2023-09-14 02:26:19,720 [DEBUG] - Converted retries value: 2 -> Retry(total=2, connect=None, read=None, redirect=None, status=None)
2023-09-14 02:26:19,770 [DEBUG] - Starting new HTTPS connection (1): api.openai.com:443
2023-09-14 02:29:53,887 [INFO] - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5010
 * Running on http://198.18.192.20:5010
2023-09-14 02:29:53,887 [INFO] - [33mPress CTRL+C to quit[0m
2023-09-14 02:36:24,263 [INFO] - Processing /selected_papers request...
2023-09-14 02:36:24,264 [INFO] - Data received: {'user_id': 'nereus@outlook.com', 'query': 'tell me which features are related to momentum stock trading'}
2023-09-14 02:36:24,298 [DEBUG] - message='Request to OpenAI API' method=post path=https://api.openai.com/v1/chat/completions
2023-09-14 02:36:24,299 [DEBUG] - api_version=None data='{"model": "gpt-4", "messages": [{"role": "system", "content": "You are an AI assistant that provides helpful answers."}, {"role": "user", "content": "\\n    As an AI, I should understand question and provide information about 10 features in a specific format. For each feature, I need to provide feature in following format\\n\\n    1A) Feature Name: The name of the feature\\n    1B) Feature Formula: The mathematical formula for the feature\\n    1C) Feature Definition: A brief description or definition of the feature\\n    1D) Feature Parameters: Parameters or variables used in the feature formula as json format\\n\\n    and number each one incrementally (so feature #2 is 2A, 2B..feature #3 is 3A, feature #4 is 4A, feature #5 is 5A... feature #10 is 10A\\n    This is my question:\\n    tell me which features are related to momentum stock trading\\n\\n    Please provide the 10 feature information according to the above format.\\n    "}], "max_tokens": 2000, "n": 1, "stop": null, "temperature": 0.7}' message='Post details'
2023-09-14 02:36:24,299 [DEBUG] - Converted retries value: 2 -> Retry(total=2, connect=None, read=None, redirect=None, status=None)
2023-09-14 02:36:24,302 [DEBUG] - Starting new HTTPS connection (1): api.openai.com:443
2023-09-14 02:38:12,891 [DEBUG] - https://api.openai.com:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2023-09-14 02:38:12,911 [DEBUG] - message='OpenAI API response' path=https://api.openai.com/v1/chat/completions processing_ms=105567 request_id=fb65ebf2bb3ae1e7107ebe001c7b3a45 response_code=200
2023-09-14 02:38:13,018 [INFO] - OpenAI API Response: {
  "id": "chatcmpl-7ybBjAQZy2WphWjSs5RQg01sf1yDV",
  "object": "chat.completion",
  "created": 1694676987,
  "model": "gpt-4-0613",
  "choices": [
    {
      "index": 0,
      "message": {
        "role": "assistant",
        "content": "Sure, here are ten features commonly associated with momentum stock trading:\n\n1A) Feature Name: Relative Strength Index (RSI)\n1B) Feature Formula: RSI = 100 - [100 / (1 + (Average of Upward Price Change / Average of Downward Price Change))]\n1C) Feature Definition: An oscillator that measures the speed and change of price movements, typically used to identify overbought or oversold conditions.\n1D) Feature Parameters: {\"Upward Price Change\": \"The sum of price increases over a given period\", \"Downward Price Change\": \"The sum of price decreases over a given period\"}\n\n2A) Feature Name: Moving Average Convergence Divergence (MACD)\n2B) Feature Formula: MACD = 12-Period EMA - 26-Period EMA\n2C) Feature Definition: A trend-following momentum indicator that shows the relationship between two moving averages of a security\u2019s price.\n2D) Feature Parameters: {\"12-Period EMA\": \"12-period exponential moving average\", \"26-Period EMA\": \"26-period exponential moving average\"}\n\n3A) Feature Name: Stochastic Oscillator\n3B) Feature Formula: %K = [(Current Close - Lowest Low)/(Highest High - Lowest Low)]*100\n3C) Feature Definition: A momentum indicator comparing a particular closing price of a security to a range of its prices over a certain period of time.\n3D) Feature Parameters: {\"Current Close\": \"The most recent closing price\", \"Lowest Low\": \"The lowest price over a specific period\", \"Highest High\": \"The highest price over a specific period\"}\n\n4A) Feature Name: Volume\n4B) Feature Formula: Volume = Sum of shares traded during a given period\n4C) Feature Definition: The number of shares or contracts traded in a security or market during a given period.\n4D) Feature Parameters: {\"Shares Traded\": \"The number of shares traded during a specific period\"}\n\n5A) Feature Name: On Balance Volume (OBV)\n5B) Feature Formula: If close > close[1] then OBV = OBV[1] + volume\n5C) Feature Definition: A technical trading momentum indicator that uses volume flow to predict changes in stock price.\n5D) Feature Parameters: {\"Volume\": \"The number of shares or contracts traded in a given period\", \"Close\": \"The closing price of the stock\"}\n\n6A) Feature Name: Average True Range (ATR)\n6B) Feature Formula: ATR = (1/n) * \u03a3 True Range\n6C) Feature Definition: A technical analysis indicator that measures market volatility by decomposing the entire range of an asset price for that period.\n6D) Feature Parameters: {\"True Range\": \"The greatest of the following: Current High less the current Low, the absolute value of the current High less the previous Close, or the absolute value of the current Low less the previous Close\", \"n\": \"Time period\"}\n\n7A) Feature Name: Bollinger Bands\n7B) Feature Formula: Middle Band = 20-day simple moving average (SMA), Upper Band = 20-day SMA + (20-day standard deviation of price x 2), Lower Band = 20-day SMA - (20-day standard deviation of price x 2)\n7C) Feature Definition: A type of statistical chart characterizing the prices and volatility over time of a financial instrument or commodity.\n7D) Feature Parameters: {\"SMA\": \"Simple Moving Average\", \"Standard Deviation\": \"Measure of price volatility\"}\n\n8A) Feature Name: Price Rate of Change (ROC)\n8B) Feature Formula: ROC = [(Close - Close n periods ago) / (Close n periods ago)] * 100\n8C) Feature Definition: A momentum-based technical indicator that measures the percentage change in price between the current price and the price a certain number of periods ago.\n8D) Feature Parameters: {\"Close\": \"The current closing price\", \"Close n periods ago\": \"The closing price n periods ago\"}\n\n9A) Feature Name: Accumulation/Distribution Line\n9B) Feature Formula: A/D = ((Close - Low) - (High - Close)) / (High - Low) * Volume\n9C) Feature Definition: A volume-based indicator designed to measure the cumulative flow of money into and out of a security.\n9D) Feature Parameters: {\"Close\": \"The closing price\", \"High\": \"The highest price during the period\", \"Low\": \"The lowest price during the period\", \"Volume\": \"The volume of shares traded during the period\"}\n\n10A) Feature Name: Money Flow Index (MFI)\n10B) Feature Formula: MFI = 100 - (100 / (1 + Money Ratio))\n10C) Feature Definition: A momentum indicator that measures the flow of money into and out of a security over a specified period.\n10D) Feature Parameters: {\"Money Ratio\": \"The ratio of positive money flow to negative money flow\"}"
      },
      "finish_reason": "stop"
    }
  ],
  "usage": {
    "prompt_tokens": 208,
    "completion_tokens": 1036,
    "total_tokens": 1244
  }
}
2023-09-14 02:38:24,850 [INFO] - 127.0.0.1 - - [14/Sep/2023 02:38:24] "POST /handle_query HTTP/1.1" 200 -
2023-09-14 02:44:09,393 [INFO] - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5010
 * Running on http://198.18.192.20:5010
2023-09-14 02:44:09,394 [INFO] - [33mPress CTRL+C to quit[0m
2023-09-14 02:44:12,685 [INFO] - Processing /selected_papers request...
2023-09-14 02:44:12,686 [INFO] - Data received: {'user_id': 'nereus@outlook.com', 'query': 'tell me which features are related to momentum stock trading'}
2023-09-14 02:44:12,714 [DEBUG] - message='Request to OpenAI API' method=post path=https://api.openai.com/v1/chat/completions
2023-09-14 02:44:12,741 [DEBUG] - api_version=None data='{"model": "gpt-4", "messages": [{"role": "system", "content": "You are an AI assistant that provides helpful answers."}, {"role": "user", "content": "\\n    As an AI, I should understand question and provide information about 10 features in a specific format. For each feature, I need to provide feature in following format\\n\\n    1A) Feature Name: The name of the feature\\n    1B) Feature Formula: The mathematical formula for the feature\\n    1C) Feature Definition: A brief description or definition of the feature\\n    1D) Feature Parameters: Parameters or variables used in the feature formula as json format\\n\\n    and number each one incrementally (so feature #2 is 2A, 2B..feature #3 is 3A, feature #4 is 4A, feature #5 is 5A... feature #10 is 10A\\n    This is my question:\\n    tell me which features are related to momentum stock trading\\n\\n    Please provide the 10 feature information according to the above format.\\n    "}], "max_tokens": 2000, "n": 1, "stop": null, "temperature": 0.7}' message='Post details'
2023-09-14 02:44:12,741 [DEBUG] - Converted retries value: 2 -> Retry(total=2, connect=None, read=None, redirect=None, status=None)
2023-09-14 02:44:12,746 [DEBUG] - Starting new HTTPS connection (1): api.openai.com:443
2023-09-14 02:45:46,869 [DEBUG] - https://api.openai.com:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2023-09-14 02:45:46,870 [DEBUG] - message='OpenAI API response' path=https://api.openai.com/v1/chat/completions processing_ms=91417 request_id=b791374e6185c4caf397905bf46ee1d8 response_code=200
2023-09-14 02:45:46,881 [INFO] - OpenAI API Response: {
  "id": "chatcmpl-7ybJINxnQyyPGL5kjDRrTcZeD4jjp",
  "object": "chat.completion",
  "created": 1694677456,
  "model": "gpt-4-0613",
  "choices": [
    {
      "index": 0,
      "message": {
        "role": "assistant",
        "content": "Sure, here are 10 key features related to momentum stock trading:\n\n1A) Feature Name: Relative Strength Index (RSI)\n1B) Feature Formula: RSI = 100 - (100 / (1 + RS))\n1C) Feature Definition: Measures the speed and change of price movements and is used to identify overbought or oversold conditions.\n1D) Feature Parameters: {\"RS\": \"Average gain of up periods / Average loss of down periods\"}\n\n2A) Feature Name: Moving Average Convergence Divergence (MACD)\n2B) Feature Formula: MACD = 12-Period EMA - 26-Period EMA\n2C) Feature Definition: A trend-following momentum indicator that shows the relationship between two moving averages of a security\u2019s price.\n2D) Feature Parameters: {\"EMA\": \"Exponential Moving Average\"}\n\n3A) Feature Name: Volume\n3B) Feature Formula: Volume = Number of shares traded\n3C) Feature Definition: The number of shares that are traded during a given period of time.\n3D) Feature Parameters: {\"Shares traded\": \"Number of shares traded during a specific period\"}\n\n4A) Feature Name: Price Rate of Change (ROC)\n4B) Feature Formula: ROC = [(Close - Close n periods ago) / (Close n periods ago)] * 100\n4C) Feature Definition: A momentum oscillator, which measures the percentage change between the current price and the n period past price.\n4D) Feature Parameters: {\"Close\": \"Closing price of the stock\", \"n\": \"Number of periods\"}\n\n5A) Feature Name: Stochastic Oscillator\n5B) Feature Formula: %K = [(Current Close - Lowest Low) / (Highest High - Lowest Low)] * 100\n5C) Feature Definition: A momentum indicator comparing a particular closing price of a security to a range of its prices over a certain period of time.\n5D) Feature Parameters: {\"Current Close\": \"Current closing price of the stock\", \"Lowest Low\": \"Lowest price in the given period\", \"Highest High\": \"Highest price in the given period\"}\n\n6A) Feature Name: Average True Range (ATR)\n6B) Feature Formula: ATR = (1/n) \u2211(TR)\n6C) Feature Definition: Measures market volatility by decomposing the entire range of an asset price for that period.\n6D) Feature Parameters: {\"n\": \"Number of periods\", \"TR\": \"True Range\"}\n\n7A) Feature Name: Money Flow Index (MFI)\n7B) Feature Formula: MFI = 100 - (100 / (1 + Money Ratio))\n7C) Feature Definition: A momentum indicator that measures the inflow and outflow of money into a security over a specific period of time.\n7D) Feature Parameters: {\"Money Ratio\": \"Positive Money Flow / Negative Money Flow\"}\n\n8A) Feature Name: On Balance Volume (OBV)\n8B) Feature Formula: If close > close of previous day then OBV = previous OBV + current volume. If close < close of previous day then OBV = previous OBV - current volume.\n8C) Feature Definition: It uses volume flow to predict changes in stock price.\n8D) Feature Parameters: {\"Current volume\": \"Today's volume\", \"Previous OBV\": \"Yesterday's OBV\", \"Close\": \"Today's closing price\", \"Previous Close\": \"Yesterday's closing price\"}\n\n9A) Feature Name: Bollinger Bands\n9B) Feature Formula: Middle Band = 20-day simple moving average (SMA), Upper Band = 20-day SMA + (20-day standard deviation of price x 2), Lower Band = 20-day SMA - (20-day standard deviation of price x 2)\n9C) Feature Definition: A volatility indicator and commonly used in stock trading, it consists of a middle band with two outer bands.\n9D) Feature Parameters: {\"SMA\": \"Simple Moving Average\", \"Standard deviation\": \"Standard deviation of price\"}\n\n10A) Feature Name: Momentum\n10B) Feature Formula: Momentum = V - Vx\n10C) Feature Definition: The rate of acceleration of a security's price or volume.\n10D) Feature Parameters: {\"V\": \"Latest price\", \"Vx\": \"Closing price 'x' number of days ago\"}"
      },
      "finish_reason": "stop"
    }
  ],
  "usage": {
    "prompt_tokens": 208,
    "completion_tokens": 902,
    "total_tokens": 1110
  }
}
2023-09-14 02:45:55,316 [INFO] - 127.0.0.1 - - [14/Sep/2023 02:45:55] "POST /handle_query HTTP/1.1" 200 -
2023-09-14 02:51:16,859 [INFO] - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5010
 * Running on http://198.18.192.20:5010
2023-09-14 02:51:16,859 [INFO] - [33mPress CTRL+C to quit[0m
2023-09-14 02:51:17,769 [INFO] - Processing /selected_papers request...
2023-09-14 02:51:17,770 [INFO] - Data received: {'user_id': 'nereus@outlook.com', 'query': 'tell me which features are related to momentum stock trading'}
2023-09-14 02:51:17,795 [DEBUG] - message='Request to OpenAI API' method=post path=https://api.openai.com/v1/chat/completions
2023-09-14 02:51:17,796 [DEBUG] - api_version=None data='{"model": "gpt-4", "messages": [{"role": "system", "content": "You are an AI assistant that provides helpful answers."}, {"role": "user", "content": "\\n    As an AI, I should understand question and provide information about 10 features in a specific format. For each feature, I need to provide feature in following format\\n\\n    1A) Feature Name: The name of the feature\\n    1B) Feature Formula: The mathematical formula for the feature\\n    1C) Feature Definition: A brief description or definition of the feature\\n    1D) Feature Parameters: Parameters or variables used in the feature formula as json format\\n\\n    and number each one incrementally (so feature #2 is 2A, 2B..feature #3 is 3A, feature #4 is 4A, feature #5 is 5A... feature #10 is 10A\\n    This is my question:\\n    tell me which features are related to momentum stock trading\\n\\n    Please provide the 10 feature information according to the above format.\\n    "}], "max_tokens": 2000, "n": 1, "stop": null, "temperature": 0.7}' message='Post details'
2023-09-14 02:51:17,796 [DEBUG] - Converted retries value: 2 -> Retry(total=2, connect=None, read=None, redirect=None, status=None)
2023-09-14 02:51:17,799 [DEBUG] - Starting new HTTPS connection (1): api.openai.com:443
2023-09-14 02:53:21,516 [DEBUG] - https://api.openai.com:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2023-09-14 02:53:21,517 [DEBUG] - message='OpenAI API response' path=https://api.openai.com/v1/chat/completions processing_ms=115742 request_id=e244517afdb853c19a31d183f7891788 response_code=200
2023-09-14 02:53:21,526 [INFO] - OpenAI API Response: {
  "id": "chatcmpl-7ybQBSFDiEB52cjTvhFQQTbxDYiSR",
  "object": "chat.completion",
  "created": 1694677883,
  "model": "gpt-4-0613",
  "choices": [
    {
      "index": 0,
      "message": {
        "role": "assistant",
        "content": "Sure, here are ten features commonly used in momentum stock trading:\n\n1A) Feature Name: Relative Strength Index (RSI)\n1B) Feature Formula: RSI = 100 - (100 / (1 + RS))\n1C) Feature Definition: RSI is a momentum oscillator that measures the speed and change of price movements.\n1D) Feature Parameters: {\"RS\": \"Average gain / Average loss over a specified period\"}\n\n2A) Feature Name: Moving Average Convergence Divergence (MACD)\n2B) Feature Formula: MACD = 12-day EMA - 26-day EMA\n2C) Feature Definition: MACD is a trend-following momentum indicator that shows the relationship between two moving averages of a security\u2019s price.\n2D) Feature Parameters: {\"EMA\": \"Exponential Moving Average\"}\n\n3A) Feature Name: Stochastic Oscillator\n3B) Feature Formula: %K = (Current Close - Lowest Low)/(Highest High - Lowest Low) * 100\n3C) Feature Definition: The stochastic oscillator is a momentum indicator comparing a particular closing price of a security to a range of its prices over a certain period of time.\n3D) Feature Parameters: {\"Current Close\": \"Most recent closing price\", \"Lowest Low\": \"Lowest price in the look-back period\", \"Highest High\": \"Highest price in the look-back period\"}\n\n4A) Feature Name: On Balance Volume (OBV)\n4B) Feature Formula: If close > close_prev then: OBV = OBV_prev + volume\n4C) Feature Definition: OBV is a technical trading momentum indicator that uses volume flow to predict changes in stock price.\n4D) Feature Parameters: {\"close\": \"Current close price\", \"close_prev\": \"Previous close price\", \"volume\": \"Current trading volume\"}\n\n5A) Feature Name: Accumulation/Distribution Line (A/D Line)\n5B) Feature Formula: A/D = ((Close - Low) - (High - Close)) / (High - Low) * Period's volume\n5C) Feature Definition: A/D Line is a volume-based indicator designed to measure the cumulative flow of money into and out of a security.\n5D) Feature Parameters: {\"Close\": \"Closing price\", \"Low\": \"Lowest price\", \"High\": \"Highest price\", \"Period's volume\": \"Volume for the period\"}\n\n6A) Feature Name: Rate of Change (ROC)\n6B) Feature Formula: ROC = [(Close - Close n periods ago) / (Close n periods ago)] * 100\n6C) Feature Definition: ROC is a momentum oscillator that measures the percentage change in price between the current price and the price a certain number of periods ago.\n6D) Feature Parameters: {\"Close\": \"Current closing price\", \"Close n periods ago\": \"Closing price n periods ago\"}\n\n7A) Feature Name: Volume\n7B) Feature Formula: Volume = Sum of traded shares\n7C) Feature Definition: Volume is the number of shares or contracts traded in a security or market during a given period.\n7D) Feature Parameters: {\"Traded Shares\": \"Number of shares traded during the period\"}\n\n8A) Feature Name: Average True Range (ATR)\n8B) Feature Formula: ATR = (1/n) * (Previous ATR * (n-1) + Current TR)\n8C) Feature Definition: ATR measures market volatility by decomposing the entire range of an asset price for that period.\n8D) Feature Parameters: {\"Previous ATR\": \"The ATR of the previous period\", \"n\": \"Period length\", \"Current TR\": \"Current True Range\"}\n\n9A) Feature Name: Momentum\n9B) Feature Formula: Momentum = Current Price \u2013 Price n periods ago\n9C) Feature Definition: Momentum is the rate of acceleration of a security's price or volume.\n9D) Feature Parameters: {\"Current Price\": \"Current price of the stock\", \"Price n periods ago\": \"Price of the stock n periods ago\"}\n\n10A) Feature Name: Commodity Channel Index (CCI)\n10B) Feature Formula: CCI = (Typical Price - Simple Moving Average) / (0.015 * Mean Deviation)\n10C) Feature Definition: CCI is a versatile indicator that can be used to identify a new trend or warn of extreme conditions.\n10D) Feature Parameters: {\"Typical Price\": \"(High + Low + Close)/3\", \"Simple Moving Average\": \"Average price over a specified number of periods\", \"Mean Deviation\": \"Average of absolute differences between typical price and SMA\"}"
      },
      "finish_reason": "stop"
    }
  ],
  "usage": {
    "prompt_tokens": 208,
    "completion_tokens": 952,
    "total_tokens": 1160
  }
}
2023-09-14 02:53:25,290 [INFO] - 127.0.0.1 - - [14/Sep/2023 02:53:25] "POST /handle_query HTTP/1.1" 200 -
2023-09-14 02:57:09,584 [INFO] - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5010
 * Running on http://198.18.192.20:5010
2023-09-14 02:57:09,584 [INFO] - [33mPress CTRL+C to quit[0m
2023-09-14 02:59:40,430 [INFO] - Processing /selected_papers request...
2023-09-14 02:59:40,430 [INFO] - Data received: {'user_id': 'nereus@outlook.com', 'query': 'tell me which features are related to momentum stock trading'}
2023-09-14 02:59:40,474 [DEBUG] - message='Request to OpenAI API' method=post path=https://api.openai.com/v1/chat/completions
2023-09-14 02:59:40,474 [DEBUG] - api_version=None data='{"model": "gpt-4", "messages": [{"role": "system", "content": "You are an AI assistant that provides helpful answers."}, {"role": "user", "content": "\\n    As an AI, I should understand question and provide information about 10 features in a specific format. For each feature, I need to provide feature in following format\\n\\n    1A) Feature Name: The name of the feature\\n    1B) Feature Formula: The mathematical formula for the feature\\n    1C) Feature Definition: A brief description or definition of the feature\\n    1D) Feature Parameters: Parameters or variables used in the feature formula as json format\\n\\n    and number each one incrementally (so feature #2 is 2A, 2B..feature #3 is 3A, feature #4 is 4A, feature #5 is 5A... feature #10 is 10A\\n    This is my question:\\n    tell me which features are related to momentum stock trading\\n\\n    Please provide the 10 feature information according to the above format.\\n    "}], "max_tokens": 2000, "n": 1, "stop": null, "temperature": 0.7}' message='Post details'
2023-09-14 02:59:40,475 [DEBUG] - Converted retries value: 2 -> Retry(total=2, connect=None, read=None, redirect=None, status=None)
2023-09-14 02:59:40,478 [DEBUG] - Starting new HTTPS connection (1): api.openai.com:443
2023-09-14 03:01:05,237 [DEBUG] - https://api.openai.com:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2023-09-14 03:01:05,242 [DEBUG] - message='OpenAI API response' path=https://api.openai.com/v1/chat/completions processing_ms=81491 request_id=2abf59a9092952893a566d40c0143f0e response_code=200
2023-09-14 03:01:05,251 [INFO] - OpenAI API Response: {
  "id": "chatcmpl-7ybYHxlLIH1YFAwbcdiOwgSXk7yqc",
  "object": "chat.completion",
  "created": 1694678385,
  "model": "gpt-4-0613",
  "choices": [
    {
      "index": 0,
      "message": {
        "role": "assistant",
        "content": "Sure, here are 10 features related to momentum stock trading:\n\n1A) Feature Name: Relative Strength Index (RSI)\n1B) Feature Formula: RSI = 100 - (100 / (1 + RS))\n1C) Feature Definition: A momentum oscillator that measures the speed and change of price movements.\n1D) Feature Parameters: {\"RS\": \"Average gain / Average loss\"}\n\n2A) Feature Name: Moving Average Convergence Divergence (MACD)\n2B) Feature Formula: MACD = 12-Period EMA - 26-Period EMA\n2C) Feature Definition: A trend-following momentum indicator that shows the relationship between two moving averages of a security\u2019s price.\n2D) Feature Parameters: {\"12-Period EMA\": \"Short-term exponential moving average\", \"26-Period EMA\": \"Long-term exponential moving average\"}\n\n3A) Feature Name: Volume\n3B) Feature Formula: Volume = number of shares or contracts traded in a security or market during a given period.\n3C) Feature Definition: The number of shares or contracts that are traded on average for a particular security.\n3D) Feature Parameters: {\"Number of shares\": \"Number of shares traded\", \"Given period\": \"Time range\"}\n\n4A) Feature Name: Stochastic Oscillator \n4B) Feature Formula: %K = [(C - L5) / (H5 - L5)] * 100\n4C) Feature Definition: A momentum indicator that uses support and resistance levels.\n4D) Feature Parameters: {\"C\": \"Most recent closing price\", \"L5\": \"Lowest price in last 5 periods\", \"H5\": \"Highest price in last 5 periods\"}\n\n5A) Feature Name: Rate of Change (ROC)\n5B) Feature Formula: ROC = [(C - Cn) / Cn] * 100\n5C) Feature Definition: A momentum oscillator that measures the percent change in price from one period to the next.\n5D) Feature Parameters: {\"C\": \"Current price\", \"Cn\": \"Price n periods ago\"}\n\n6A) Feature Name: On Balance Volume (OBV)\n6B) Feature Formula: If close up, then OBV = Previous OBV + Current Volume. If close down, then OBV = Previous OBV - Current Volume.\n6C) Feature Definition: A momentum indicator that uses volume flow to predict changes in stock price.\n6D) Feature Parameters: {\"Previous OBV\": \"Previous On Balance Volume\", \"Current Volume\": \"Current trading volume\"}\n\n7A) Feature Name: Momentum\n7B) Feature Formula: Momentum = V - Vx\n7C) Feature Definition: A measure of the rate of change in prices.\n7D) Feature Parameters: {\"V\": \"Latest price\", \"Vx\": \"Price x time periods ago\"}\n\n8A) Feature Name: Price Rate of Change\n8B) Feature Formula: ROC = (Close price today - Close price \u201cn\u201d day\u2019s ago) / Close price \u201cn\u201d day\u2019s ago\n8C) Feature Definition: A momentum oscillator that measures the price percentage change for a specific period.\n8D) Feature Parameters: {\"Close price today\": \"Today's closing price\", \"Close price \u201cn\u201d day\u2019s ago\": \"Closing price 'n' days ago\"}\n\n9A) Feature Name: Commodity Channel Index (CCI)\n9B) Feature Formula: CCI = (Typical Price - 20-period SMA of TP) / (0.015 x Mean Deviation)\n9C) Feature Definition: A momentum oscillator used to identify cyclical trends in commodities.\n9D) Feature Parameters: {\"Typical Price\": \"(High + Low + Close)/3\", \"20-period SMA of TP\": \"Simple moving average of last 20 periods\", \"Mean Deviation\": \"Average of absolute differences between typical price and mean price\"}\n\n10A) Feature Name: Money Flow Index (MFI)\n10B) Feature Formula: MFI = 100 - (100 / (1 + Money Ratio))\n10C) Feature Definition: A momentum indicator that uses both price and volume to measure buying and selling pressure.\n10D) Feature Parameters: {\"Money Ratio\": \"Positive Money Flow / Negative Money Flow\"}"
      },
      "finish_reason": "stop"
    }
  ],
  "usage": {
    "prompt_tokens": 208,
    "completion_tokens": 882,
    "total_tokens": 1090
  }
}
2023-09-14 03:01:09,127 [INFO] - 127.0.0.1 - - [14/Sep/2023 03:01:09] "POST /handle_query HTTP/1.1" 200 -
2023-09-14 03:04:11,380 [INFO] - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5010
 * Running on http://198.18.192.20:5010
2023-09-14 03:04:11,380 [INFO] - [33mPress CTRL+C to quit[0m
2023-09-14 03:05:53,898 [INFO] - Processing /selected_papers request...
2023-09-14 03:05:53,898 [INFO] - Data received: {'user_id': 'nereus@outlook.com', 'query': 'tell me which features are related to momentum stock trading'}
2023-09-14 03:05:53,963 [DEBUG] - message='Request to OpenAI API' method=post path=https://api.openai.com/v1/chat/completions
2023-09-14 03:05:53,963 [DEBUG] - api_version=None data='{"model": "gpt-4", "messages": [{"role": "system", "content": "You are an AI assistant that provides helpful answers."}, {"role": "user", "content": "\\n    As an AI, I should understand question and provide information about 10 features in a specific format. For each feature, I need to provide feature in following format\\n\\n    1A) Feature Name: The name of the feature\\n    1B) Feature Formula: The mathematical formula for the feature\\n    1C) Feature Definition: A brief description or definition of the feature\\n    1D) Feature Parameters: Parameters or variables used in the feature formula as json format\\n\\n    and number each one incrementally (so feature #2 is 2A, 2B..feature #3 is 3A, feature #4 is 4A, feature #5 is 5A... feature #10 is 10A\\n    This is my question:\\n    tell me which features are related to momentum stock trading\\n\\n    Please provide the 10 feature information according to the above format.\\n    "}], "max_tokens": 2000, "n": 1, "stop": null, "temperature": 0.7}' message='Post details'
2023-09-14 03:05:53,964 [DEBUG] - Converted retries value: 2 -> Retry(total=2, connect=None, read=None, redirect=None, status=None)
2023-09-14 03:05:53,966 [DEBUG] - Starting new HTTPS connection (1): api.openai.com:443
2023-09-14 03:07:41,470 [DEBUG] - https://api.openai.com:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2023-09-14 03:07:41,471 [DEBUG] - message='OpenAI API response' path=https://api.openai.com/v1/chat/completions processing_ms=101581 request_id=1cfc1732e900b3003da8a4485cf2ee94 response_code=200
2023-09-14 03:07:41,480 [INFO] - OpenAI API Response: {
  "id": "chatcmpl-7ybeKwhqcEbxyIOHAFK4zMpuMLtx0",
  "object": "chat.completion",
  "created": 1694678760,
  "model": "gpt-4-0613",
  "choices": [
    {
      "index": 0,
      "message": {
        "role": "assistant",
        "content": "Sure, here are 10 features related to momentum stock trading:\n\n1A) Feature Name: Relative Strength Index (RSI)\n1B) Feature Formula: RSI = 100 - [100 / (1 + (Average of Upward Price Change / Average of Downward Price Change))]\n1C) Feature Definition: Measures the speed and change of price movements. RSI oscillates between zero and 100.\n1D) Feature Parameters: {\"Upward Price Change\": \"Number\", \"Downward Price Change\": \"Number\"}\n\n2A) Feature Name: Moving Average Convergence/Divergence (MACD)\n2B) Feature Formula: MACD= 12-Period EMA - 26-Period EMA\n2C) Feature Definition: It's a trend-following momentum indicator that shows the relationship between two moving averages of a security\u2019s price.\n2D) Feature Parameters: {\"12-Period EMA\": \"Number\", \"26-Period EMA\": \"Number\"}\n\n3A) Feature Name: Stochastic Oscillator\n3B) Feature Formula: %K = [(Current Close - Lowest Low)/(Highest High - Lowest Low)] x 100\n3C) Feature Definition: A momentum indicator comparing a particular closing price of a security to a range of its prices over a certain period of time.\n3D) Feature Parameters: {\"Current Close\": \"Number\", \"Lowest Low\": \"Number\", \"Highest High\": \"Number\"}\n\n4A) Feature Name: Momentum\n4B) Feature Formula: Momentum = Current Price - Price n Periods ago\n4C) Feature Definition: Momentum is the rate of acceleration of a security's price or volume.\n4D) Feature Parameters: {\"Current Price\": \"Number\", \"Price n Periods Ago\": \"Number\"}\n\n5A) Feature Name: Rate of Change (ROC)\n5B) Feature Formula: ROC = [(Close price today - Close price \"n\" day's ago) / Close price \"n\" day's ago)] * 100\n5C) Feature Definition: The Rate of Change is a momentum oscillator, which measures the percentage change between the current price and the n period past price.\n5D) Feature Parameters: {\"Close Price Today\": \"Number\", \"Close Price n Days Ago\": \"Number\"}\n\n6A) Feature Name: On Balance Volume (OBV)\n6B) Feature Formula: If close > close previous then: OBV = OBVprev + volume, otherwise OBV = OBVprev - volume\n6C) Feature Definition: OBV is a technical trading momentum indicator that uses volume flow to predict changes in stock price.\n6D) Feature Parameters: {\"Current Close\": \"Number\", \"Previous Close\": \"Number\", \"Volume\": \"Number\"}\n\n7A) Feature Name: Accumulation/Distribution Line (A/D Line)\n7B) Feature Formula: A/D = ((Close - Low) - (High - Close)) / (High - Low) * Period's volume\n7C) Feature Definition: A/D Line is a volume-based indicator designed to measure the cumulative flow of money into and out of a security.\n7D) Feature Parameters: {\"Close\": \"Number\", \"Low\": \"Number\", \"High\": \"Number\", \"Period's Volume\": \"Number\"}\n\n8A) Feature Name: Average Directional Index (ADX)\n8B) Feature Formula: ADX = 100 * EMA[(+DI14 - -DI14) / (+DI14 + -DI14)]\n8C) Feature Definition: ADX is used to quantify trend strength. ADX calculations are based on a moving average of price range expansion over a given period of time.\n8D) Feature Parameters: {\"+DI14\": \"Number\", \"-DI14\": \"Number\"}\n\n9A) Feature Name: Commodity Channel Index (CCI)\n9B) Feature Formula: CCI = (Typical Price - 20-period SMA of TP) / (0.015 * Mean Deviation)\n9C) Feature Definition: CCI is an oscillator used to help determine when an investment vehicle is reaching a condition of being overbought or oversold.\n9D) Feature Parameters: {\"Typical Price\": \"Number\", \"20-period SMA of TP\": \"Number\", \"Mean Deviation\": \"Number\"}\n\n10A) Feature Name: Aroon Indicator\n10B) Feature Formula: Aroon Up = [(25 - Days Since 25-day High)/25] x 100, Aroon Down = [(25 - Days Since 25-day Low)/25] x 100\n10C) Feature Definition: Aroon Indicator is a technical indicator that is used to identify when trends are likely to change direction.\n10D) Feature Parameters: {\"Days Since 25-day High\": \"Number\", \"Days Since 25-day Low\": \"Number\"}"
      },
      "finish_reason": "stop"
    }
  ],
  "usage": {
    "prompt_tokens": 208,
    "completion_tokens": 995,
    "total_tokens": 1203
  }
}
2023-09-14 03:07:48,264 [INFO] - 127.0.0.1 - - [14/Sep/2023 03:07:48] "POST /handle_query HTTP/1.1" 200 -
2023-09-14 03:13:16,445 [INFO] - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5010
 * Running on http://198.18.192.20:5010
2023-09-14 03:13:16,446 [INFO] - [33mPress CTRL+C to quit[0m
2023-09-14 03:14:57,395 [INFO] - Processing /selected_papers request...
2023-09-14 03:14:57,396 [INFO] - Data received: {'user_id': 'nereus@outlook.com', 'query': 'tell me which features are related to momentum stock trading'}
2023-09-14 03:14:57,421 [DEBUG] - message='Request to OpenAI API' method=post path=https://api.openai.com/v1/chat/completions
2023-09-14 03:14:57,421 [DEBUG] - api_version=None data='{"model": "gpt-4", "messages": [{"role": "system", "content": "You are an AI assistant that provides helpful answers."}, {"role": "user", "content": "\\n    As an AI, I should understand question and provide information about 10 features in a specific format. For each feature, I need to provide feature in following format\\n\\n    1A) Feature Name: The name of the feature\\n    1B) Feature Formula: The mathematical formula for the feature\\n    1C) Feature Definition: A brief description or definition of the feature\\n    1D) Feature Parameters: Parameters or variables used in the feature formula as json format\\n\\n    and number each one incrementally (so feature #2 is 2A, 2B..feature #3 is 3A, feature #4 is 4A, feature #5 is 5A... feature #10 is 10A\\n    This is my question:\\n    tell me which features are related to momentum stock trading\\n\\n    Please provide the 10 feature information according to the above format.\\n    "}], "max_tokens": 2000, "n": 1, "stop": null, "temperature": 0.7}' message='Post details'
2023-09-14 03:14:57,422 [DEBUG] - Converted retries value: 2 -> Retry(total=2, connect=None, read=None, redirect=None, status=None)
2023-09-14 03:14:57,424 [DEBUG] - Starting new HTTPS connection (1): api.openai.com:443
2023-09-14 03:16:44,038 [DEBUG] - https://api.openai.com:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2023-09-14 03:16:44,040 [DEBUG] - message='OpenAI API response' path=https://api.openai.com/v1/chat/completions processing_ms=102657 request_id=1c58a00bfa71641f04803a5f692f2e17 response_code=200
2023-09-14 03:16:44,049 [INFO] - OpenAI API Response: {
  "id": "chatcmpl-7ybn3IWnV81AoC8IxPb8dvvFugjoa",
  "object": "chat.completion",
  "created": 1694679301,
  "model": "gpt-4-0613",
  "choices": [
    {
      "index": 0,
      "message": {
        "role": "assistant",
        "content": "Sure, here you go:\n\n1A) Feature Name: Relative Strength Index (RSI)\n1B) Feature Formula: RSI = 100 - [100 / (1 + RS)]\n1C) Feature Definition: The RSI compares the magnitude of recent gains to recent losses in an attempt to determine overbought and oversold conditions of an asset.\n1D) Feature Parameters: {\"RS\": \"Average Gain / Average Loss\"}\n\n2A) Feature Name: Moving Average Convergence Divergence (MACD)\n2B) Feature Formula: MACD = 12-Period EMA - 26-Period EMA\n2C) Feature Definition: MACD is a trend-following momentum indicator that shows the relationship between two moving averages of a security\u2019s price.\n2D) Feature Parameters: {\"EMA\": \"Exponential Moving Average\"}\n\n3A) Feature Name: Stochastic Oscillator\n3B) Feature Formula: %K = [(Close - Low14)/(High14 - Low14)]*100\n3C) Feature Definition: A stochastic oscillator is a momentum indicator comparing a particular closing price of a security to a range of its prices over a certain period of time.\n3D) Feature Parameters: {\"Close\": \"Closing Price\", \"Low14\": \"Lowest price of the past 14 trading sessions\", \"High14\": \"Highest price of the past 14 trading sessions\"}\n\n4A) Feature Name: Rate of Change (ROC)\n4B) Feature Formula: ROC = [(Close - Close n periods ago) / (Close n periods ago)]*100\n4C) Feature Definition: The Rate of Change is a momentum oscillator, which measures the percentage change between the current price and the n period past price.\n4D) Feature Parameters: {\"Close\": \"Closing Price\"}\n\n5A) Feature Name: On Balance Volume (OBV)\n5B) Feature Formula: If Close > Close of previous day then OBV = OBV(previous day) + Volume\n5C) Feature Definition: The On Balance Volume measures buying and selling pressure as a cumulative indicator, adding volume on up days and subtracting it on down days.\n5D) Feature Parameters: {\"Close\": \"Closing Price\", \"Volume\": \"Trading Volume\"}\n\n6A) Feature Name: Accumulation/Distribution Line (ADL)\n6B) Feature Formula: ADL = ((Close - Low) - (High - Close)) / (High - Low) * Volume\n6C) Feature Definition: The Accumulation/Distribution Line is a volume-based indicator designed to measure the cumulative flow of money into and out of a security.\n6D) Feature Parameters: {\"Close\": \"Closing Price\", \"Low\": \"Lowest Price\", \"High\": \"Highest Price\", \"Volume\": \"Trading Volume\"}\n\n7A) Feature Name: Average Directional Index (ADX)\n7B) Feature Formula: ADX = 100 * smoothed moving average of absolute value (DI+ - DI-) / (DI+ + DI-) \n7C) Feature Definition: The Average Directional Index (ADX) is a technical analysis indicator used by some traders to determine the strength of a trend.\n7D) Feature Parameters: {\"DI+\": \"Positive Directional Indicator\", \"DI-\": \"Negative Directional Indicator\"}\n\n8A) Feature Name: Commodity Channel Index (CCI)\n8B) Feature Formula: CCI = (Typical Price - 20-period SMA of TP) / (.015 * Mean Deviation)\n8C) Feature Definition: The Commodity Channel Index (CCI) is a momentum-based oscillator used to help determine when an investment vehicle is reaching a condition of being overbought or oversold.\n8D) Feature Parameters: {\"TP\": \"Typical Price\", \"SMA\": \"Simple Moving Average\"}\n\n9A) Feature Name: Money Flow Index (MFI)\n9B) Feature Formula: MFI = 100 - (100 / (1 + Money Ratio))\n9C) Feature Definition: The Money Flow Index (MFI) is a momentum indicator that measures the inflow and outflow of money into an asset over a specific period of time.\n9D) Feature Parameters: {\"Money Ratio\": \"Positive Money Flow / Negative Money Flow\"}\n\n10A) Feature Name: Bollinger Bands\n10B) Feature Formula: Middle Band = 20-day simple moving average (SMA), Upper Band = 20-day SMA + (20-day standard deviation of price x 2), Lower Band = 20-day SMA - (20-day standard deviation of price x 2)\n10C) Feature Definition: Bollinger Bands are a volatility indicator and commonly used in stock trading. They consist of a simple moving average (SMA) and two standard deviation lines.\n10D) Feature Parameters: {\"SMA\": \"Simple Moving Average\", \"Standard Deviation\": \"Standard Deviation of Price\"}"
      },
      "finish_reason": "stop"
    }
  ],
  "usage": {
    "prompt_tokens": 208,
    "completion_tokens": 1000,
    "total_tokens": 1208
  }
}
2023-09-14 03:17:01,017 [INFO] - 127.0.0.1 - - [14/Sep/2023 03:17:01] "POST /handle_query HTTP/1.1" 200 -
2023-09-14 03:28:17,738 [INFO] - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5010
 * Running on http://198.18.192.20:5010
2023-09-14 03:28:17,738 [INFO] - [33mPress CTRL+C to quit[0m
2023-09-14 03:28:17,817 [INFO] - Processing /selected_papers request...
2023-09-14 03:28:17,818 [INFO] - Data received: {'user_id': 'nereus@outlook.com', 'query': 'tell me which features are related to momentum stock trading'}
2023-09-14 03:28:17,849 [DEBUG] - message='Request to OpenAI API' method=post path=https://api.openai.com/v1/chat/completions
2023-09-14 03:28:17,850 [DEBUG] - api_version=None data='{"model": "gpt-4", "messages": [{"role": "system", "content": "You are an AI assistant that provides helpful answers."}, {"role": "user", "content": "\\n    As an AI, I should understand question and provide information about 10 features in a specific format. For each feature, I need to provide feature in following format\\n\\n    1A) Feature Name: The name of the feature\\n    1B) Feature Formula: The mathematical formula for the feature\\n    1C) Feature Definition: A brief description or definition of the feature\\n    1D) Feature Parameters: Parameters or variables used in the feature formula as json format\\n\\n    and number each one incrementally (so feature #2 is 2A, 2B..feature #3 is 3A, feature #4 is 4A, feature #5 is 5A... feature #10 is 10A\\n    This is my question:\\n    tell me which features are related to momentum stock trading\\n\\n    Please provide the 10 feature information according to the above format.\\n    "}], "max_tokens": 2000, "n": 1, "stop": null, "temperature": 0.7}' message='Post details'
2023-09-14 03:28:17,850 [DEBUG] - Converted retries value: 2 -> Retry(total=2, connect=None, read=None, redirect=None, status=None)
2023-09-14 03:28:17,852 [DEBUG] - Starting new HTTPS connection (1): api.openai.com:443
2023-09-14 03:30:21,438 [DEBUG] - https://api.openai.com:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2023-09-14 03:30:21,439 [DEBUG] - message='OpenAI API response' path=https://api.openai.com/v1/chat/completions processing_ms=120804 request_id=7e9f948d6e809662293f92213ab4b577 response_code=200
2023-09-14 03:30:21,449 [INFO] - OpenAI API Response: {
  "id": "chatcmpl-7ybzxQFd683pn6ItCFKxXAEtbO5kM",
  "object": "chat.completion",
  "created": 1694680101,
  "model": "gpt-4-0613",
  "choices": [
    {
      "index": 0,
      "message": {
        "role": "assistant",
        "content": "Sure, here are the ten features related to momentum stock trading:\n\n1A) Feature Name: Relative Strength Index (RSI)\n1B) Feature Formula: 100 - (100 / (1 + RS))\n1C) Feature Definition: This is a momentum indicator that measures the speed and change of price movements.\n1D) Feature Parameters: {\"RS\": \"Average gain of up periods during the specified time frame / Average loss of down periods during the specified time frame\"}\n\n2A) Feature Name: Moving Average Convergence Divergence (MACD)\n2B) Feature Formula: (12-Period EMA - 26-Period EMA)\n2C) Feature Definition: MACD is a trend-following momentum indicator that shows the relationship between two moving averages of a security's price.\n2D) Feature Parameters: {\"EMA\": \"Exponential Moving Average\"}\n\n3A) Feature Name: Stochastic Oscillator\n3B) Feature Formula: %K = [(Close - Low14) / (High14 - Low14)] * 100\n3C) Feature Definition: It is a momentum indicator comparing a particular closing price of a security to a range of its prices over a certain period of time.\n3D) Feature Parameters: {\"Close\": \"Closing price\", \"Low14\": \"Lowest price in 14 periods\", \"High14\": \"Highest price in 14 periods\"}\n\n4A) Feature Name: Rate of Change (ROC)\n4B) Feature Formula: [(Close - Close n periods ago) / (Close n periods ago)] * 100\n4C) Feature Definition: The Rate of Change is a momentum oscillator, which measures the percentage change in price between the current price and the price a certain number of periods ago.\n4D) Feature Parameters: {\"Close\": \"Closing price\"}\n\n5A) Feature Name: On Balance Volume (OBV)\n5B) Feature Formula: OBV = Previous OBV + Current Volume (If Close > Previous Close)\n5C) Feature Definition: It is a momentum indicator that uses volume flow to predict changes in stock price.\n5D) Feature Parameters: {\"Volume\": \"Trading volume\"}\n\n6A) Feature Name: Accumulation/Distribution Line (A/D Line)\n6B) Feature Formula: A/D = [(Close - Low) - (High - Close)] / (High - Low) * Period's volume\n6C) Feature Definition: This indicator uses volume and price to assess whether a stock is being accumulated or distributed.\n6D) Feature Parameters: {\"Close\": \"Closing price\", \"Low\": \"Lowest price\", \"High\": \"Highest price\", \"Volume\": \"Trading volume\"}\n\n7A) Feature Name: Average Directional Index (ADX)\n7B) Feature Formula: ADX = 100 * EMA of the absolute value of (+DI - -DI) / (+DI + -DI)\n7C) Feature Definition: ADX is used to quantify trend strength. ADX calculations are based on a moving average of price range expansion over a given period of time.\n7D) Feature Parameters: {\"+DI\": \"Positive Directional Indicator\", \"-DI\": \"Negative Directional Indicator\", \"EMA\": \"Exponential Moving Average\"}\n\n8A) Feature Name: Commodity Channel Index (CCI)\n8B) Feature Formula: CCI = (Typical Price - Simple Moving Average) / (0.015 * Mean Deviation)\n8C) Feature Definition: The Commodity Channel Index is a versatile indicator that can be used to identify a new trend or warn of extreme conditions.\n8D) Feature Parameters: {\"Typical Price\": \"(High + Low + Close)/3\", \"SMA\": \"Simple Moving Average\", \"Mean Deviation\": \"Average of 'n' period absolute deviations\"}\n\n9A) Feature Name: Money Flow Index (MFI)\n9B) Feature Formula: MFI = 100 - (100 / (1 + Money Ratio))\n9C) Feature Definition: The money flow index is a momentum indicator that measures the flow of money into and out of a security over a specified period of time.\n9D) Feature Parameters: {\"Money Ratio\": \"(14-period Positive Money Flow / 14-period Negative Money Flow)\"}\n\n10A) Feature Name: Ultimate Oscillator\n10B) Feature Formula: UO = 100 x [(4 x BP1 + 2 x BP2 + BP3) / (4 x TR1 + 2 x TR2 + TR3)]\n10C) Feature Definition: The Ultimate Oscillator is a technical indicator that uses the weighted average of three different time periods to reduce the volatility and false transaction signals that are associated with many other indicators that mainly rely on a single time period.\n10D) Feature Parameters: {\"BP1\": \"Buying Pressure in the first period\", \"BP2\": \"Buying Pressure in the second period\", \"BP3\": \"Buying Pressure in the third period\", \"TR1\": \"True Range in the first period\", \"TR2\": \"True Range in the second period\", \"TR3\": \"True Range in the third period\"}\n"
      },
      "finish_reason": "stop"
    }
  ],
  "usage": {
    "prompt_tokens": 208,
    "completion_tokens": 1046,
    "total_tokens": 1254
  }
}
2023-09-14 03:30:32,416 [INFO] - 127.0.0.1 - - [14/Sep/2023 03:30:32] "POST /handle_query HTTP/1.1" 200 -
2023-09-14 03:38:22,765 [INFO] - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5010
 * Running on http://198.18.192.20:5010
2023-09-14 03:38:22,765 [INFO] - [33mPress CTRL+C to quit[0m
2023-09-14 03:40:12,903 [INFO] - Processing /selected_papers request...
2023-09-14 03:40:12,904 [INFO] - Data received: {'user_id': 'nereus@outlook.com', 'query': 'tell me which features are related to momentum stock trading'}
2023-09-14 03:40:12,951 [DEBUG] - message='Request to OpenAI API' method=post path=https://api.openai.com/v1/chat/completions
2023-09-14 03:40:12,952 [DEBUG] - api_version=None data='{"model": "gpt-4", "messages": [{"role": "system", "content": "You are an AI assistant that provides helpful answers."}, {"role": "user", "content": "\\n    As an AI, I should understand question and provide information about 10 features in a specific format. For each feature, I need to provide feature in following format\\n\\n    1A) Feature Name: The name of the feature\\n    1B) Feature Formula: The mathematical formula for the feature\\n    1C) Feature Definition: A brief description or definition of the feature\\n    1D) Feature Parameters: Parameters or variables used in the feature formula as json format\\n\\n    and number each one incrementally (so feature #2 is 2A, 2B..feature #3 is 3A, feature #4 is 4A, feature #5 is 5A... feature #10 is 10A\\n    This is my question:\\n    tell me which features are related to momentum stock trading\\n\\n    Please provide the 10 feature information according to the above format.\\n    "}], "max_tokens": 2000, "n": 1, "stop": null, "temperature": 0.7}' message='Post details'
2023-09-14 03:40:12,952 [DEBUG] - Converted retries value: 2 -> Retry(total=2, connect=None, read=None, redirect=None, status=None)
2023-09-14 03:40:12,959 [DEBUG] - Starting new HTTPS connection (1): api.openai.com:443
2023-09-14 03:42:18,051 [DEBUG] - https://api.openai.com:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2023-09-14 03:42:18,100 [DEBUG] - message='OpenAI API response' path=https://api.openai.com/v1/chat/completions processing_ms=118726 request_id=5fb86ca012c308d102e66a5c6a9b1f5d response_code=200
2023-09-14 03:42:18,111 [INFO] - OpenAI API Response: {
  "id": "chatcmpl-7ycBY1HejKxXGiyctY5MveF281yvH",
  "object": "chat.completion",
  "created": 1694680820,
  "model": "gpt-4-0613",
  "choices": [
    {
      "index": 0,
      "message": {
        "role": "assistant",
        "content": "1A) Feature Name: Moving Average\n1B) Feature Formula: MA = (P1 + P2 + P3 + ... + Pn) / n\n1C) Feature Definition: A moving average smoothens out price data by creating a constantly updated average price. It is used to generate buy and sell signals.\n1D) Feature Parameters: {\"P1, P2, P3...Pn\": \"Price at point 1, 2, 3...n\", \"n\": \"Number of periods for average\"}\n\n2A) Feature Name: Momentum\n2B) Feature Formula: Momentum = V - Vx\n2C) Feature Definition: Momentum is the rate of acceleration of a security's price or volume. It is used to identify the strength or weakness of a trend.\n2D) Feature Parameters: {\"V\": \"Current volume\", \"Vx\": \"Volume x periods ago\"}\n\n3A) Feature Name: Relative Strength Index (RSI)\n3B) Feature Formula: RSI = 100 - (100 / (1 + RS))\n3C) Feature Definition: RSI compares the magnitude of recent gains and losses over a specified time period to measure speed and change of price movements.\n3D) Feature Parameters: {\"RS\": \"Average gain / average loss\"}\n\n4A) Feature Name: Moving Average Convergence Divergence (MACD)\n4B) Feature Formula: MACD = 12-Period EMA - 26-Period EMA\n4C) Feature Definition: MACD is a trend-following momentum indicator that shows the relationship between two moving averages of a security\u2019s price.\n4D) Feature Parameters: {\"EMA\": \"Exponential Moving Average\"}\n\n5A) Feature Name: Stochastic Oscillator\n5B) Feature Formula: %K = (Current Close - Lowest Low) / (Highest High - Lowest Low) * 100\n5C) Feature Definition: A stochastic oscillator is a momentum indicator comparing a particular closing price of a security to a range of its prices over a certain period of time.\n5D) Feature Parameters: {\"Current Close\": \"Most recent closing price\", \"Lowest Low\": \"Lowest price in the look-back period\", \"Highest High\": \"Highest price in the look-back period\"}\n\n6A) Feature Name: On Balance Volume (OBV)\n6B) Feature Formula: If close > close(previous day) then OBV = OBV(previous day) + volume\n6C) Feature Definition: On Balance Volume (OBV) measures buying and selling pressure as a cumulative indicator, adding volume on up days and subtracting it on down days.\n6D) Feature Parameters: {\"Close\": \"Closing price of the current and previous day\", \"Volume\": \"Volume of the current day\"}\n\n7A) Feature Name: Accumulation/Distribution Line (A/D)\n7B) Feature Formula: A/D = ((Close - Low) - (High - Close)) / (High - Low) * Period's volume\n7C) Feature Definition: The A/D line is a volume based indicator designed to measure the cumulative flow of money into and out of a security.\n7D) Feature Parameters: {\"Close\": \"Closing price\", \"Low\": \"Lowest price\", \"High\": \"Highest price\", \"Volume\": \"Volume of the current period\"}\n\n8A) Feature Name: Average Directional Index (ADX)\n8B) Feature Formula: ADX = 100 * EMA (|+DI - -DI| / (+DI + -DI))\n8C) Feature Definition: The Average Directional Index (ADX) is used to measure the strength or weakness of a trend, not the actual direction.\n8D) Feature Parameters: {\"EMA\": \"Exponential Moving Average\", \"+DI\": \"Positive Directional Indicator\", \"-DI\": \"Negative Directional Indicator\"}\n\n9A) Feature Name: Commodity Channel Index (CCI)\n9B) Feature Formula: CCI = (Typical Price - MA) / (0.015 * Mean Deviation)\n9C) Feature Definition: The Commodity Channel Index (CCI) is a momentum-based oscillator used to help determine when an investment vehicle is reaching a condition of being overbought or oversold.\n9D) Feature Parameters: {\"Typical Price\": \"(High + Low + Close)/3\", \"MA\": \"Moving Average\", \"Mean Deviation\": \"Average of absolute differences between Typical Price and MA\"}\n\n10A) Feature Name: Rate of Change (ROC)\n10B) Feature Formula: ROC = [(Close - Close n periods ago) / (Close n periods ago)] * 100\n10C) Feature Definition: The Price Rate of Change (ROC) is a momentum-based technical indicator that measures the percentage change in price between the current price and the price a certain number of periods ago.\n10D) Feature Parameters: {\"Close\": \"Current closing price\", \"Close n periods ago\": \"Closing price n periods ago\"}"
      },
      "finish_reason": "stop"
    }
  ],
  "usage": {
    "prompt_tokens": 208,
    "completion_tokens": 1020,
    "total_tokens": 1228
  }
}
2023-09-14 03:42:27,600 [INFO] - feature_name: Moving Average, feature_formula: MA = (P1 + P2 + P3 + ... + Pn) / n,  feature_definition: A moving average smoothens out price data by creating a constantly updated average price. It is used to generate buy and sell signals., feature_parameters: {"P1, P2, P3...Pn": "Price at point 1, 2, 3...n", "n": "Number of periods for average"}
2023-09-14 03:42:27,601 [INFO] - feature_name: Momentum, feature_formula: Momentum = V - Vx,  feature_definition: Momentum is the rate of acceleration of a security's price or volume. It is used to identify the strength or weakness of a trend., feature_parameters: {"V": "Current volume", "Vx": "Volume x periods ago"}
2023-09-14 03:42:27,601 [INFO] - feature_name: Relative Strength Index (RSI), feature_formula: RSI = 100 - (100 / (1 + RS)),  feature_definition: RSI compares the magnitude of recent gains and losses over a specified time period to measure speed and change of price movements., feature_parameters: {"RS": "Average gain / average loss"}
2023-09-14 03:42:27,602 [INFO] - feature_name: Moving Average Convergence Divergence (MACD), feature_formula: MACD = 12-Period EMA - 26-Period EMA,  feature_definition: MACD is a trend-following momentum indicator that shows the relationship between two moving averages of a securitys price., feature_parameters: {"EMA": "Exponential Moving Average"}
2023-09-14 03:42:27,602 [INFO] - feature_name: Stochastic Oscillator, feature_formula: %K = (Current Close - Lowest Low) / (Highest High - Lowest Low) * 100,  feature_definition: A stochastic oscillator is a momentum indicator comparing a particular closing price of a security to a range of its prices over a certain period of time., feature_parameters: {"Current Close": "Most recent closing price", "Lowest Low": "Lowest price in the look-back period", "Highest High": "Highest price in the look-back period"}
2023-09-14 03:42:27,603 [INFO] - feature_name: On Balance Volume (OBV), feature_formula: If close > close(previous day) then OBV = OBV(previous day) + volume,  feature_definition: On Balance Volume (OBV) measures buying and selling pressure as a cumulative indicator, adding volume on up days and subtracting it on down days., feature_parameters: {"Close": "Closing price of the current and previous day", "Volume": "Volume of the current day"}
2023-09-14 03:42:27,604 [INFO] - feature_name: Accumulation/Distribution Line (A/D), feature_formula: A/D = ((Close - Low) - (High - Close)) / (High - Low) * Period's volume,  feature_definition: The A/D line is a volume based indicator designed to measure the cumulative flow of money into and out of a security., feature_parameters: {"Close": "Closing price", "Low": "Lowest price", "High": "Highest price", "Volume": "Volume of the current period"}
2023-09-14 03:42:27,604 [INFO] - feature_name: Average Directional Index (ADX), feature_formula: ADX = 100 * EMA (|+DI - -DI| / (+DI + -DI)),  feature_definition: The Average Directional Index (ADX) is used to measure the strength or weakness of a trend, not the actual direction., feature_parameters: {"EMA": "Exponential Moving Average", "+DI": "Positive Directional Indicator", "-DI": "Negative Directional Indicator"}
2023-09-14 03:42:27,605 [INFO] - feature_name: Commodity Channel Index (CCI), feature_formula: CCI = (Typical Price - MA) / (0.015 * Mean Deviation),  feature_definition: The Commodity Channel Index (CCI) is a momentum-based oscillator used to help determine when an investment vehicle is reaching a condition of being overbought or oversold., feature_parameters: {"Typical Price": "(High + Low + Close)/3", "MA": "Moving Average", "Mean Deviation": "Average of absolute differences between Typical Price and MA"}
2023-09-14 03:42:27,608 [INFO] - 127.0.0.1 - - [14/Sep/2023 03:42:27] "POST /handle_query HTTP/1.1" 200 -
2023-09-14 03:50:04,822 [INFO] - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5010
 * Running on http://198.18.192.20:5010
2023-09-14 03:50:04,822 [INFO] - [33mPress CTRL+C to quit[0m
2023-09-14 03:52:32,261 [INFO] - Processing /selected_papers request...
2023-09-14 03:52:32,262 [INFO] - Data received: {'user_id': 'nereus@outlook.com', 'query': 'tell me which features are related to momentum stock trading'}
2023-09-14 03:52:32,414 [DEBUG] - message='Request to OpenAI API' method=post path=https://api.openai.com/v1/chat/completions
2023-09-14 03:52:32,414 [DEBUG] - api_version=None data='{"model": "gpt-4", "messages": [{"role": "system", "content": "You are an AI assistant that provides helpful answers."}, {"role": "user", "content": "\\n    As an AI, I should understand question and provide information about 10 features in a specific format. For each feature, I need to provide feature in following format\\n\\n    1A) Feature Name: The name of the feature\\n    1B) Feature Formula: The mathematical formula for the feature\\n    1C) Feature Definition: A brief description or definition of the feature\\n    1D) Feature Parameters: Parameters or variables used in the feature formula as json format\\n\\n    and number each one incrementally (so feature #2 is 2A, 2B..feature #3 is 3A, feature #4 is 4A, feature #5 is 5A... feature #10 is 10A\\n    This is my question:\\n    tell me which features are related to momentum stock trading\\n\\n    Please provide the 10 feature information according to the above format.\\n    "}], "max_tokens": 2000, "n": 1, "stop": null, "temperature": 0.7}' message='Post details'
2023-09-14 03:52:32,414 [DEBUG] - Converted retries value: 2 -> Retry(total=2, connect=None, read=None, redirect=None, status=None)
2023-09-14 03:52:32,417 [DEBUG] - Starting new HTTPS connection (1): api.openai.com:443
2023-09-14 03:54:23,859 [DEBUG] - https://api.openai.com:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2023-09-14 03:54:24,531 [DEBUG] - message='OpenAI API response' path=https://api.openai.com/v1/chat/completions processing_ms=108530 request_id=b028c3562b34c2bdf457c7a74fe7c91e response_code=200
2023-09-14 03:54:24,541 [INFO] - OpenAI API Response: {
  "id": "chatcmpl-7ycNQL2hAxBfvr4NjhxwsafbPe7BC",
  "object": "chat.completion",
  "created": 1694681556,
  "model": "gpt-4-0613",
  "choices": [
    {
      "index": 0,
      "message": {
        "role": "assistant",
        "content": "Sure, here are 10 features related to momentum stock trading:\n\n1A) Feature Name: Moving Average\n1B) Feature Formula: MA = (P1 + P2 + P3 + ... + Pn) / n\n1C) Feature Definition: A moving average smooths out price data by creating a constantly updated average price.\n1D) Feature Parameters: {\"P\": \"Price of the stock at a given point in time\", \"n\": \"Number of time periods\"}\n\n2A) Feature Name: Relative Strength Index (RSI)\n2B) Feature Formula: RSI = 100 - (100 / (1 + RS))\n2C) Feature Definition: RSI compares the magnitude of recent gains and losses over a specified time period to measure speed and change of price movements of a security.\n2D) Feature Parameters: {\"RS\": \"Average gain / Average loss\"}\n\n3A) Feature Name: Momentum\n3B) Feature Formula: Momentum = V - Vx days ago\n3C) Feature Definition: Momentum is the rate of acceleration of a security's price or volume.\n3D) Feature Parameters: {\"V\": \"Current Volume\", \"Vx\": \"Volume x days ago\"}\n\n4A) Feature Name: Moving Average Convergence Divergence (MACD)\n4B) Feature Formula: MACD = 12-Period EMA - 26-Period EMA\n4C) Feature Definition: MACD is a trend-following momentum indicator that shows the relationship between two moving averages of a security\u2019s price.\n4D) Feature Parameters: {\"EMA\": \"Exponential Moving Average\"}\n\n5A) Feature Name: Stochastic Oscillator\n5B) Feature Formula: %K = (Current Close - Lowest Low)/(Highest High - Lowest Low) * 100\n5C) Feature Definition: The stochastic oscillator is a momentum indicator comparing a particular closing price of a security to a range of its prices over a certain period of time.\n5D) Feature Parameters: {\"Current Close\": \"Most recent closing price\", \"Lowest Low\": \"Lowest price in the look-back period\", \"Highest High\": \"Highest price in the look-back period\"}\n\n6A) Feature Name: Rate of Change (ROC)\n6B) Feature Formula: ROC = [(Close - Close n periods ago) / (Close n periods ago)] * 100\n6C) Feature Definition: The Rate-of-Change (ROC) indicator, which is also referred to as simply Momentum, is a pure momentum oscillator.\n6D) Feature Parameters: {\"Close\": \"Most recent closing price\", \"n\": \"The look-back period\"}\n\n7A) Feature Name: On Balance Volume (OBV)\n7B) Feature Formula: If close > close_prev then OBV = OBV_prev + volume else if close < close_prev then OBV = OBV_prev - volume\n7C) Feature Definition: On Balance Volume (OBV) measures buying and selling pressure as a cumulative indicator, adding volume on up days and subtracts volume on down days.\n7D) Feature Parameters: {\"close\": \"Closing price of the current day\", \"close_prev\": \"Closing price of the previous day\", \"volume\": \"Volume of the current day\", \"OBV_prev\": \"OBV of the previous day\"}\n\n8A) Feature Name: Accumulation/Distribution Line (ADL)\n8B) Feature Formula: ADL = ((Close - Low) - (High - Close)) / (High - Low) * Volume\n8C) Feature Definition: The Accumulation Distribution Line is a volume-based technical analysis tool designed to measure the cumulative inflow and outflow of money of a security.\n8D) Feature Parameters: {\"Close\": \"Closing price\", \"Low\": \"Lowest price\", \"High\": \"Highest price\", \"Volume\": \"Volume of trades\"}\n\n9A) Feature Name: Money Flow Index (MFI)\n9B) Feature Formula: MFI = 100 - (100 / (1 + Money Flow Ratio))\n9C) Feature Definition: The Money Flow Index (MFI) is an oscillator that uses both price and volume to measure buying and selling pressure.\n9D) Feature Parameters: {\"Money Flow Ratio\": \"Ratio of positive money flow to negative money flow\"}\n\n10A) Feature Name: Average Directional Index (ADX)\n10B) Feature Formula: ADX = 100 * EMA [(+DI - -DI) / (+DI + -DI)]\n10C) Feature Definition: The Average Directional Index (ADX) is used to measure the strength or weakness of a trend, not the actual direction.\n10D) Feature Parameters: {\"+DI\": \"Positive Directional Indicator\", \"-DI\": \"Negative Directional Indicator\", \"EMA\": \"Exponential Moving Average\"}"
      },
      "finish_reason": "stop"
    }
  ],
  "usage": {
    "prompt_tokens": 208,
    "completion_tokens": 985,
    "total_tokens": 1193
  }
}
2023-09-14 03:54:36,107 [ERROR] - Exception on /handle_query [POST]
Traceback (most recent call last):
  File "D:\Workspace\Upwork\5.Refactor Python OpenAI logic\task.py", line 137, in insert_db
    cursor.execute(
psycopg2.errors.SyntaxError: syntax error at or near "feature_from_query"
LINE 1: INSERT feature_from_query (user_id, query, feature_name, fea...
               ^


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\flask\app.py", line 2190, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\flask\app.py", line 1486, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\flask_cors\extension.py", line 176, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\flask\app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\flask\app.py", line 1469, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "D:\Workspace\Upwork\5.Refactor Python OpenAI logic\task.py", line 215, in handle_query
    insert_db(user_id, query, features_info)
  File "D:\Workspace\Upwork\5.Refactor Python OpenAI logic\task.py", line 141, in insert_db
    except error:
UnboundLocalError: local variable 'error' referenced before assignment
2023-09-14 03:54:36,151 [INFO] - 127.0.0.1 - - [14/Sep/2023 03:54:36] "[35m[1mPOST /handle_query HTTP/1.1[0m" 500 -
2023-09-14 04:01:08,412 [INFO] - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5010
 * Running on http://198.18.192.20:5010
2023-09-14 04:01:08,413 [INFO] - [33mPress CTRL+C to quit[0m
2023-09-14 04:01:12,498 [INFO] - Processing /selected_papers request...
2023-09-14 04:01:12,499 [INFO] - Data received: {'user_id': 'nereus@outlook.com', 'query': 'tell me which features are related to momentum stock trading'}
2023-09-14 04:01:12,544 [DEBUG] - message='Request to OpenAI API' method=post path=https://api.openai.com/v1/chat/completions
2023-09-14 04:01:12,544 [DEBUG] - api_version=None data='{"model": "gpt-4", "messages": [{"role": "system", "content": "You are an AI assistant that provides helpful answers."}, {"role": "user", "content": "\\n    As an AI, I should understand question and provide information about 10 features in a specific format. For each feature, I need to provide feature in following format\\n\\n    1A) Feature Name: The name of the feature\\n    1B) Feature Formula: The mathematical formula for the feature\\n    1C) Feature Definition: A brief description or definition of the feature\\n    1D) Feature Parameters: Parameters or variables used in the feature formula as json format\\n\\n    and number each one incrementally (so feature #2 is 2A, 2B..feature #3 is 3A, feature #4 is 4A, feature #5 is 5A... feature #10 is 10A\\n    This is my question:\\n    tell me which features are related to momentum stock trading\\n\\n    Please provide the 10 feature information according to the above format.\\n    "}], "max_tokens": 2000, "n": 1, "stop": null, "temperature": 0.7}' message='Post details'
2023-09-14 04:01:12,544 [DEBUG] - Converted retries value: 2 -> Retry(total=2, connect=None, read=None, redirect=None, status=None)
2023-09-14 04:01:12,547 [DEBUG] - Starting new HTTPS connection (1): api.openai.com:443
2023-09-14 04:03:09,860 [DEBUG] - https://api.openai.com:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2023-09-14 04:03:09,861 [DEBUG] - message='OpenAI API response' path=https://api.openai.com/v1/chat/completions processing_ms=113451 request_id=1b6203ef2c735609f79cc05f492db878 response_code=200
2023-09-14 04:03:09,870 [INFO] - OpenAI API Response: {
  "id": "chatcmpl-7ycVojIPeYskJEjMYmaJvmN4HVI4h",
  "object": "chat.completion",
  "created": 1694682076,
  "model": "gpt-4-0613",
  "choices": [
    {
      "index": 0,
      "message": {
        "role": "assistant",
        "content": "1A) Feature Name: Moving Average Convergence Divergence (MACD)\n1B) Feature Formula: MACD = 12-Period EMA - 26-Period EMA\n1C) Feature Definition: MACD is a trend-following momentum indicator that shows the relationship between two moving averages of a stock\u2019s price.\n1D) Feature Parameters: {\"Periods\": [12, 26], \"EMA\": \"Exponential Moving Average\"}\n\n2A) Feature Name: Relative Strength Index (RSI)\n2B) Feature Formula: RSI = 100 - [100 / (1 + (Average of Upward Price Change / Average of Downward Price Change))]\n2C) Feature Definition: RSI compares the magnitude of recent gains and losses over a specified time period to measure speed and change of price movements of a security.\n2D) Feature Parameters: {\"Average Upward Price Change\": \"Number\", \"Average Downward Price Change\": \"Number\"}\n\n3A) Feature Name: Stochastic Oscillator\n3B) Feature Formula: %K = [(Close - Low14)/(High14 - Low14)] * 100\n3C) Feature Definition: A stochastic oscillator is a momentum indicator comparing a particular closing price of a security to a range of its prices over a certain period of time.\n3D) Feature Parameters: {\"Close\": \"Closing price\", \"Low14\": \"Lowest price over 14 periods\", \"High14\": \"Highest price over 14 periods\"}\n\n4A) Feature Name: Momentum\n4B) Feature Formula: Momentum = V - Vx where V is the latest price, and Vx is the closing price x number of days ago.\n4C) Feature Definition: Momentum is the rate of acceleration of a security's price or volume.\n4D) Feature Parameters: {\"V\": \"Latest price\", \"Vx\": \"Closing price x number of days ago\"}\n\n5A) Feature Name: Bollinger Bands\n5B) Feature Formula: Middle Band = 20-day simple moving average (SMA), Upper Band = 20-day SMA + (20-day standard deviation of price x 2), Lower Band = 20-day SMA - (20-day standard deviation of price x 2)\n5C) Feature Definition: Bollinger Bands are a volatility indicator which creates a band of three lines which are plotted in relation to a security's price.\n5D) Feature Parameters: {\"SMA\": \"Simple Moving Average\", \"Standard Deviation\": \"Standard Deviation of Price\"}\n\n6A) Feature Name: Average Directional Index (ADX)\n6B) Feature Formula: ADX = 100 * EMA of absolute value of DX\n6C) Feature Definition: ADX is used to measure the strength or weakness of a trend, not the actual direction.\n6D) Feature Parameters: {\"EMA\": \"Exponential Moving Average\", \"DX\": \"Directional Movement Index\"}\n\n7A) Feature Name: Volume\n7B) Feature Formula: Volume = Sum of all trades' volume\n7C) Feature Definition: The volume of a stock is the number of shares that traded hands during a given period.\n7D) Feature Parameters: {\"Trade volume\": \"Number of shares traded\"}\n\n8A) Feature Name: On-Balance Volume (OBV)\n8B) Feature Formula: If close > closeprev then OBV = OBVprev + volume else if close < closeprev then OBV = OBVprev - volume\n8C) Feature Definition: OBV is a technical trading momentum indicator that uses volume flow to predict changes in stock price.\n8D) Feature Parameters: {\"Close\": \"Closing price\", \"Closeprev\": \"Previous closing price\", \"OBVprev\": \"Previous OBV\", \"Volume\": \"Volume of trades\"}\n\n9A) Feature Name: Rate of Change (ROC)\n9B) Feature Formula: ROC = [(Close - Close n periods ago) / (Close n periods ago)] * 100\n9C) Feature Definition: ROC is a momentum oscillator that measures the percent change in price from one period to the next.\n9D) Feature Parameters: {\"Close\": \"Closing price\", \"Close n periods ago\": \"Closing price n periods ago\"}\n\n10A) Feature Name: Money Flow Index (MFI)\n10B) Feature Formula: MFI = 100 - (100 / (1 + Money Flow Ratio))\n10C) Feature Definition: MFI is a momentum indicator that measures the inflow and outflow of money into a security over a specific period of time.\n10D) Feature Parameters: {\"Money Flow Ratio\": \"Ratio of positive money flow to negative money flow\"}"
      },
      "finish_reason": "stop"
    }
  ],
  "usage": {
    "prompt_tokens": 208,
    "completion_tokens": 959,
    "total_tokens": 1167
  }
}
2023-09-14 04:03:22,363 [INFO] - feature_name: Moving Average Convergence Divergence (MACD), feature_formula: MACD = 12-Period EMA - 26-Period EMA,  feature_definition: MACD is a trend-following momentum indicator that shows the relationship between two moving averages of a stocks price., feature_parameters: {"Periods": [12, 26], "EMA": "Exponential Moving Average"}
2023-09-14 04:03:22,364 [INFO] - feature_name: Relative Strength Index (RSI), feature_formula: RSI = 100 - [100 / (1 + (Average of Upward Price Change / Average of Downward Price Change))],  feature_definition: RSI compares the magnitude of recent gains and losses over a specified time period to measure speed and change of price movements of a security., feature_parameters: {"Average Upward Price Change": "Number", "Average Downward Price Change": "Number"}
2023-09-14 04:03:22,365 [INFO] - feature_name: Stochastic Oscillator, feature_formula: %K = [(Close - Low14)/(High14 - Low14)] * 100,  feature_definition: A stochastic oscillator is a momentum indicator comparing a particular closing price of a security to a range of its prices over a certain period of time., feature_parameters: {"Close": "Closing price", "Low14": "Lowest price over 14 periods", "High14": "Highest price over 14 periods"}
2023-09-14 04:03:22,365 [INFO] - feature_name: Momentum, feature_formula: Momentum = V - Vx where V is the latest price, and Vx is the closing price x number of days ago.,  feature_definition: Momentum is the rate of acceleration of a security's price or volume., feature_parameters: {"V": "Latest price", "Vx": "Closing price x number of days ago"}
2023-09-14 04:03:22,366 [INFO] - feature_name: Bollinger Bands, feature_formula: Middle Band = 20-day simple moving average (SMA), Upper Band = 20-day SMA + (20-day standard deviation of price x 2), Lower Band = 20-day SMA - (20-day standard deviation of price x 2),  feature_definition: Bollinger Bands are a volatility indicator which creates a band of three lines which are plotted in relation to a security's price., feature_parameters: {"SMA": "Simple Moving Average", "Standard Deviation": "Standard Deviation of Price"}
2023-09-14 04:03:22,367 [INFO] - feature_name: Average Directional Index (ADX), feature_formula: ADX = 100 * EMA of absolute value of DX,  feature_definition: ADX is used to measure the strength or weakness of a trend, not the actual direction., feature_parameters: {"EMA": "Exponential Moving Average", "DX": "Directional Movement Index"}
2023-09-14 04:03:22,367 [INFO] - feature_name: Volume, feature_formula: Volume = Sum of all trades' volume,  feature_definition: The volume of a stock is the number of shares that traded hands during a given period., feature_parameters: {"Trade volume": "Number of shares traded"}
2023-09-14 04:03:22,368 [INFO] - feature_name: On-Balance Volume (OBV), feature_formula: If close > closeprev then OBV = OBVprev + volume else if close < closeprev then OBV = OBVprev - volume,  feature_definition: OBV is a technical trading momentum indicator that uses volume flow to predict changes in stock price., feature_parameters: {"Close": "Closing price", "Closeprev": "Previous closing price", "OBVprev": "Previous OBV", "Volume": "Volume of trades"}
2023-09-14 04:03:22,368 [INFO] - feature_name: Rate of Change (ROC), feature_formula: ROC = [(Close - Close n periods ago) / (Close n periods ago)] * 100,  feature_definition: ROC is a momentum oscillator that measures the percent change in price from one period to the next., feature_parameters: {"Close": "Closing price", "Close n periods ago": "Closing price n periods ago"}
2023-09-14 04:03:22,372 [INFO] - 127.0.0.1 - - [14/Sep/2023 04:03:22] "POST /handle_query HTTP/1.1" 200 -
2023-09-14 04:05:39,894 [INFO] - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5010
 * Running on http://198.18.192.20:5010
2023-09-14 04:05:39,894 [INFO] - [33mPress CTRL+C to quit[0m
2023-09-14 04:06:22,979 [INFO] - Processing /selected_papers request...
2023-09-14 04:06:22,980 [INFO] - Data received: {'user_id': 'nereus@outlook.com', 'query': 'tell me which features are related to momentum stock trading'}
2023-09-14 04:06:23,018 [DEBUG] - message='Request to OpenAI API' method=post path=https://api.openai.com/v1/chat/completions
2023-09-14 04:06:23,018 [DEBUG] - api_version=None data='{"model": "gpt-4", "messages": [{"role": "system", "content": "You are an AI assistant that provides helpful answers."}, {"role": "user", "content": "\\n    As an AI, I should understand question and provide information about 10 features in a specific format. For each feature, I need to provide feature in following format\\n\\n    1A) Feature Name: The name of the feature\\n    1B) Feature Formula: The mathematical formula for the feature\\n    1C) Feature Definition: A brief description or definition of the feature\\n    1D) Feature Parameters: Parameters or variables used in the feature formula as json format\\n\\n    and number each one incrementally (so feature #2 is 2A, 2B..feature #3 is 3A, feature #4 is 4A, feature #5 is 5A... feature #10 is 10A\\n    This is my question:\\n    tell me which features are related to momentum stock trading\\n\\n    Please provide the 10 feature information according to the above format.\\n    "}], "max_tokens": 2000, "n": 1, "stop": null, "temperature": 0.7}' message='Post details'
2023-09-14 04:06:23,018 [DEBUG] - Converted retries value: 2 -> Retry(total=2, connect=None, read=None, redirect=None, status=None)
2023-09-14 04:06:23,021 [DEBUG] - Starting new HTTPS connection (1): api.openai.com:443
2023-09-14 04:07:51,740 [DEBUG] - https://api.openai.com:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2023-09-14 04:07:56,109 [DEBUG] - message='OpenAI API response' path=https://api.openai.com/v1/chat/completions processing_ms=83662 request_id=904782ff04a9b59aff5fa32f2d7d2764 response_code=200
2023-09-14 04:07:56,118 [INFO] - OpenAI API Response: {
  "id": "chatcmpl-7ycardEEulE6Ez2Tf2AQUWQMFK452",
  "object": "chat.completion",
  "created": 1694682389,
  "model": "gpt-4-0613",
  "choices": [
    {
      "index": 0,
      "message": {
        "role": "assistant",
        "content": "Sure, here are 10 features related to momentum stock trading, in the format you requested:\n\n1A) Feature Name: Relative Strength Index (RSI)\n1B) Feature Formula: RSI = 100 - (100 / (1 + RS))\n1C) Feature Definition: It measures the speed and change of price movements. It's often used to identify overbought or oversold conditions.\n1D) Feature Parameters: {\"RS\": \"Average gain / Average loss\"}\n\n2A) Feature Name: Moving Average Convergence Divergence (MACD)\n2B) Feature Formula: MACD = 12-Period EMA - 26-Period EMA\n2C) Feature Definition: It's used to identify potential buy and sell signals.\n2D) Feature Parameters: {\"EMA\": \"Exponential Moving Average\"}\n\n3A) Feature Name: Stochastic Oscillator\n3B) Feature Formula: %K = (Closing Price - Lowest Low)/(Highest High - Lowest Low) * 100\n3C) Feature Definition: It's a momentum indicator comparing a particular closing price of a security to a range of its prices over a certain period of time.\n3D) Feature Parameters: {\"Closing Price\", \"Lowest Low\", \"Highest High\"}\n\n4A) Feature Name: Average True Range (ATR)\n4B) Feature Formula: ATR = (1/n) * (Previous ATR + Current TR)\n4C) Feature Definition: It measures market volatility by decomposing the entire range of an asset price for that period.\n4D) Feature Parameters: {\"n\": \"selected time period\", \"TR\": \"True Range\"}\n\n5A) Feature Name: Volume\n5B) Feature Formula: No specific formula. It's simply the number of shares or contracts traded in a security or market during a given period.\n5C) Feature Definition: The total quantity of shares exchanged between buyers and sellers.\n5D) Feature Parameters: {\"Shares Traded\"}\n\n6A) Feature Name: On Balance Volume (OBV)\n6B) Feature Formula: If close > previous close then: OBV = previous OBV + current volume. If close < previous close then: OBV = previous OBV - current volume\n6C) Feature Definition: It uses volume flow to predict changes in stock price.\n6D) Feature Parameters: {\"Previous OBV\", \"Current Volume\"}\n\n7A) Feature Name: Money Flow Index (MFI)\n7B) Feature Formula: MFI = 100 - (100 / (1 + Money Ratio))\n7C) Feature Definition: It's a technical oscillator that uses price and volume for identifying overbought or oversold conditions in an asset. \n7D) Feature Parameters: {\"Money Ratio\"}\n\n8A) Feature Name: Bollinger Bands\n8B) Feature Formula: Middle Band = 20-day simple moving average (SMA). Upper Band = 20-day SMA + (20-day standard deviation of price x 2). Lower Band = 20-day SMA - (20-day standard deviation of price x 2)\n8C) Feature Definition: It's a volatility indicator that creates a band of three lines which are plotted in relation to a security's price.\n8D) Feature Parameters: {\"SMA\": \"Simple Moving Average\", \"Standard Deviation\"}\n\n9A) Feature Name: Rate of Change (ROC)\n9B) Feature Formula: ROC = [(Close - Close n periods ago) / (Close n periods ago)] * 100\n9C) Feature Definition: It's a momentum oscillator, which measures the percentage change of price from one period to the next.\n9D) Feature Parameters: {\"Close\", \"n periods ago\"}\n\n10A) Feature Name: Accumulation/Distribution Line (A/D)\n10B) Feature Formula: A/D = ((Close - Low) - (High - Close)) / (High - Low) * Volume + Previous A/D\n10C) Feature Definition: It's a volume-based tool designed to measure the cumulative flow of money into and out of a security.\n10D) Feature Parameters: {\"Close\", \"Low\", \"High\", \"Volume\", \"Previous A/D\"}"
      },
      "finish_reason": "stop"
    }
  ],
  "usage": {
    "prompt_tokens": 208,
    "completion_tokens": 857,
    "total_tokens": 1065
  }
}
2023-09-14 04:08:02,012 [ERROR] - Exception on /handle_query [POST]
Traceback (most recent call last):
  File "D:\Workspace\Upwork\5.Refactor Python OpenAI logic\task.py", line 137, in insert_db
    cursor.execute(
psycopg2.errors.SyntaxError: syntax error at or near "me"
LINE 2:             VALUES (nereus@outlook.com, tell me which featur...
                                                     ^


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\flask\app.py", line 2190, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\flask\app.py", line 1486, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\flask_cors\extension.py", line 176, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\flask\app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\flask\app.py", line 1469, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "D:\Workspace\Upwork\5.Refactor Python OpenAI logic\task.py", line 215, in handle_query
    insert_db(user_id, query, features_info)
  File "D:\Workspace\Upwork\5.Refactor Python OpenAI logic\task.py", line 141, in insert_db
    except error:
UnboundLocalError: local variable 'error' referenced before assignment
2023-09-14 04:08:02,016 [INFO] - 127.0.0.1 - - [14/Sep/2023 04:08:02] "[35m[1mPOST /handle_query HTTP/1.1[0m" 500 -
2023-09-14 04:08:15,520 [INFO] - Processing /selected_papers request...
2023-09-14 04:08:15,521 [INFO] - Data received: {'user_id': 'nereus@outlook.com', 'query': 'tell me which features are related to momentum stock trading'}
2023-09-14 04:08:15,541 [DEBUG] - message='Request to OpenAI API' method=post path=https://api.openai.com/v1/chat/completions
2023-09-14 04:08:15,541 [DEBUG] - api_version=None data='{"model": "gpt-4", "messages": [{"role": "system", "content": "You are an AI assistant that provides helpful answers."}, {"role": "user", "content": "\\n    As an AI, I should understand question and provide information about 10 features in a specific format. For each feature, I need to provide feature in following format\\n\\n    1A) Feature Name: The name of the feature\\n    1B) Feature Formula: The mathematical formula for the feature\\n    1C) Feature Definition: A brief description or definition of the feature\\n    1D) Feature Parameters: Parameters or variables used in the feature formula as json format\\n\\n    and number each one incrementally (so feature #2 is 2A, 2B..feature #3 is 3A, feature #4 is 4A, feature #5 is 5A... feature #10 is 10A\\n    This is my question:\\n    tell me which features are related to momentum stock trading\\n\\n    Please provide the 10 feature information according to the above format.\\n    "}], "max_tokens": 2000, "n": 1, "stop": null, "temperature": 0.7}' message='Post details'
2023-09-14 04:08:15,541 [DEBUG] - Converted retries value: 2 -> Retry(total=2, connect=None, read=None, redirect=None, status=None)
2023-09-14 04:08:15,543 [DEBUG] - Starting new HTTPS connection (1): api.openai.com:443
2023-09-14 04:09:55,284 [DEBUG] - https://api.openai.com:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2023-09-14 04:09:55,697 [DEBUG] - message='OpenAI API response' path=https://api.openai.com/v1/chat/completions processing_ms=95026 request_id=dede05698a8c1a5d53d9afb9f6d99611 response_code=200
2023-09-14 04:09:55,710 [INFO] - OpenAI API Response: {
  "id": "chatcmpl-7yccdUbZ5Y6KTV1p8M7fSbqAjZFkV",
  "object": "chat.completion",
  "created": 1694682499,
  "model": "gpt-4-0613",
  "choices": [
    {
      "index": 0,
      "message": {
        "role": "assistant",
        "content": "Sure, here are the ten features related to momentum stock trading:\n\n1A) Feature Name: Price Rate of Change (ROC)\n1B) Feature Formula: ROC = [(Close price today - Close price n periods ago) / Close price n periods ago] * 100\n1C) Feature Definition: It measures the percentage change in price between the current price and the price a certain number of periods ago.\n1D) Feature Parameters: {\"Close price today\": \"Price of stock at current day\", \"Close price n periods ago\": \"Price of stock n days ago\"}\n\n2A) Feature Name: Relative Strength Index (RSI)\n2B) Feature Formula: RSI = 100 - (100 / (1 + RS))\n2C) Feature Definition: It compares the magnitude of recent gains and losses over a specified time period to measure speed and change of price movements.\n2D) Feature Parameters: {\"RS\": \"Average gain / Average loss\"}\n\n3A) Feature Name: Moving Average Convergence Divergence (MACD)\n3B) Feature Formula: MACD = 12-day EMA - 26-day EMA\n3C) Feature Definition: It is a trend-following momentum indicator that shows the relationship between two moving averages of a security\u2019s price.\n3D) Feature Parameters: {\"EMA\": \"Exponential moving average\"}\n\n4A) Feature Name: Stochastic Oscillator\n4B) Feature Formula: %K = [(Close - Low(n)) / (High(n) - Low(n))] * 100\n4C) Feature Definition: It is a momentum indicator comparing a particular closing price of a security to a range of its prices over a certain period of time.\n4D) Feature Parameters: {\"Close\": \"Closing price\", \"Low(n)\": \"Lowest price over n periods\", \"High(n)\": \"Highest price over n periods\"}\n\n5A) Feature Name: On Balance Volume (OBV)\n5B) Feature Formula: If close > close_prev then OBV = OBV_prev + volume, otherwise OBV = OBV_prev - volume\n5C) Feature Definition: It uses volume flow to predict changes in stock price.\n5D) Feature Parameters: {\"Close\": \"Closing price\", \"Close_prev\": \"Previous closing price\", \"Volume\": \"Volume of trade\", \"OBV_prev\": \"Previous OBV\"}\n\n6A) Feature Name: Average Directional Index (ADX)\n6B) Feature Formula: ADX = 100 * EMA(abs((+DI - -DI) / (+DI + -DI)))\n6C) Feature Definition: It is an indicator that measures trend strength without regard to trend direction.\n6D) Feature Parameters: {\"+DI\": \"Positive Directional Indicator\", \"-DI\": \"Negative Directional Indicator\", \"EMA\": \"Exponential Moving Average\"}\n\n7A) Feature Name: Accumulation/Distribution Line (A/D)\n7B) Feature Formula: A/D = ((Close - Low) - (High - Close)) / (High - Low) * Volume + A/D_prev\n7C) Feature Definition: It measures the cumulative flow of money into and out of a security.\n7D) Feature Parameters: {\"Close\": \"Closing price\", \"Low\": \"Lowest price\", \"High\": \"Highest price\", \"Volume\": \"Volume of trade\", \"A/D_prev\": \"Previous A/D\"}\n\n8A) Feature Name: Commodity Channel Index (CCI)\n8B) Feature Formula: CCI = (Typical Price - 20-period SMA of TP) / (0.015 * Mean Deviation)\n8C) Feature Definition: It is a versatile indicator that can be used to identify a new trend or warn of extreme conditions.\n8D) Feature Parameters: {\"Typical Price\": \"(High + Low + Close)/3\", \"SMA\": \"Simple Moving Average\", \"Mean Deviation\": \"Average of absolute differences between Typical Price and SMA\"}\n\n9A) Feature Name: Momentum\n9B) Feature Formula: Momentum = Close(t) - Close(t-n)\n9C) Feature Definition: It is the rate of acceleration of a security's price or volume.\n9D) Feature Parameters: {\"Close(t)\": \"Closing price at time t\", \"Close(t-n)\": \"Closing price n periods before time t\"}\n\n10A) Feature Name: Money Flow Index (MFI)\n10B) Feature Formula: MFI = 100 - (100 / (1 + Money Ratio))\n10C) Feature Definition: It is a momentum indicator that measures the inflow and outflow of money into a security over a specific period of time.\n10D) Feature Parameters: {\"Money Ratio\": \"(14-period Positive Money Flow / 14-period Negative Money Flow)\"}"
      },
      "finish_reason": "stop"
    }
  ],
  "usage": {
    "prompt_tokens": 208,
    "completion_tokens": 974,
    "total_tokens": 1182
  }
}
2023-09-14 04:10:02,571 [ERROR] - Exception on /handle_query [POST]
Traceback (most recent call last):
  File "D:\Workspace\Upwork\5.Refactor Python OpenAI logic\task.py", line 137, in insert_db
    cursor.execute(
psycopg2.errors.SyntaxError: syntax error at or near "me"
LINE 2:             VALUES (nereus@outlook.com, tell me which featur...
                                                     ^


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\flask\app.py", line 2190, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\flask\app.py", line 1486, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\flask_cors\extension.py", line 176, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\flask\app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\flask\app.py", line 1469, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "D:\Workspace\Upwork\5.Refactor Python OpenAI logic\task.py", line 215, in handle_query
    insert_db(user_id, query, features_info)
  File "D:\Workspace\Upwork\5.Refactor Python OpenAI logic\task.py", line 141, in insert_db
    except error:
UnboundLocalError: local variable 'error' referenced before assignment
2023-09-14 04:10:02,573 [INFO] - 127.0.0.1 - - [14/Sep/2023 04:10:02] "[35m[1mPOST /handle_query HTTP/1.1[0m" 500 -
2023-09-14 04:23:32,438 [INFO] - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5010
 * Running on http://198.18.192.20:5010
2023-09-14 04:23:32,439 [INFO] - [33mPress CTRL+C to quit[0m
2023-09-14 04:25:09,049 [INFO] - Processing /selected_papers request...
2023-09-14 04:25:09,050 [INFO] - Data received: {'user_id': 'nereus@outlook.com', 'query': 'tell me which features are related to momentum stock trading'}
2023-09-14 04:25:09,087 [DEBUG] - message='Request to OpenAI API' method=post path=https://api.openai.com/v1/chat/completions
2023-09-14 04:25:09,087 [DEBUG] - api_version=None data='{"model": "gpt-4", "messages": [{"role": "system", "content": "You are an AI assistant that provides helpful answers."}, {"role": "user", "content": "\\n    As an AI, I should understand question and provide information about 10 features in a specific format. For each feature, I need to provide feature in following format\\n\\n    1A) Feature Name: The name of the feature\\n    1B) Feature Formula: The mathematical formula for the feature\\n    1C) Feature Definition: A brief description or definition of the feature\\n    1D) Feature Parameters: Parameters or variables used in the feature formula as json format\\n\\n    and number each one incrementally (so feature #2 is 2A, 2B..feature #3 is 3A, feature #4 is 4A, feature #5 is 5A... feature #10 is 10A\\n    This is my question:\\n    tell me which features are related to momentum stock trading\\n\\n    Please provide the 10 feature information according to the above format.\\n    "}], "max_tokens": 2000, "n": 1, "stop": null, "temperature": 0.7}' message='Post details'
2023-09-14 04:25:09,088 [DEBUG] - Converted retries value: 2 -> Retry(total=2, connect=None, read=None, redirect=None, status=None)
2023-09-14 04:25:09,091 [DEBUG] - Starting new HTTPS connection (1): api.openai.com:443
2023-09-14 04:27:10,715 [DEBUG] - https://api.openai.com:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2023-09-14 04:27:10,716 [DEBUG] - message='OpenAI API response' path=https://api.openai.com/v1/chat/completions processing_ms=119732 request_id=f65d95c2f31e7b9be9af88cb399819ab response_code=200
2023-09-14 04:27:10,730 [INFO] - OpenAI API Response: {
  "id": "chatcmpl-7ycsxDucNwK5wyuRGwZdeLjJdXbz0",
  "object": "chat.completion",
  "created": 1694683511,
  "model": "gpt-4-0613",
  "choices": [
    {
      "index": 0,
      "message": {
        "role": "assistant",
        "content": "Sure, here are 10 features related to momentum stock trading:\n\n1A) Feature Name: Moving Average\n1B) Feature Formula: MA = (P1+P2+P3...+Pn)/n\n1C) Feature Definition: A moving average is a widely used indicator in technical analysis that helps smooth out price action by filtering out the \u201cnoise\u201d from random price fluctuations.\n1D) Feature Parameters: {\"P\": \"Price of the stock at each period\", \"n\": \"Number of periods\"}\n\n2A) Feature Name: Relative Strength Index (RSI)\n2B) Feature Formula: RSI = 100 - (100 / (1 + RS))\n2C) Feature Definition: The Relative Strength Index is a momentum oscillator that measures the speed and change of price movements.\n2D) Feature Parameters: {\"RS\": \"Average gain / average loss\"}\n\n3A) Feature Name: Moving Average Convergence Divergence (MACD)\n3B) Feature Formula: MACD = 12-Period EMA - 26-Period EMA\n3C) Feature Definition: MACD is a trend-following momentum indicator that shows the relationship between two moving averages of a security\u2019s price.\n3D) Feature Parameters: {\"EMA\": \"Exponential Moving Average\"}\n\n4A) Feature Name: Stochastic Oscillator\n4B) Feature Formula: %K = [(C - L14)/(H14 - L14)] x 100\n4C) Feature Definition: The stochastic oscillator is a momentum indicator comparing a particular closing price of a security to a range of its prices over a certain period of time.\n4D) Feature Parameters: {\"C\": \"the most recent closing price\", \"L14\": \"the low of the 14 previous trading sessions\", \"H14\": \"the highest price traded during the same 14-day period\"}\n\n5A) Feature Name: Price Rate Of Change (ROC)\n5B) Feature Formula: ROC = [(Close - Close n periods ago) / (Close n periods ago)] * 100\n5C) Feature Definition: Price Rate of Change is a momentum-based technical indicator that measures the percentage change in price between the current price and the price a certain number of periods ago.\n5D) Feature Parameters: {\"Close\": \"the most recent closing price\"}\n\n6A) Feature Name: Volume\n6B) Feature Formula: V = \u03a3 Quantity of Shares Traded\n6C) Feature Definition: Volume is the number of shares or contracts traded in a security or market during a given period.\n6D) Feature Parameters: {\"Quantity of Shares Traded\": \"the number of shares traded during a specific period\"}\n\n7A) Feature Name: Momentum\n7B) Feature Formula: Momentum = V - Vx days ago\n7C) Feature Definition: Momentum is the rate of acceleration of a security's price or volume.\n7D) Feature Parameters: {\"V\": \"Current Volume\", \"Vx days ago\": \"Volume x days ago\"}\n\n8A) Feature Name: Bollinger Bands\n8B) Feature Formula: Middle Band = 20-day simple moving average (SMA), Upper Band = 20-day SMA + (20-day standard deviation of price x 2), Lower Band = 20-day SMA - (20-day standard deviation of price x 2)\n8C) Feature Definition: Bollinger Bands are a volatility indicator which creates a band of three lines which are plotted in relation to a security's price.\n8D) Feature Parameters: {\"SMA\": \"Simple Moving Average\", \"Standard Deviation\": \"Statistical measurement of market volatility\"}\n\n9A) Feature Name: On Balance Volume (OBV)\n9B) Feature Formula: If close > close previous day then: OBV = Previous OBV + today's volume. If close < close previous day then: OBV = Previous OBV - today's volume.\n9C) Feature Definition: On Balance Volume is a momentum indicator that uses volume flow to predict changes in stock price.\n9D) Feature Parameters: {\"Close\": \"Closing price of the stock\", \"Volume\": \"Number of shares traded per day\"}\n\n10A) Feature Name: Accumulation/Distribution Line (A/D Line)\n10B) Feature Formula: A/D = ((Close - Low) - (High - Close)) / (High - Low) * Period's volume\n10C) Feature Definition: The A/D line is a volume-based indicator designed to measure the cumulative flow of money into and out of a security.\n10D) Feature Parameters: {\"Close\": \"Closing price of the stock\", \"Low\": \"Lowest price of the stock\", \"High\": \"Highest price of the stock\", \"Volume\": \"Number of shares traded per day\"}"
      },
      "finish_reason": "stop"
    }
  ],
  "usage": {
    "prompt_tokens": 208,
    "completion_tokens": 977,
    "total_tokens": 1185
  }
}
2023-09-14 04:27:16,928 [ERROR] - Exception on /handle_query [POST]
Traceback (most recent call last):
  File "D:\Workspace\Upwork\5.Refactor Python OpenAI logic\task.py", line 139, in insert_db
    f"""INSERT INTO feature_from_query (user_id, query, feature_name, feature_definition, feature_formula, feature_parameters, feature_selected_for_code_gen, init_code_generated_from_openAI, method_code_generated_from_openAI) VALUES ({user_id}, {query}, {feature_name}, {feature_definition}, {feature_formula}, {feature_parameters}, true, {"data":"true"}, {"data":"true"})""")
ValueError: Invalid format specifier

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\flask\app.py", line 2190, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\flask\app.py", line 1486, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\flask_cors\extension.py", line 176, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\flask\app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\flask\app.py", line 1469, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "D:\Workspace\Upwork\5.Refactor Python OpenAI logic\task.py", line 215, in handle_query
    insert_db(user_id, query, features_info)
  File "D:\Workspace\Upwork\5.Refactor Python OpenAI logic\task.py", line 141, in insert_db
    except error:
UnboundLocalError: local variable 'error' referenced before assignment
2023-09-14 04:27:16,930 [INFO] - 127.0.0.1 - - [14/Sep/2023 04:27:16] "[35m[1mPOST /handle_query HTTP/1.1[0m" 500 -
2023-09-14 04:31:03,051 [INFO] - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5010
 * Running on http://198.18.192.20:5010
2023-09-14 04:31:03,051 [INFO] - [33mPress CTRL+C to quit[0m
2023-09-14 04:31:03,268 [INFO] - Processing /selected_papers request...
2023-09-14 04:31:03,269 [INFO] - Data received: {'user_id': 'nereus@outlook.com', 'query': 'tell me which features are related to momentum stock trading'}
2023-09-14 04:31:03,305 [DEBUG] - message='Request to OpenAI API' method=post path=https://api.openai.com/v1/chat/completions
2023-09-14 04:31:03,305 [DEBUG] - api_version=None data='{"model": "gpt-4", "messages": [{"role": "system", "content": "You are an AI assistant that provides helpful answers."}, {"role": "user", "content": "\\n    As an AI, I should understand question and provide information about 10 features in a specific format. For each feature, I need to provide feature in following format\\n\\n    1A) Feature Name: The name of the feature\\n    1B) Feature Formula: The mathematical formula for the feature\\n    1C) Feature Definition: A brief description or definition of the feature\\n    1D) Feature Parameters: Parameters or variables used in the feature formula as json format\\n\\n    and number each one incrementally (so feature #2 is 2A, 2B..feature #3 is 3A, feature #4 is 4A, feature #5 is 5A... feature #10 is 10A\\n    This is my question:\\n    tell me which features are related to momentum stock trading\\n\\n    Please provide the 10 feature information according to the above format.\\n    "}], "max_tokens": 2000, "n": 1, "stop": null, "temperature": 0.7}' message='Post details'
2023-09-14 04:31:03,306 [DEBUG] - Converted retries value: 2 -> Retry(total=2, connect=None, read=None, redirect=None, status=None)
2023-09-14 04:31:03,308 [DEBUG] - Starting new HTTPS connection (1): api.openai.com:443
2023-09-14 04:32:53,426 [DEBUG] - https://api.openai.com:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2023-09-14 04:32:53,428 [DEBUG] - message='OpenAI API response' path=https://api.openai.com/v1/chat/completions processing_ms=107667 request_id=91a645b8c99674509a92594a79b27d6c response_code=200
2023-09-14 04:32:53,442 [INFO] - OpenAI API Response: {
  "id": "chatcmpl-7ycyhJYIq1F8SSXDGbVZiRAy5cyD1",
  "object": "chat.completion",
  "created": 1694683867,
  "model": "gpt-4-0613",
  "choices": [
    {
      "index": 0,
      "message": {
        "role": "assistant",
        "content": "1A) Feature Name: Moving Average \n1B) Feature Formula: MA = (P1 + P2 + P3 + ... + Pn) / n\n1C) Feature Definition: Moving average, a trend-following or lagging indicator based on past prices.\n1D) Feature Parameters: {\"Pn\": \"Price at the nth period\", \"n\": \"Number of periods\"}\n\n2A) Feature Name: Relative Strength Index (RSI)\n2B) Feature Formula: RSI = 100 - (100 / (1 + RS))\n2C) Feature Definition: The RSI measures the speed and change of price movements.\n2D) Feature Parameters: {\"RS\": \"Average gain / Average loss\"}\n\n3A) Feature Name: Stochastic Oscillator\n3B) Feature Formula: %K = ((C - L14) / (H14 - L14)) * 100\n3C) Feature Definition: A momentum indicator comparing a particular closing price of a security to a range of its prices over a certain period of time.\n3D) Feature Parameters: {\"C\": \"The most recent closing price\", \"L14\": \"The lowest price traded of the 14 previous trading sessions\", \"H14\": \"The highest price traded during the same 14-day period\"}\n\n4A) Feature Name: Moving Average Convergence Divergence (MACD)\n4B) Feature Formula: MACD = 12-Period EMA \u2212 26-Period EMA\n4C) Feature Definition: The MACD is a trend-following momentum indicator that shows the relationship between two moving averages of a security\u2019s price.\n4D) Feature Parameters: {\"12-Period EMA\": \"12 period exponential moving average\", \"26-Period EMA\": \"26 period exponential moving average\"}\n\n5A) Feature Name: Average Directional Index (ADX)\n5B) Feature Formula: ADX = 100 * SMA(ABS(DI+ - DI-)/(DI+ + DI-), n)\n5C) Feature Definition: The Average Directional Index (ADX) measures the strength and momentum of a trend and can be useful to determine if a trend is strong or weak.\n5D) Feature Parameters: {\"DI+\": \"Directional Movement Plus\", \"DI-\": \"Directional Movement Minus\", \"SMA\": \"Simple Moving Average\", \"n\": \"Number of periods\"}\n\n6A) Feature Name: Standard Deviation\n6B) Feature Formula: SD = sqrt((1/N) * \u03a3(xi - \u03bc)^2)\n6C) Feature Definition: Standard Deviation measures the dispersion of a dataset relative to its mean.\n6D) Feature Parameters: {\"N\": \"Number of observations\", \"xi\": \"Individual observation\", \"\u03bc\": \"Mean of observations\"}\n\n7A) Feature Name: Bollinger Bands\n7B) Feature Formula: Middle Band = 20-day simple moving average (SMA), Upper Band = 20-day SMA + (20-day standard deviation of price x 2), Lower Band = 20-day SMA - (20-day standard deviation of price x 2)\n7C) Feature Definition: Bollinger Bands are a volatility indicator which creates a band of three lines which are plotted in relation to a security's price.\n7D) Feature Parameters: {\"20-day SMA\": \"20-day simple moving average\", \"20-day standard deviation\": \"20-day standard deviation of price\"}\n\n8A) Feature Name: On Balance Volume\n8B) Feature Formula: OBV = Total of volume on up days - Total of volume on down days\n8C) Feature Definition: On Balance Volume is a momentum indicator that uses volume flow to predict changes in stock price.\n8D) Feature Parameters: {\"volume on up days\": \"Total volume on days when price increased\", \"volume on down days\": \"Total volume on days when price decreased\"}\n\n9A) Feature Name: Accumulation/Distribution Line\n9B) Feature Formula: A/D = ((Close - Low) - (High - Close)) / (High - Low) * Volume\n9C) Feature Definition: The A/D line is a volume based indicator designed to measure the cumulative flow of money into and out of a security.\n9D) Feature Parameters: {\"Close\": \"Closing price\", \"Low\": \"Lowest price\", \"High\": \"Highest price\", \"Volume\": \"Trading volume\"}\n\n10A) Feature Name: Money Flow Index (MFI)\n10B) Feature Formula: MFI = 100 - (100 / (1 + Money Ratio))\n10C) Feature Definition: The Money Flow Index (MFI) is a momentum indicator that measures the inflow and outflow of money into a security over a specific period of time.\n10D) Feature Parameters: {\"Money Ratio\": \"(Typical Price x Volume) on up days / (Typical Price x Volume) on down days\"}"
      },
      "finish_reason": "stop"
    }
  ],
  "usage": {
    "prompt_tokens": 208,
    "completion_tokens": 1009,
    "total_tokens": 1217
  }
}
2023-09-14 04:33:03,869 [INFO] - feature_name: Moving Average , feature_formula: MA = (P1 + P2 + P3 + ... + Pn) / n,  feature_definition: Moving average, a trend-following or lagging indicator based on past prices., feature_parameters: {"Pn": "Price at the nth period", "n": "Number of periods"}
2023-09-14 04:33:03,869 [INFO] - feature_name: Relative Strength Index (RSI), feature_formula: RSI = 100 - (100 / (1 + RS)),  feature_definition: The RSI measures the speed and change of price movements., feature_parameters: {"RS": "Average gain / Average loss"}
2023-09-14 04:33:03,869 [INFO] - feature_name: Stochastic Oscillator, feature_formula: %K = ((C - L14) / (H14 - L14)) * 100,  feature_definition: A momentum indicator comparing a particular closing price of a security to a range of its prices over a certain period of time., feature_parameters: {"C": "The most recent closing price", "L14": "The lowest price traded of the 14 previous trading sessions", "H14": "The highest price traded during the same 14-day period"}
2023-09-14 04:33:03,869 [INFO] - feature_name: Moving Average Convergence Divergence (MACD), feature_formula: MACD = 12-Period EMA \u2212 26-Period EMA,  feature_definition: The MACD is a trend-following momentum indicator that shows the relationship between two moving averages of a securitys price., feature_parameters: {"12-Period EMA": "12 period exponential moving average", "26-Period EMA": "26 period exponential moving average"}
2023-09-14 04:33:03,880 [INFO] - feature_name: Average Directional Index (ADX), feature_formula: ADX = 100 * SMA(ABS(DI+ - DI-)/(DI+ + DI-), n),  feature_definition: The Average Directional Index (ADX) measures the strength and momentum of a trend and can be useful to determine if a trend is strong or weak., feature_parameters: {"DI+": "Directional Movement Plus", "DI-": "Directional Movement Minus", "SMA": "Simple Moving Average", "n": "Number of periods"}
2023-09-14 04:33:03,880 [INFO] - feature_name: Standard Deviation, feature_formula: SD = sqrt((1/N) * \u03a3(xi - \u03bc)^2),  feature_definition: Standard Deviation measures the dispersion of a dataset relative to its mean., feature_parameters: {"N": "Number of observations", "xi": "Individual observation", "\u03bc": "Mean of observations"}
2023-09-14 04:33:03,880 [INFO] - feature_name: Bollinger Bands, feature_formula: Middle Band = 20-day simple moving average (SMA), Upper Band = 20-day SMA + (20-day standard deviation of price x 2), Lower Band = 20-day SMA - (20-day standard deviation of price x 2),  feature_definition: Bollinger Bands are a volatility indicator which creates a band of three lines which are plotted in relation to a security's price., feature_parameters: {"20-day SMA": "20-day simple moving average", "20-day standard deviation": "20-day standard deviation of price"}
2023-09-14 04:33:03,880 [INFO] - feature_name: On Balance Volume, feature_formula: OBV = Total of volume on up days - Total of volume on down days,  feature_definition: On Balance Volume is a momentum indicator that uses volume flow to predict changes in stock price., feature_parameters: {"volume on up days": "Total volume on days when price increased", "volume on down days": "Total volume on days when price decreased"}
2023-09-14 04:33:03,880 [INFO] - feature_name: Accumulation/Distribution Line, feature_formula: A/D = ((Close - Low) - (High - Close)) / (High - Low) * Volume,  feature_definition: The A/D line is a volume based indicator designed to measure the cumulative flow of money into and out of a security., feature_parameters: {"Close": "Closing price", "Low": "Lowest price", "High": "Highest price", "Volume": "Trading volume"}
2023-09-14 04:33:03,882 [INFO] - 127.0.0.1 - - [14/Sep/2023 04:33:03] "POST /handle_query HTTP/1.1" 200 -
2023-09-14 04:37:30,029 [INFO] - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5010
 * Running on http://198.18.192.20:5010
2023-09-14 04:37:30,029 [INFO] - [33mPress CTRL+C to quit[0m
2023-09-14 04:37:50,446 [INFO] - Processing /selected_papers request...
2023-09-14 04:37:50,446 [INFO] - Data received: {'user_id': 'nereus@outlook.com', 'query': 'tell me which features are related to momentum stock trading'}
2023-09-14 04:37:50,478 [DEBUG] - message='Request to OpenAI API' method=post path=https://api.openai.com/v1/chat/completions
2023-09-14 04:37:50,478 [DEBUG] - api_version=None data='{"model": "gpt-4", "messages": [{"role": "system", "content": "You are an AI assistant that provides helpful answers."}, {"role": "user", "content": "\\n    As an AI, I should understand question and provide information about 10 features in a specific format. For each feature, I need to provide feature in following format\\n\\n    1A) Feature Name: The name of the feature\\n    1B) Feature Formula: The mathematical formula for the feature\\n    1C) Feature Definition: A brief description or definition of the feature\\n    1D) Feature Parameters: Parameters or variables used in the feature formula as json format\\n\\n    and number each one incrementally (so feature #2 is 2A, 2B..feature #3 is 3A, feature #4 is 4A, feature #5 is 5A... feature #10 is 10A\\n    This is my question:\\n    tell me which features are related to momentum stock trading\\n\\n    Please provide the 10 feature information according to the above format.\\n    "}], "max_tokens": 2000, "n": 1, "stop": null, "temperature": 0.7}' message='Post details'
2023-09-14 04:37:50,479 [DEBUG] - Converted retries value: 2 -> Retry(total=2, connect=None, read=None, redirect=None, status=None)
2023-09-14 04:37:50,482 [DEBUG] - Starting new HTTPS connection (1): api.openai.com:443
2023-09-14 04:39:53,502 [DEBUG] - https://api.openai.com:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2023-09-14 04:39:53,503 [DEBUG] - message='OpenAI API response' path=https://api.openai.com/v1/chat/completions processing_ms=117527 request_id=17ce1a2eccc5f0d9f1c6e2d55f2d8479 response_code=200
2023-09-14 04:39:53,515 [INFO] - OpenAI API Response: {
  "id": "chatcmpl-7yd5HKkdDL1UwXsipG2Mz2buAvVAU",
  "object": "chat.completion",
  "created": 1694684275,
  "model": "gpt-4-0613",
  "choices": [
    {
      "index": 0,
      "message": {
        "role": "assistant",
        "content": "1A) Feature Name: Rate of Change (ROC)\n1B) Feature Formula: ROC = [(Close price today - Close price 'n' day's ago) / Close price 'n' day's ago)] * 100\n1C) Feature Definition: A momentum oscillator, which measures the percentage change between the current price and the price \"n\" periods in the past.\n1D) Feature Parameters: {\"Close price today\": \"Price of the stock at the end of the day\", \"Close price 'n' day's ago\": \"Closing price n days ago\"}\n\n2A) Feature Name: Relative Strength Index (RSI)\n2B) Feature Formula: RSI = 100 - [100 / (1 + (Average Gain / Average Loss))]\n2C) Feature Definition: It is a momentum indicator that measures the speed and change of price movements.\n2D) Feature Parameters: {\"Average Gain\": \"Average of upward price movement\", \"Average Loss\": \"Average of downward price movement\"}\n\n3A) Feature Name: Moving Average Convergence Divergence (MACD)\n3B) Feature Formula: MACD = (12-day EMA - 26-day EMA)\n3C) Feature Definition: MACD is a trend-following momentum indicator that shows the relationship between two moving averages of a security\u2019s price.\n3D) Feature Parameters: {\"12-day EMA\": \"12-day exponential moving average\", \"26-day EMA\": \"26-day exponential moving average\"}\n\n4A) Feature Name: Stochastic Oscillator\n4B) Feature Formula: %K = [(Current Close - Lowest Low) / (Highest High - Lowest Low)] * 100\n4C) Feature Definition: A momentum indicator comparing a particular closing price of a security to a range of its prices over a certain period of time.\n4D) Feature Parameters: {\"Current Close\": \"The most recent closing price\", \"Lowest Low\": \"The lowest price over a specified period\", \"Highest High\": \"The highest price over that period\"}\n\n5A) Feature Name: Average True Range (ATR)\n5B) Feature Formula: ATR = 1/n * \u2211(True Range)\n5C) Feature Definition: ATR is a technical analysis volatility indicator originally developed by J. Welles Wilder, Jr.\n5D) Feature Parameters: {\"n\": \"The period of calculation\", \"True Range\": \"The greatest of the following three values: current high less the current low, the absolute value of the current high less the previous close, and the absolute value of the current low less the previous close\"}\n\n6A) Feature Name: On Balance Volume (OBV)\n6B) Feature Formula: If close > close of previous day then OBV = previous OBV + current volume; If close < close of previous day then OBV = previous OBV - current volume\n6C) Feature Definition: OBV is a technical trading momentum indicator that uses volume flow to predict changes in stock price.\n6D) Feature Parameters: {\"close\": \"Current closing price\", \"previous close\": \"Previous closing price\", \"current volume\": \"Volume of current day\", \"previous OBV\": \"On Balance Volume of previous day\"}\n\n7A) Feature Name: Bollinger Bands\n7B) Feature Formula: Middle Band = 20-day simple moving average (SMA); Upper Band = 20-day SMA + (20-day standard deviation of price x 2); Lower Band = 20-day SMA - (20-day standard deviation of price x 2)\n7C) Feature Definition: Bollinger Bands are a volatility indicator which creates a band of three lines which graph the price levels.\n7D) Feature Parameters: {\"20-day SMA\": \"20-day simple moving average\", \"20-day standard deviation of price\": \"Standard deviation of price over 20 days\"}\n\n8A) Feature Name: Momentum\n8B) Feature Formula: Momentum = Closing Price today - Closing Price 'n' periods ago\n8C) Feature Definition: Momentum is the speed at which the price of an asset is moving.\n8D) Feature Parameters: {\"Closing Price today\": \"Today's closing price\", \"Closing Price 'n' periods ago\": \"Closing price n periods ago\"}\n\n9A) Feature Name: Price Volume Trend (PVT)\n9B) Feature Formula: PVT = Previous PVT + Volume x ( (Today's Close - Previous Close) / Previous Close )\n9C) Feature Definition: PVT is a momentum indicator that relates volume to price change.\n9D) Feature Parameters: {\"Volume\": \"Today's trading volume\", \"Today's Close\": \"Today's closing price\", \"Previous Close\": \"Previous day's closing price\", \"Previous PVT\": \"Previous day's PVT\"}\n\n10A) Feature Name: Accumulation/Distribution Line (ADL)\n10B) Feature Formula: ADL = Previous ADL + Volume x ((Close - Low) - (High - Close)) / (High - Low)\n10C) Feature Definition: The ADL is a volume-based tool designed to measure the cumulative flow of money into and out of a security.\n10D) Feature Parameters: {\"Close\": \"Today's closing price\", \"Low\": \"Today's lowest price\", \"High\": \"Today's highest price\", \"Volume\": \"Today's trading volume\", \"Previous ADL\": \"Previous day's ADL\"}"
      },
      "finish_reason": "stop"
    }
  ],
  "usage": {
    "prompt_tokens": 208,
    "completion_tokens": 1111,
    "total_tokens": 1319
  }
}
2023-09-14 04:40:01,118 [ERROR] - Exception on /handle_query [POST]
Traceback (most recent call last):
  File "D:\Workspace\Upwork\5.Refactor Python OpenAI logic\task.py", line 138, in insert_db
    cursor.execute(
psycopg2.errors.SyntaxError: syntax error at or near "n"
LINE 1: ...past.', 'ROC = [(Close price today - Close price 'n' day's a...
                                                             ^


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\flask\app.py", line 2190, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\flask\app.py", line 1486, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\flask_cors\extension.py", line 176, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\flask\app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\flask\app.py", line 1469, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "D:\Workspace\Upwork\5.Refactor Python OpenAI logic\task.py", line 215, in handle_query
    insert_db(user_id, query, features_info)
  File "D:\Workspace\Upwork\5.Refactor Python OpenAI logic\task.py", line 141, in insert_db
    except error:
UnboundLocalError: local variable 'error' referenced before assignment
2023-09-14 04:40:01,120 [INFO] - 127.0.0.1 - - [14/Sep/2023 04:40:01] "[35m[1mPOST /handle_query HTTP/1.1[0m" 500 -
2023-09-14 04:47:42,640 [INFO] - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5010
 * Running on http://198.18.192.20:5010
2023-09-14 04:47:42,640 [INFO] - [33mPress CTRL+C to quit[0m
2023-09-14 04:47:43,429 [INFO] - Processing /selected_papers request...
2023-09-14 04:47:43,429 [INFO] - Data received: {'user_id': 'nereus@outlook.com', 'query': 'tell me which features are related to momentum stock trading'}
2023-09-14 04:47:43,463 [DEBUG] - message='Request to OpenAI API' method=post path=https://api.openai.com/v1/chat/completions
2023-09-14 04:47:43,463 [DEBUG] - api_version=None data='{"model": "gpt-4", "messages": [{"role": "system", "content": "You are an AI assistant that provides helpful answers."}, {"role": "user", "content": "\\n    As an AI, I should understand question and provide information about 10 features in a specific format. For each feature, I need to provide feature in following format\\n\\n    1A) Feature Name: The name of the feature\\n    1B) Feature Formula: The mathematical formula for the feature\\n    1C) Feature Definition: A brief description or definition of the feature\\n    1D) Feature Parameters: Parameters or variables used in the feature formula as json format, pls provide json format\\n\\n    and number each one incrementally (so feature #2 is 2A, 2B..feature #3 is 3A, feature #4 is 4A, feature #5 is 5A... feature #10 is 10A\\n    This is my question:\\n    tell me which features are related to momentum stock trading\\n\\n    Please provide the 10 feature information according to the above format.\\n    "}], "max_tokens": 2000, "n": 1, "stop": null, "temperature": 0.7}' message='Post details'
2023-09-14 04:47:43,463 [DEBUG] - Converted retries value: 2 -> Retry(total=2, connect=None, read=None, redirect=None, status=None)
2023-09-14 04:47:43,466 [DEBUG] - Starting new HTTPS connection (1): api.openai.com:443
2023-09-14 04:49:37,407 [DEBUG] - https://api.openai.com:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2023-09-14 04:49:37,409 [DEBUG] - message='OpenAI API response' path=https://api.openai.com/v1/chat/completions processing_ms=111829 request_id=63668f8847de8282b27daf6e04c02280 response_code=200
2023-09-14 04:49:37,428 [INFO] - OpenAI API Response: {
  "id": "chatcmpl-7ydEoaxEuVaUcxJMlZWLl9JhtAYRK",
  "object": "chat.completion",
  "created": 1694684866,
  "model": "gpt-4-0613",
  "choices": [
    {
      "index": 0,
      "message": {
        "role": "assistant",
        "content": "1A) Feature Name: Moving Average\n1B) Feature Formula: MA = (P1 + P2 + P3 + ... + Pn) / n\n1C) Feature Definition: A moving average smoothens a data series, which is very important in a volatile market. It helps to cut down the \"noise\" in a price chart.\n1D) Feature Parameters: {\"P\": \"Price of the stock at a point\", \"n\": \"Number of periods\"}\n\n2A) Feature Name: Relative Strength Index (RSI)\n2B) Feature Formula: RSI = 100 - (100 / (1 + RS))\n2C) Feature Definition: The RSI is a momentum indicator that measures the speed and change of price movements. It moves between zero and 100 and can signal if a stock is being overbought or oversold.\n2D) Feature Parameters: {\"RS\": \"Average gain / Average loss\"}\n\n3A) Feature Name: Moving Average Convergence Divergence (MACD)\n3B) Feature Formula: MACD = 12-Period EMA - 26-Period EMA\n3C) Feature Definition: The MACD is a trend-following momentum indicator that shows the relationship between two moving averages of a security\u2019s price.\n3D) Feature Parameters: {\"EMA\": \"Exponential Moving Average\"}\n\n4A) Feature Name: Volume\n4B) Feature Formula: Volume = \u03a3 Trade Quantity\n4C) Feature Definition: The volume of a stock is the total shares traded in a period. High volume often means there is high momentum and investor interest.\n4D) Feature Parameters: {\"Trade Quantity\": \"The number of shares traded in a single transaction\"}\n\n5A) Feature Name: Bollinger Bands\n5B) Feature Formula: Middle Band = 20-day SMA, Upper Band = 20-day SMA + (20-day standard deviation of price x 2), Lower Band = 20-day SMA - (20-day standard deviation of price x 2)\n5C) Feature Definition: Bollinger Bands consist of a middle band with two outer bands. The outer bands adjust themselves to the stock's volatility.\n5D) Feature Parameters: {\"SMA\": \"Simple Moving Average\", \"Standard Deviation\": \"Measure of price volatility\"}\n\n6A) Feature Name: Stochastic Oscillator\n6B) Feature Formula: %K = [(C - L5close)/(H5 - L5)]*100\n6C) Feature Definition: The Stochastic Oscillator is a momentum indicator that uses support and resistance levels. Dr. George Lane developed this indicator in the late 1950s.\n6D) Feature Parameters: {\"C\": \"the most recent closing price\", \"L5close\": \"the lowest price traded of the 5 previous trading days\", \"H5\": \"the highest price traded during the same 5 day period\"}\n\n7A) Feature Name: Accumulation/Distribution Line (ADL)\n7B) Feature Formula: ADL = ((Close \u2013 Low) - (High \u2013 Close)) / (High \u2013 Low) * Period's volume\n7C) Feature Definition: The Accumulation Distribution Line is a volume-based technical analysis tool designed to measure the cumulative inflow and outflow of money of a security.\n7D) Feature Parameters: {\"Close\": \"Closing price\", \"Low\": \"Lowest price\", \"High\": \"Highest price\", \"Volume\": \"Number of shares traded\"}\n\n8A) Feature Name: Average Directional Index (ADX)\n8B) Feature Formula: ADX = 100 * EMA(|+DI14 - -DI14| / (+DI14 + -DI14))\n8C) Feature Definition: The Average Directional Index (ADX) is a technical analysis indicator used by some traders to determine the strength of a trend.\n8D) Feature Parameters: {\"EMA\": \"Exponential Moving Average\", \"+DI14\": \"Plus Directional Indicator\", \"-DI14\": \"Minus Directional Indicator\"}\n\n9A) Feature Name: On Balance Volume (OBV)\n9B) Feature Formula: If close > close_prev then: OBV = OBV_prev + volume. If close < close_prev then: OBV = OBV_prev - volume.\n9C) Feature Definition: On Balance Volume is a momentum indicator that uses volume flow to predict changes in stock price.\n9D) Feature Parameters: {\"Volume\": \"Number of shares traded\", \"Close\": \"Closing price\", \"OBV_prev\": \"Previous OBV value\"}\n\n10A) Feature Name: Rate of Change (ROC)\n10B) Feature Formula: ROC = [(Close - Close_n) / Close_n] * 100\n10C) Feature Definition: The Rate of Change is a momentum oscillator that measures the percentage change in price between the current price and the price n periods in the past.\n10D) Feature Parameters: {\"Close\": \"Closing price\", \"Close_n\": \"Closing price n periods ago\"}"
      },
      "finish_reason": "stop"
    }
  ],
  "usage": {
    "prompt_tokens": 213,
    "completion_tokens": 1024,
    "total_tokens": 1237
  }
}
2023-09-14 04:49:44,736 [ERROR] - Exception on /handle_query [POST]
Traceback (most recent call last):
  File "D:\Workspace\Upwork\5.Refactor Python OpenAI logic\task.py", line 139, in insert_db
    cursor.execute(sql)
psycopg2.errors.UndefinedColumn: column "init_code_generated_from_openai" of relation "feature_from_query" does not exist
LINE 1: ...eature_parameters, feature_selected_for_code_gen, init_code_...
                                                             ^


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\flask\app.py", line 2190, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\flask\app.py", line 1486, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\flask_cors\extension.py", line 176, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\flask\app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\flask\app.py", line 1469, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "D:\Workspace\Upwork\5.Refactor Python OpenAI logic\task.py", line 216, in handle_query
    insert_db(user_id, query, features_info)
  File "D:\Workspace\Upwork\5.Refactor Python OpenAI logic\task.py", line 142, in insert_db
    except error:
UnboundLocalError: local variable 'error' referenced before assignment
2023-09-14 04:49:44,738 [INFO] - 127.0.0.1 - - [14/Sep/2023 04:49:44] "[35m[1mPOST /handle_query HTTP/1.1[0m" 500 -
2023-09-14 04:50:47,716 [INFO] - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5010
 * Running on http://198.18.192.20:5010
2023-09-14 04:50:47,716 [INFO] - [33mPress CTRL+C to quit[0m
2023-09-14 04:51:11,986 [INFO] - Processing /selected_papers request...
2023-09-14 04:51:11,986 [INFO] - Data received: {'user_id': 'nereus@outlook.com', 'query': 'tell me which features are related to momentum stock trading'}
2023-09-14 04:51:12,025 [DEBUG] - message='Request to OpenAI API' method=post path=https://api.openai.com/v1/chat/completions
2023-09-14 04:51:12,025 [DEBUG] - api_version=None data='{"model": "gpt-4", "messages": [{"role": "system", "content": "You are an AI assistant that provides helpful answers."}, {"role": "user", "content": "\\n    As an AI, I should understand question and provide information about 10 features in a specific format. For each feature, I need to provide feature in following format\\n\\n    1A) Feature Name: The name of the feature\\n    1B) Feature Formula: The mathematical formula for the feature\\n    1C) Feature Definition: A brief description or definition of the feature\\n    1D) Feature Parameters: Parameters or variables used in the feature formula as json format, pls provide json format\\n\\n    and number each one incrementally (so feature #2 is 2A, 2B..feature #3 is 3A, feature #4 is 4A, feature #5 is 5A... feature #10 is 10A\\n    This is my question:\\n    tell me which features are related to momentum stock trading\\n\\n    Please provide the 10 feature information according to the above format.\\n    "}], "max_tokens": 2000, "n": 1, "stop": null, "temperature": 0.7}' message='Post details'
2023-09-14 04:51:12,026 [DEBUG] - Converted retries value: 2 -> Retry(total=2, connect=None, read=None, redirect=None, status=None)
2023-09-14 04:51:12,029 [DEBUG] - Starting new HTTPS connection (1): api.openai.com:443
2023-09-14 04:52:58,454 [DEBUG] - https://api.openai.com:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2023-09-14 04:52:58,455 [DEBUG] - message='OpenAI API response' path=https://api.openai.com/v1/chat/completions processing_ms=100121 request_id=f55a429e5756d80ad365ef28845af9d2 response_code=200
2023-09-14 04:52:58,465 [INFO] - OpenAI API Response: {
  "id": "chatcmpl-7ydIF1ceZ7H2QiOzvtb6ZBeZc0wK3",
  "object": "chat.completion",
  "created": 1694685079,
  "model": "gpt-4-0613",
  "choices": [
    {
      "index": 0,
      "message": {
        "role": "assistant",
        "content": "1A) Feature Name: Moving Average\n1B) Feature Formula: SMA = (P1 + P2 + P3 + ... + Pn) / n\n1C) Feature Definition: Moving average is a commonly used indicator in technical analysis that helps smooth out price action by filtering out the \u201cnoise\u201d from random short-term price fluctuations.\n1D) Feature Parameters: {\"P\": \"Price of the stock each day\", \"n\": \"Number of periods\"}\n\n2A) Feature Name: Rate of Change (ROC)\n2B) Feature Formula: ROC = [(Close - Close n periods ago) / (Close n periods ago)] * 100\n2C) Feature Definition: The Rate of Change (ROC) is a momentum oscillator that measures the percentage change in price between the current price and the price a certain number of periods ago.\n2D) Feature Parameters: {\"Close\": \"Closing price of the stock today\", \"n\": \"Number of periods ago\"}\n\n3A) Feature Name: Relative Strength Index (RSI)\n3B) Feature Formula: RSI = 100 - (100 / (1 + RS))\n3C) Feature Definition: The Relative Strength Index (RSI) is a momentum indicator that measures the speed and change of price movements.\n3D) Feature Parameters: {\"RS\": \"Average gain / Average loss\"}\n\n4A) Feature Name: Momentum\n4B) Feature Formula: Momentum = Current Price - Price n days ago\n4C) Feature Definition: Momentum is the rate of acceleration of a security's price or volume.\n4D) Feature Parameters: {\"Current Price\": \"Today's closing price\", \"n\": \"Number of periods ago\"}\n\n5A) Feature Name: Stochastic Oscillator\n5B) Feature Formula: %K = (Current Close - Lowest Low)/(Highest High - Lowest Low) * 100\n5C) Feature Definition: A stochastic oscillator is a momentum indicator comparing a particular closing price of a security to a range of its prices over a certain period of time.\n5D) Feature Parameters: {\"Current Close\": \"Today's closing price\", \"Lowest Low\": \"Lowest price in the lookback period\", \"Highest High\": \"Highest price in the lookback period\"}\n\n6A) Feature Name: Moving Average Convergence Divergence (MACD)\n6B) Feature Formula: MACD = 12-Period EMA - 26-Period EMA\n6C) Feature Definition: MACD is a trend-following momentum indicator that shows the relationship between two moving averages of a security\u2019s price.\n6D) Feature Parameters: {\"12-Period EMA\": \"12-period exponential moving average\", \"26-Period EMA\": \"26-period exponential moving average\"}\n\n7A) Feature Name: Volume\n7B) Feature Formula: Volume = Sum(Quantity of Shares Traded)\n7C) Feature Definition: Volume is the number of shares or contracts traded in a security or market during a given period.\n7D) Feature Parameters: {\"Quantity of Shares Traded\": \"Number of shares traded during the period\"}\n\n8A) Feature Name: On Balance Volume (OBV)\n8B) Feature Formula: If Close > CloseYesterday then OBV = OBVYesterday + VolumeToday\n8C) Feature Definition: On Balance Volume (OBV) is a momentum indicator that uses volume flow to predict changes in stock price.\n8D) Feature Parameters: {\"Close\": \"Today's close price\", \"CloseYesterday\": \"Yesterday's close price\", \"OBVYesterday\": \"Yesterday's OBV\", \"VolumeToday\": \"Today's volume\"}\n\n9A) Feature Name: Price Rate of Change\n9B) Feature Formula: ROC = [(Close - Close n periods ago) / (Close n periods ago)] * 100\n9C) Feature Definition: Price Rate of Change is a momentum-based technical indicator that measures the percentage change in price between the current price and the price a certain number of periods ago.\n9D) Feature Parameters: {\"Close\": \"Closing price of the stock today\", \"n\": \"Number of periods ago\"}\n\n10A) Feature Name: Williams %R\n10B) Feature Formula: %R = (Highest High - Close) / (Highest High - Lowest Low) * -100\n10C) Feature Definition: Williams %R is a momentum indicator that measures overbought and oversold levels.\n10D) Feature Parameters: {\"Highest High\": \"Highest price in the lookback period\", \"Close\": \"Today's closing price\", \"Lowest Low\": \"Lowest price in the lookback period\"}"
      },
      "finish_reason": "stop"
    }
  ],
  "usage": {
    "prompt_tokens": 213,
    "completion_tokens": 946,
    "total_tokens": 1159
  }
}
2023-09-14 04:53:12,398 [ERROR] - Exception on /handle_query [POST]
Traceback (most recent call last):
  File "D:\Workspace\Upwork\5.Refactor Python OpenAI logic\task.py", line 140, in insert_db
    cursor.execute(sql)
psycopg2.errors.UndefinedColumn: column "init_code_generated_from_openai" of relation "feature_from_query" does not exist
LINE 1: ...eature_parameters, feature_selected_for_code_gen, init_code_...
                                                             ^


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\flask\app.py", line 2190, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\flask\app.py", line 1486, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\flask_cors\extension.py", line 176, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\flask\app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\flask\app.py", line 1469, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "D:\Workspace\Upwork\5.Refactor Python OpenAI logic\task.py", line 217, in handle_query
    insert_db(user_id, query, features_info)
  File "D:\Workspace\Upwork\5.Refactor Python OpenAI logic\task.py", line 143, in insert_db
    except error:
UnboundLocalError: local variable 'error' referenced before assignment
2023-09-14 04:53:12,400 [INFO] - 127.0.0.1 - - [14/Sep/2023 04:53:12] "[35m[1mPOST /handle_query HTTP/1.1[0m" 500 -
2023-09-14 04:59:39,681 [INFO] - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5010
 * Running on http://198.18.192.20:5010
2023-09-14 04:59:39,681 [INFO] - [33mPress CTRL+C to quit[0m
2023-09-14 04:59:40,184 [INFO] - Processing /selected_papers request...
2023-09-14 04:59:40,185 [INFO] - Data received: {'user_id': 'nereus@outlook.com', 'query': 'tell me which features are related to momentum stock trading'}
2023-09-14 04:59:40,220 [DEBUG] - message='Request to OpenAI API' method=post path=https://api.openai.com/v1/chat/completions
2023-09-14 04:59:40,220 [DEBUG] - api_version=None data='{"model": "gpt-4", "messages": [{"role": "system", "content": "You are an AI assistant that provides helpful answers."}, {"role": "user", "content": "\\n    As an AI, I should understand question and provide information about 10 features in a specific format. For each feature, I need to provide feature in following format\\n\\n    1A) Feature Name: The name of the feature\\n    1B) Feature Formula: The mathematical formula for the feature\\n    1C) Feature Definition: A brief description or definition of the feature\\n    1D) Feature Parameters: Parameters or variables used in the feature formula as json format, pls provide json format\\n\\n    and number each one incrementally (so feature #2 is 2A, 2B..feature #3 is 3A, feature #4 is 4A, feature #5 is 5A... feature #10 is 10A\\n    This is my question:\\n    tell me which features are related to momentum stock trading\\n\\n    Please provide the 10 feature information according to the above format.\\n    "}], "max_tokens": 2000, "n": 1, "stop": null, "temperature": 0.7}' message='Post details'
2023-09-14 04:59:40,221 [DEBUG] - Converted retries value: 2 -> Retry(total=2, connect=None, read=None, redirect=None, status=None)
2023-09-14 04:59:40,223 [DEBUG] - Starting new HTTPS connection (1): api.openai.com:443
2023-09-14 05:01:35,578 [DEBUG] - https://api.openai.com:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2023-09-14 05:01:35,579 [DEBUG] - message='OpenAI API response' path=https://api.openai.com/v1/chat/completions processing_ms=111195 request_id=ee789f6eba138fd335a7f5e7517ac91d response_code=200
2023-09-14 05:01:35,590 [INFO] - OpenAI API Response: {
  "id": "chatcmpl-7ydQO2bkb4tHohmmVHy30eCMxec75",
  "object": "chat.completion",
  "created": 1694685584,
  "model": "gpt-4-0613",
  "choices": [
    {
      "index": 0,
      "message": {
        "role": "assistant",
        "content": "Sure, here are 10 features related to momentum stock trading:\n\n1A) Feature Name: Relative Strength Index (RSI)\n1B) Feature Formula: RSI = 100 - (100 / (1 + RS))\n1C) Feature Definition: An indicator that measures the speed and change of price movements.\n1D) Feature Parameters: {\"RS\": \"Average gain of up periods during the specified time frame / Average loss of down periods during the specified time frame\"}\n\n2A) Feature Name: Moving Average Convergence Divergence (MACD)\n2B) Feature Formula: MACD = 12-Period EMA - 26-Period EMA\n2C) Feature Definition: A trend-following momentum indicator that shows the relationship between two moving averages of a security\u2019s price.\n2D) Feature Parameters: {\"EMA\": \"Exponential Moving Average\"}\n\n3A) Feature Name: Stochastic Oscillator\n3B) Feature Formula: %K = (Current Close - Lowest Low)/(Highest High - Lowest Low) * 100\n3C) Feature Definition: A momentum indicator comparing a particular closing price of a security to a range of its prices over a certain period of time.\n3D) Feature Parameters: {\"Current Close\": \"Most recent closing price\", \"Lowest Low\": \"Lowest price in the given time period\", \"Highest High\": \"Highest price in the given time period\"}\n\n4A) Feature Name: Rate of Change (ROC)\n4B) Feature Formula: ROC = [(Close - Close n periods ago) / (Close n periods ago)] * 100\n4C) Feature Definition: A momentum oscillator that measures the percentage change in price between the current price and the price a certain number of periods ago.\n4D) Feature Parameters: {\"Close\": \"Most recent closing price\"}\n\n5A) Feature Name: Average True Range (ATR)\n5B) Feature Formula: ATR = (1/n) * (TR1 + TR2 + ... + TRn)\n5C) Feature Definition: An indicator that measures market volatility by decomposing the entire range of an asset price for that period.\n5D) Feature Parameters: {\"TR\": \"True Range\", \"n\": \"Number of periods\"}\n\n6A) Feature Name: Momentum\n6B) Feature Formula: Momentum = Closing Price now - Closing Price n periods ago\n6C) Feature Definition: Momentum is the speed or velocity of price changes in a stock, security, or tradable instrument.\n6D) Feature Parameters: {\"Closing Price now\": \"Most recent closing price\", \"Closing Price n periods ago\": \"Closing price n periods ago\"}\n\n7A) Feature Name: Bollinger Bands\n7B) Feature Formula: Middle Band = 20-day simple moving average (SMA); Upper Band = 20-day SMA + (20-day standard deviation of price x 2); Lower Band = 20-day SMA - (20-day standard deviation of price x 2)\n7C) Feature Definition: A volatility indicator which includes three bands. The middle band is a simple moving average, and the upper and lower bands are set above and below the middle band.\n7D) Feature Parameters: {\"SMA\": \"Simple Moving Average\", \"Standard Deviation\": \"Standard Deviation of price\"}\n\n8A) Feature Name: On Balance Volume (OBV)\n8B) Feature Formula: If close > close of previous day then OBV = OBV(prev) + volume; If close < close of previous day then OBV = OBV(prev) - volume\n8C) Feature Definition: It uses volume flow to predict changes in the stock price.\n8D) Feature Parameters: {\"OBV(prev)\": \"Previous OBV value\", \"volume\": \"Current trading volume\"}\n\n9A) Feature Name: Accumulation/Distribution Line (A/D)\n9B) Feature Formula: A/D = ((Close - Low) - (High - Close)) / (High - Low) * Volume + Previous A/D\n9C) Feature Definition: A volume-based tool created to measure the cumulative flow of money into and out of a security.\n9D) Feature Parameters: {\"Close\": \"Closing price\", \"Low\": \"Lowest price\", \"High\": \"Highest price\", \"Volume\": \"Trading volume\"}\n\n10A) Feature Name: Money Flow Index (MFI)\n10B) Feature Formula: MFI = 100 - (100 / (1 + Money Flow Ratio))\n10C) Feature Definition: The MFI is an oscillator that uses both price and volume to measure buying and selling pressure.\n10D) Feature Parameters: {\"Money Flow Ratio\": \"Ratio of the total positive money flow to the total negative money flow over a certain period\"}"
      },
      "finish_reason": "stop"
    }
  ],
  "usage": {
    "prompt_tokens": 213,
    "completion_tokens": 970,
    "total_tokens": 1183
  }
}
2023-09-14 05:01:47,933 [INFO] - feature_name: Relative Strength Index (RSI), feature_formula: RSI = 100 - (100 / (1 + RS)),  feature_definition: An indicator that measures the speed and change of price movements., feature_parameters: {"RS": "Average gain of up periods during the specified time frame / Average loss of down periods during the specified time frame"}
2023-09-14 05:01:47,933 [INFO] - feature_name: Moving Average Convergence Divergence (MACD), feature_formula: MACD = 12-Period EMA - 26-Period EMA,  feature_definition: A trend-following momentum indicator that shows the relationship between two moving averages of a securitys price., feature_parameters: {"EMA": "Exponential Moving Average"}
2023-09-14 05:01:47,934 [INFO] - feature_name: Stochastic Oscillator, feature_formula: %K = (Current Close - Lowest Low)/(Highest High - Lowest Low) * 100,  feature_definition: A momentum indicator comparing a particular closing price of a security to a range of its prices over a certain period of time., feature_parameters: {"Current Close": "Most recent closing price", "Lowest Low": "Lowest price in the given time period", "Highest High": "Highest price in the given time period"}
2023-09-14 05:01:47,934 [INFO] - feature_name: Rate of Change (ROC), feature_formula: ROC = [(Close - Close n periods ago) / (Close n periods ago)] * 100,  feature_definition: A momentum oscillator that measures the percentage change in price between the current price and the price a certain number of periods ago., feature_parameters: {"Close": "Most recent closing price"}
2023-09-14 05:01:47,934 [INFO] - feature_name: Average True Range (ATR), feature_formula: ATR = (1/n) * (TR1 + TR2 + ... + TRn),  feature_definition: An indicator that measures market volatility by decomposing the entire range of an asset price for that period., feature_parameters: {"TR": "True Range", "n": "Number of periods"}
2023-09-14 05:01:47,934 [INFO] - feature_name: Momentum, feature_formula: Momentum = Closing Price now - Closing Price n periods ago,  feature_definition: Momentum is the speed or velocity of price changes in a stock, security, or tradable instrument., feature_parameters: {"Closing Price now": "Most recent closing price", "Closing Price n periods ago": "Closing price n periods ago"}
2023-09-14 05:01:47,934 [INFO] - feature_name: Bollinger Bands, feature_formula: Middle Band = 20-day simple moving average (SMA); Upper Band = 20-day SMA + (20-day standard deviation of price x 2); Lower Band = 20-day SMA - (20-day standard deviation of price x 2),  feature_definition: A volatility indicator which includes three bands. The middle band is a simple moving average, and the upper and lower bands are set above and below the middle band., feature_parameters: {"SMA": "Simple Moving Average", "Standard Deviation": "Standard Deviation of price"}
2023-09-14 05:01:47,934 [INFO] - feature_name: On Balance Volume (OBV), feature_formula: If close > close of previous day then OBV = OBV(prev) + volume; If close < close of previous day then OBV = OBV(prev) - volume,  feature_definition: It uses volume flow to predict changes in the stock price., feature_parameters: {"OBV(prev)": "Previous OBV value", "volume": "Current trading volume"}
2023-09-14 05:01:47,934 [INFO] - feature_name: Accumulation/Distribution Line (A/D), feature_formula: A/D = ((Close - Low) - (High - Close)) / (High - Low) * Volume + Previous A/D,  feature_definition: A volume-based tool created to measure the cumulative flow of money into and out of a security., feature_parameters: {"Close": "Closing price", "Low": "Lowest price", "High": "Highest price", "Volume": "Trading volume"}
2023-09-14 05:01:47,935 [INFO] - 127.0.0.1 - - [14/Sep/2023 05:01:47] "POST /handle_query HTTP/1.1" 200 -
2023-09-14 05:05:09,307 [INFO] - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5010
 * Running on http://198.18.192.20:5010
2023-09-14 05:05:09,307 [INFO] - [33mPress CTRL+C to quit[0m
2023-09-14 05:05:11,375 [INFO] - Processing /selected_papers request...
2023-09-14 05:05:11,376 [INFO] - Data received: {'user_id': 'nereus@outlook.com', 'query': 'tell me which features are related to momentum stock trading'}
2023-09-14 05:05:11,424 [DEBUG] - message='Request to OpenAI API' method=post path=https://api.openai.com/v1/chat/completions
2023-09-14 05:05:11,425 [DEBUG] - api_version=None data='{"model": "gpt-4", "messages": [{"role": "system", "content": "You are an AI assistant that provides helpful answers."}, {"role": "user", "content": "\\n    As an AI, I should understand question and provide information about 10 features in a specific format. For each feature, I need to provide feature in following format\\n\\n    1A) Feature Name: The name of the feature\\n    1B) Feature Formula: The mathematical formula for the feature\\n    1C) Feature Definition: A brief description or definition of the feature\\n    1D) Feature Parameters: Parameters or variables used in the feature formula as json format, pls provide json format\\n\\n    and number each one incrementally (so feature #2 is 2A, 2B..feature #3 is 3A, feature #4 is 4A, feature #5 is 5A... feature #10 is 10A\\n    This is my question:\\n    tell me which features are related to momentum stock trading\\n\\n    Please provide the 10 feature information according to the above format.\\n    "}], "max_tokens": 2000, "n": 1, "stop": null, "temperature": 0.7}' message='Post details'
2023-09-14 05:05:11,425 [DEBUG] - Converted retries value: 2 -> Retry(total=2, connect=None, read=None, redirect=None, status=None)
2023-09-14 05:05:11,428 [DEBUG] - Starting new HTTPS connection (1): api.openai.com:443
2023-09-14 05:07:14,376 [DEBUG] - https://api.openai.com:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2023-09-14 05:07:14,378 [DEBUG] - message='OpenAI API response' path=https://api.openai.com/v1/chat/completions processing_ms=117221 request_id=a8fbe5430e2bc2ed7b98ca0c5c265fc8 response_code=200
2023-09-14 05:07:14,393 [INFO] - OpenAI API Response: {
  "id": "chatcmpl-7ydVkqSvhofGZFoJ4HPyZlG9I1ON0",
  "object": "chat.completion",
  "created": 1694685916,
  "model": "gpt-4-0613",
  "choices": [
    {
      "index": 0,
      "message": {
        "role": "assistant",
        "content": "Sure, here are ten features related to momentum stock trading:\n\n1A) Feature Name: Relative Strength Index (RSI)\n1B) Feature Formula: RSI = 100 - (100 / (1 + RS))\n1C) Feature Definition: RSI is a momentum oscillator that measures the speed and change of price movements.\n1D) Feature Parameters: {\"RS\": \"Average gain / Average loss\"}\n\n2A) Feature Name: Moving Average Convergence Divergence (MACD)\n2B) Feature Formula: MACD = 12-Period EMA - 26-Period EMA\n2C) Feature Definition: MACD is a trend-following momentum indicator that shows the relationship between two moving averages of a security\u2019s price.\n2D) Feature Parameters: {\"12-Period EMA\": \"Exponential Moving Average of 12 periods\", \"26-Period EMA\": \"Exponential Moving Average of 26 periods\"}\n\n3A) Feature Name: Stochastic Oscillator\n3B) Feature Formula: %K = (Current Close - Lowest Low)/(Highest High - Lowest Low) * 100\n3C) Feature Definition: A stochastic oscillator is a momentum indicator comparing a particular closing price of a security to a range of its prices over a certain period of time.\n3D) Feature Parameters: {\"Current Close\": \"Most recent closing price\", \"Lowest Low\": \"Lowest price in the lookback period\", \"Highest High\": \"Highest price in the lookback period\"}\n\n4A) Feature Name: Rate of Change (ROC)\n4B) Feature Formula: ROC = [(Close - Close n periods ago) / (Close n periods ago)] * 100\n4C) Feature Definition: The ROC is a momentum oscillator, which measures the percentage change between the current price and the n period past price.\n4D) Feature Parameters: {\"Close\": \"The most recent closing price\", \"Close n periods ago\": \"The closing price n periods ago\"}\n\n5A) Feature Name: On Balance Volume (OBV)\n5B) Feature Formula: If close > close_prev then: OBV = OBV_prev + volume. If close < close_prev then: OBV = OBV_prev - volume\n5C) Feature Definition: OBV is a technical trading momentum indicator that uses volume flow to predict changes in stock price.\n5D) Feature Parameters: {\"close\": \"Current close price\", \"close_prev\": \"Previous close price\", \"volume\": \"Current volume\", \"OBV_prev\": \"Previous OBV\"}\n\n6A) Feature Name: Momentum\n6B) Feature Formula: Momentum = Close Price \u2013 Close Price N periods ago\n6C) Feature Definition: Momentum is the rate of acceleration of a security's price or volume.\n6D) Feature Parameters: {\"Close Price\": \"Current closing price\", \"Close Price N periods ago\": \"Closing price from N periods ago\"}\n\n7A) Feature Name: Average Directional Index (ADX)\n7B) Feature Formula: ADX = 100 * EMA [ABS(DI+ - DI-) / (DI+ + DI-)]\n7C) Feature Definition: The Average Directional Index (ADX) is a technical analysis indicator used by some traders to determine the strength of a trend.\n7D) Feature Parameters: {\"DI+\": \"Positive Directional Indicator\", \"DI-\": \"Negative Directional Indicator\", \"EMA\": \"Exponential Moving Average\"}\n\n8A) Feature Name: Accumulation/Distribution Line (A/D Line)\n8B) Feature Formula: A/D = ((Close - Low) - (High - Close)) / (High - Low) * Volume + Previous A/D\n8C) Feature Definition: The A/D line is a volume-based indicator designed to measure the cumulative flow of money into and out of a security.\n8D) Feature Parameters: {\"Close\": \"Current closing price\", \"Low\": \"Current low price\", \"High\": \"Current high price\", \"Volume\": \"Current volume\", \"Previous A/D\": \"Previous A/D value\"}\n\n9A) Feature Name: Money Flow Index (MFI)\n9B) Feature Formula: MFI = 100 - (100 / (1 + Money Ratio))\n9C) Feature Definition: The MFI is a momentum indicator that measures the inflow and outflow of money into a security over a specific period of time.\n9D) Feature Parameters: {\"Money Ratio\": \"Typical Price multiplied by volume for the period\"}\n\n10A) Feature Name: Force Index\n10B) Feature Formula: Force Index = (Close - Previous Close) * Volume\n10C) Feature Definition: The Force Index is an indicator that uses price and volume to assess the power behind a move or identify possible turning points.\n10D) Feature Parameters: {\"Close\": \"Current close price\", \"Previous Close\": \"Previous close price\", \"Volume\": \"Current volume\"}"
      },
      "finish_reason": "stop"
    }
  ],
  "usage": {
    "prompt_tokens": 213,
    "completion_tokens": 1006,
    "total_tokens": 1219
  }
}
2023-09-14 05:07:23,679 [ERROR] - Exception on /handle_query [POST]
Traceback (most recent call last):
  File "D:\Workspace\Upwork\5.Refactor Python OpenAI logic\task.py", line 139, in insert_db
    cursor.execute(sql)
psycopg2.errors.SyntaxError: syntax error at or near "s"
LINE 1: ...omentum is the rate of acceleration of a security's price or...
                                                             ^


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\flask\app.py", line 2190, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\flask\app.py", line 1486, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\flask_cors\extension.py", line 176, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\flask\app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\flask\app.py", line 1469, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "D:\Workspace\Upwork\5.Refactor Python OpenAI logic\task.py", line 208, in handle_query
    insert_db(user_id, query, features_info)
  File "D:\Workspace\Upwork\5.Refactor Python OpenAI logic\task.py", line 140, in insert_db
    except error:
UnboundLocalError: local variable 'error' referenced before assignment
2023-09-14 05:07:23,681 [INFO] - 127.0.0.1 - - [14/Sep/2023 05:07:23] "[35m[1mPOST /handle_query HTTP/1.1[0m" 500 -
2023-09-14 05:12:24,347 [INFO] - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5010
 * Running on http://198.18.192.20:5010
2023-09-14 05:12:24,347 [INFO] - [33mPress CTRL+C to quit[0m
2023-09-14 05:12:25,493 [INFO] - Processing /selected_papers request...
2023-09-14 05:12:25,494 [INFO] - Data received: {'user_id': 'nereus@outlook.com', 'query': 'tell me which features are related to momentum stock trading'}
2023-09-14 05:12:25,542 [DEBUG] - message='Request to OpenAI API' method=post path=https://api.openai.com/v1/chat/completions
2023-09-14 05:12:25,542 [DEBUG] - api_version=None data='{"model": "gpt-4", "messages": [{"role": "system", "content": "You are an AI assistant that provides helpful answers."}, {"role": "user", "content": "\\n    As an AI, I should understand question and provide information about 10 features in a specific format. For each feature, I need to provide feature in following format\\n\\n    1A) Feature Name: The name of the feature\\n    1B) Feature Formula: The mathematical formula for the feature\\n    1C) Feature Definition: A brief description or definition of the feature\\n    1D) Feature Parameters: Parameters or variables used in the feature formula as json format, pls provide json format\\n\\n    and number each one incrementally (so feature #2 is 2A, 2B..feature #3 is 3A, feature #4 is 4A, feature #5 is 5A... feature #10 is 10A\\n    This is my question:\\n    tell me which features are related to momentum stock trading\\n\\n    Please provide the 10 feature information according to the above format.\\n    "}], "max_tokens": 2000, "n": 1, "stop": null, "temperature": 0.7}' message='Post details'
2023-09-14 05:12:25,543 [DEBUG] - Converted retries value: 2 -> Retry(total=2, connect=None, read=None, redirect=None, status=None)
2023-09-14 05:12:25,545 [DEBUG] - Starting new HTTPS connection (1): api.openai.com:443
2023-09-14 05:14:12,864 [DEBUG] - https://api.openai.com:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2023-09-14 05:14:12,865 [DEBUG] - message='OpenAI API response' path=https://api.openai.com/v1/chat/completions processing_ms=104714 request_id=55a09e58bdf095bbaee1ecaf050dbf7f response_code=200
2023-09-14 05:14:12,879 [INFO] - OpenAI API Response: {
  "id": "chatcmpl-7ydcj2Xtw6xsO4HkowOkzxoGMhYHs",
  "object": "chat.completion",
  "created": 1694686349,
  "model": "gpt-4-0613",
  "choices": [
    {
      "index": 0,
      "message": {
        "role": "assistant",
        "content": "Sure, here are 10 features related to momentum stock trading:\n\n1A) Feature Name: Relative Strength Index (RSI)\n1B) Feature Formula: RSI = 100 - (100 / (1 + RS))\n1C) Feature Definition: RSI compares the magnitude of recent gains to recent losses in an attempt to determine overbought and oversold conditions of an asset.\n1D) Feature Parameters: { \"RS\": \"Average gain / Average loss over a specified period\"}\n\n2A) Feature Name: Moving Average Convergence Divergence (MACD)\n2B) Feature Formula: MACD = 12-Period EMA - 26-Period EMA\n2C) Feature Definition: MACD is a trend-following momentum indicator that shows the relationship between two moving averages of a security\u2019s price.\n2D) Feature Parameters: { \"EMA_12\": \"12-Period Exponential Moving Average\", \"EMA_26\": \"26-Period Exponential Moving Average\"}\n\n3A) Feature Name: Stochastic Oscillator\n3B) Feature Formula: %K = ((C - L14) / (H14 - L14)) * 100\n3C) Feature Definition: The Stochastic Oscillator is a momentum indicator comparing a particular closing price of a security to a range of its prices over a certain period of time.\n3D) Feature Parameters: { \"C\": \"Most Recent Closing Price\", \"L14\": \"Lowest Price of Past 14 Periods\", \"H14\": \"Highest Price of Past 14 Periods\"}\n\n4A) Feature Name: Average True Range (ATR)\n4B) Feature Formula: ATR = (1/n) * \u2211 TR\n4C) Feature Definition: ATR measures market volatility by decomposing the entire range of an asset price for that period.\n4D) Feature Parameters: { \"n\": \"Specified Time Period\", \"TR\": \"True Range\"}\n\n5A) Feature Name: Rate of Change (ROC)\n5B) Feature Formula: ROC = [(Close - Close n periods ago) / (Close n periods ago)] * 100\n5C) Feature Definition: ROC is a momentum oscillator that measures the percentage change between the current price and the price a certain number of periods ago.\n5D) Feature Parameters: { \"Close\": \"Most Recent Closing Price\", \"n\": \"Specified Time Period\"}\n\n6A) Feature Name: Momentum\n6B) Feature Formula: Momentum = Close - Close n periods ago\n6C) Feature Definition: Momentum is the speed or velocity of price changes in a stock, security, or tradable instrument.\n6D) Feature Parameters: { \"Close\": \"Most Recent Closing Price\", \"n\": \"Specified Time Period\"}\n\n7A) Feature Name: Bollinger Bands\n7B) Feature Formula: Middle Band = 20-day simple moving average (SMA), Upper Band = 20-day SMA + (20-day standard deviation of price x 2), Lower Band = 20-day SMA - (20-day standard deviation of price x 2)\n7C) Feature Definition: Bollinger Bands are a volatility indicator which creates a band of three lines which are plotted in relation to a security's price.\n7D) Feature Parameters: { \"SMA_20\": \"20-Day Simple Moving Average\", \"SD_20\": \"20-Day Standard Deviation of Price\"}\n\n8A) Feature Name: On Balance Volume (OBV)\n8B) Feature Formula: If Close > Close previous day then OBV = OBVprev + Volume If Close < Close previous day then OBV = OBVprev - Volume\n8C) Feature Definition: OBV is a momentum indicator that uses volume flow to predict changes in stock price.\n8D) Feature Parameters: { \"Close\": \"Most Recent Closing Price\", \"OBVprev\": \"Previous On Balance Volume\", \"Volume\": \"Current Volume\"}\n\n9A) Feature Name: Price Rate of Change (PROC)\n9B) Feature Formula: PROC = (Price_today - Price_n days ago) / Price_n days ago\n9C) Feature Definition: PROC is a momentum-based oscillator used to measure the rate of price change of a security.\n9D) Feature Parameters: { \"Price_today\": \"Current Price\", \"Price_n_days_ago\": \"Price n Days Ago\"}\n\n10A) Feature Name: Money Flow Index (MFI)\n10B) Feature Formula: MFI = 100 - (100 / (1 + Money Flow Ratio))\n10C) Feature Definition: MFI is an oscillator that uses both price and volume to measure buying and selling pressure.\n10D) Feature Parameters: { \"Money Flow Ratio\": \"Positive Money Flow / Negative Money Flow over a specified period\"}"
      },
      "finish_reason": "stop"
    }
  ],
  "usage": {
    "prompt_tokens": 213,
    "completion_tokens": 983,
    "total_tokens": 1196
  }
}
2023-09-14 05:14:29,785 [ERROR] - Exception on /handle_query [POST]
Traceback (most recent call last):
  File "D:\Workspace\Upwork\5.Refactor Python OpenAI logic\task.py", line 138, in insert_db
    cursor.execute(sql)
psycopg2.errors.SyntaxError: syntax error at or near "s"
LINE 1: ...lines which are plotted in relation to a security's price.',...
                                                             ^


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\flask\app.py", line 2190, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\flask\app.py", line 1486, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\flask_cors\extension.py", line 176, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\flask\app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\flask\app.py", line 1469, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "D:\Workspace\Upwork\5.Refactor Python OpenAI logic\task.py", line 207, in handle_query
    insert_db(user_id, query, features_info)
  File "D:\Workspace\Upwork\5.Refactor Python OpenAI logic\task.py", line 139, in insert_db
    except error:
UnboundLocalError: local variable 'error' referenced before assignment
2023-09-14 05:14:29,787 [INFO] - 127.0.0.1 - - [14/Sep/2023 05:14:29] "[35m[1mPOST /handle_query HTTP/1.1[0m" 500 -
2023-09-14 05:22:07,848 [INFO] - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5010
 * Running on http://198.18.192.20:5010
2023-09-14 05:22:07,848 [INFO] - [33mPress CTRL+C to quit[0m
2023-09-14 05:22:08,558 [INFO] - Processing /selected_papers request...
2023-09-14 05:22:08,559 [INFO] - Data received: {'user_id': 'nereus@outlook.com', 'query': 'tell me which features are related to momentum stock trading'}
2023-09-14 05:22:08,591 [DEBUG] - message='Request to OpenAI API' method=post path=https://api.openai.com/v1/chat/completions
2023-09-14 05:22:08,591 [DEBUG] - api_version=None data='{"model": "gpt-4", "messages": [{"role": "system", "content": "You are an AI assistant that provides helpful answers."}, {"role": "user", "content": "\\n    As an AI, I should understand question and provide information about 10 features in a specific format. For each feature, I need to provide feature in following format\\n\\n    1A) Feature Name: The name of the feature\\n    1B) Feature Formula: The mathematical formula for the feature\\n    1C) Feature Definition: A brief description or definition of the feature\\n    1D) Feature Parameters: Parameters or variables used in the feature formula as json format, pls provide json format\\n\\n    and number each one incrementally (so feature #2 is 2A, 2B..feature #3 is 3A, feature #4 is 4A, feature #5 is 5A... feature #10 is 10A\\n    This is my question:\\n    tell me which features are related to momentum stock trading\\n\\n    Please provide the 10 feature information according to the above format.\\n    "}], "max_tokens": 2000, "n": 1, "stop": null, "temperature": 0.7}' message='Post details'
2023-09-14 05:22:08,591 [DEBUG] - Converted retries value: 2 -> Retry(total=2, connect=None, read=None, redirect=None, status=None)
2023-09-14 05:22:08,594 [DEBUG] - Starting new HTTPS connection (1): api.openai.com:443
2023-09-14 05:23:54,856 [DEBUG] - https://api.openai.com:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2023-09-14 05:23:54,857 [DEBUG] - message='OpenAI API response' path=https://api.openai.com/v1/chat/completions processing_ms=100143 request_id=f9f5d7b8be6ad945210623a5e5fd7091 response_code=200
2023-09-14 05:23:54,867 [INFO] - OpenAI API Response: {
  "id": "chatcmpl-7ydm8bNxBQVyC6GiJ2Wd2EZ8MPzqD",
  "object": "chat.completion",
  "created": 1694686932,
  "model": "gpt-4-0613",
  "choices": [
    {
      "index": 0,
      "message": {
        "role": "assistant",
        "content": "Sure, here are 10 features related to momentum stock trading:\n\n1A) Feature Name: Relative Strength Index (RSI)\n1B) Feature Formula: RSI = 100 - (100 / (1 + RS))\n1C) Feature Definition: RSI measures the speed and change of price movements.\n1D) Feature Parameters: {\"RS\": \"Average gain of up periods during the specified time frame / Average loss of down periods during the specified time frame\"}\n\n2A) Feature Name: Moving Average Convergence Divergence (MACD)\n2B) Feature Formula: MACD = 12-Day EMA - 26-Day EMA\n2C) Feature Definition: MACD is a trend-following momentum indicator.\n2D) Feature Parameters: {\"EMA\": \"Exponential Moving Average\"}\n\n3A) Feature Name: Stochastic Oscillator\n3B) Feature Formula: %K = [(Close - Low(n)) / (High(n) - Low(n))] * 100\n3C) Feature Definition: A stochastic oscillator is a momentum indicator comparing a particular closing price of a security to a range of its prices over a certain period of time.\n3D) Feature Parameters: {\"Close\": \"Closing Price\", \"Low(n)\": \"Lowest price in last 'n' periods\", \"High(n)\": \"Highest price in last 'n' periods\"}\n\n4A) Feature Name: Rate of Change (ROC)\n4B) Feature Formula: ROC = [(Close - Close(n)) / Close(n)] * 100\n4C) Feature Definition: ROC is a momentum oscillator that measures the percentage change between the current price and the price a certain number of periods ago.\n4D) Feature Parameters: {\"Close\": \"Closing Price\", \"Close(n)\": \"Closing price 'n' periods ago\"}\n\n5A) Feature Name: On Balance Volume (OBV)\n5B) Feature Formula: If Close > Close(prev) then OBV = OBV(prev) + Volume\n5C) Feature Definition: OBV is a momentum indicator that uses volume flow to predict changes in stock price.\n5D) Feature Parameters: {\"Close\": \"Closing Price\", \"Close(prev)\": \"Previous Closing Price\", \"OBV(prev)\": \"Previous OBV\", \"Volume\": \"Current Volume\"}\n\n6A) Feature Name: Momentum\n6B) Feature Formula: Momentum = Close - Close(n)\n6C) Feature Definition: Momentum is the rate of acceleration of a security's price or volume.\n6D) Feature Parameters: {\"Close\": \"Closing Price\", \"Close(n)\": \"Closing price 'n' periods ago\"}\n\n7A) Feature Name: Price Rate of Change\n7B) Feature Formula: ROC = (Close - Close(n)) / Close(n)\n7C) Feature Definition: Price Rate of Change is a momentum-based technical indicator that measures the percentage change in price between the current price and the price a certain number of periods ago.\n7D) Feature Parameters: {\"Close\": \"Closing Price\", \"Close(n)\": \"Closing price 'n' periods ago\"}\n\n8A) Feature Name: Ultimate Oscillator\n8B) Feature Formula: UO = 100 x [(4 x BP7)+(2 x BP14)+BP28] / [(4 x TR7)+(2 x TR14)+TR28]\n8C) Feature Definition: The Ultimate Oscillator is a technical indicator that uses the weighted average of three different time periods to reduce the volatility and false transaction signals that are associated with many other indicators that mainly rely on a single time period.\n8D) Feature Parameters: {\"BP7\": \"Buying pressure for 7-day period\", \"BP14\": \"Buying pressure for 14-day period\", \"BP28\": \"Buying pressure for 28-day period\", \"TR7\": \"True range for 7-day period\", \"TR14\": \"True range for 14-day period\", \"TR28\": \"True range for 28-day period\"}\n\n9A) Feature Name: Williams %R\n9B) Feature Formula: %R = (High(n) - Close) / (High(n) - Low(n)) * -100\n9C) Feature Definition: Williams %R is a momentum indicator that measures overbought/oversold levels.\n9D) Feature Parameters: {\"High(n)\": \"Highest price over 'n' periods\", \"Close\": \"Closing price\", \"Low(n)\": \"Lowest price over 'n' periods\"}\n\n10A) Feature Name: Money Flow Index (MFI)\n10B) Feature Formula: MFI = 100 - (100/(1 + Money Flow Ratio))\n10C) Feature Definition: The Money Flow Index is a momentum indicator that measures the inflow and outflow of money into a security over a specific period of time.\n10D) Feature Parameters: {\"Money Flow Ratio\": \"Typical Price x Volume for the period\"}\n"
      },
      "finish_reason": "stop"
    }
  ],
  "usage": {
    "prompt_tokens": 213,
    "completion_tokens": 1000,
    "total_tokens": 1213
  }
}
2023-09-14 05:24:04,304 [ERROR] - Exception on /handle_query [POST]
Traceback (most recent call last):
  File "D:\Workspace\Upwork\5.Refactor Python OpenAI logic\task.py", line 138, in insert_db
    cursor.execute(sql)
psycopg2.errors.SyntaxError: syntax error at or near "n"
LINE 1: ..."Closing Price", "Low(n)": "Lowest price in last 'n' periods...
                                                             ^


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\flask\app.py", line 2190, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\flask\app.py", line 1486, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\flask_cors\extension.py", line 176, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\flask\app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\flask\app.py", line 1469, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "D:\Workspace\Upwork\5.Refactor Python OpenAI logic\task.py", line 207, in handle_query
    insert_db(user_id, query, features_info)
  File "D:\Workspace\Upwork\5.Refactor Python OpenAI logic\task.py", line 139, in insert_db
    except error:
UnboundLocalError: local variable 'error' referenced before assignment
2023-09-14 05:24:04,306 [INFO] - 127.0.0.1 - - [14/Sep/2023 05:24:04] "[35m[1mPOST /handle_query HTTP/1.1[0m" 500 -
2023-09-14 05:29:32,819 [INFO] - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5010
 * Running on http://198.18.192.20:5010
2023-09-14 05:29:32,819 [INFO] - [33mPress CTRL+C to quit[0m
2023-09-14 05:29:56,941 [INFO] - Processing /selected_papers request...
2023-09-14 05:29:56,942 [INFO] - Data received: {'user_id': 'nereus@outlook.com', 'query': 'tell me which features are related to momentum stock trading'}
2023-09-14 05:29:56,978 [DEBUG] - message='Request to OpenAI API' method=post path=https://api.openai.com/v1/chat/completions
2023-09-14 05:29:56,978 [DEBUG] - api_version=None data='{"model": "gpt-4", "messages": [{"role": "system", "content": "You are an AI assistant that provides helpful answers."}, {"role": "user", "content": "\\n    As an AI, I should understand question and provide information about 10 features in a specific format. For each feature, I need to provide feature in following format\\n\\n    1A) Feature Name: The name of the feature\\n    1B) Feature Formula: The mathematical formula for the feature\\n    1C) Feature Definition: A brief description or definition of the feature\\n    1D) Feature Parameters: Parameters or variables used in the feature formula as json format, pls provide json format\\n\\n    and number each one incrementally (so feature #2 is 2A, 2B..feature #3 is 3A, feature #4 is 4A, feature #5 is 5A... feature #10 is 10A\\n    This is my question:\\n    tell me which features are related to momentum stock trading\\n\\n    Please provide the 10 feature information according to the above format.\\n    "}], "max_tokens": 2000, "n": 1, "stop": null, "temperature": 0.7}' message='Post details'
2023-09-14 05:29:56,979 [DEBUG] - Converted retries value: 2 -> Retry(total=2, connect=None, read=None, redirect=None, status=None)
2023-09-14 05:29:56,982 [DEBUG] - Starting new HTTPS connection (1): api.openai.com:443
2023-09-14 05:31:53,178 [DEBUG] - https://api.openai.com:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2023-09-14 05:31:53,180 [DEBUG] - message='OpenAI API response' path=https://api.openai.com/v1/chat/completions processing_ms=107969 request_id=6c4874a41c44e1db59de4977c611ef1a response_code=200
2023-09-14 05:31:53,190 [INFO] - OpenAI API Response: {
  "id": "chatcmpl-7ydtmXa16JFjWXjC9vxxxBH3Tk9co",
  "object": "chat.completion",
  "created": 1694687406,
  "model": "gpt-4-0613",
  "choices": [
    {
      "index": 0,
      "message": {
        "role": "assistant",
        "content": "Sure, here are some features related to momentum stock trading:\n\n1A) Feature Name: Momentum\n1B) Feature Formula: Momentum = V - Vx\n1C) Feature Definition: Momentum is a measure of the speed at which the price of an asset is moving. It is calculated by subtracting the closing price x days ago from the latest closing price.\n1D) Feature Parameters: {\"V\": \"Latest closing price\", \"Vx\": \"Closing price x days ago\"}\n\n2A) Feature Name: Relative Strength Index (RSI)\n2B) Feature Formula: RSI = 100 - (100 / (1 + RS))\n2C) Feature Definition: RSI compares the magnitude of recent gains and losses over a specified time period to measure speed and change of price movements of a security.\n2D) Feature Parameters: {\"RS\": \"Average gain / Average loss\"}\n\n3A) Feature Name: Moving Average Convergence Divergence (MACD)\n3B) Feature Formula: MACD = 12-Period EMA - 26-Period EMA\n3C) Feature Definition: MACD is a trend-following momentum indicator that shows the relationship between two moving averages of a security's price.\n3D) Feature Parameters: {\"12-Period EMA\": \"12-Period Exponential Moving Average\", \"26-Period EMA\": \"26-Period Exponential Moving Average\"}\n\n4A) Feature Name: Stochastic Oscillator\n4B) Feature Formula: %K = [(Current Close - Lowest Low) / (Highest High - Lowest Low)] * 100\n4C) Feature Definition: The Stochastic Oscillator is a momentum indicator that compares a particular closing price of a security to a range of its prices over a certain period of time.\n4D) Feature Parameters: {\"Current Close\": \"Most recent closing price\", \"Lowest Low\": \"Lowest price in the lookback period\", \"Highest High\": \"Highest price in the lookback period\"}\n\n5A) Feature Name: Rate of Change (ROC)\n5B) Feature Formula: ROC = [(Close - Close n periods ago) / (Close n periods ago)] * 100\n5C) Feature Definition: The Rate of Change is a momentum oscillator that measures the percentage change in price between the current price and the price a certain number of periods ago.\n5D) Feature Parameters: {\"Close\": \"Most recent closing price\", \"Close n periods ago\": \"Closing price n periods ago\"}\n\n6A) Feature Name: On Balance Volume (OBV)\n6B) Feature Formula: If close > close yesterday then: OBV = OBV yesterday + volume today. If close < close yesterday then: OBV = OBV yesterday - volume today.\n6C) Feature Definition: OBV is a momentum indicator that uses volume flow to predict changes in stock price.\n6D) Feature Parameters: {\"Close\": \"Today's closing price\", \"Close yesterday\": \"Yesterday's closing price\", \"OBV yesterday\": \"Yesterday's On Balance Volume\", \"Volume today\": \"Today's volume\"}\n\n7A) Feature Name: Money Flow Index (MFI)\n7B) Feature Formula: MFI = 100 - (100/(1 + Money Ratio))\n7C) Feature Definition: The MFI is a momentum indicator that measures the inflow and outflow of money into a security over a specific period of time.\n7D) Feature Parameters: {\"Money Ratio\": \"Positive money flow / Negative money flow\"}\n\n8A) Feature Name: Average Directional Index (ADX)\n8B) Feature Formula: ADX = 100 * smoothed moving average of |DI+ - DI-| / (DI+ + DI-)\n8C) Feature Definition: ADX is a technical analysis indicator used to determine the strength of a trend.\n8D) Feature Parameters: {\"DI+\": \"Directional Indicator Plus\", \"DI-\": \"Directional Indicator Minus\"}\n\n9A) Feature Name: Bollinger Bands\n9B) Feature Formula: Upper Band = SMA + (2 * standard deviation), Lower Band = SMA - (2 * standard deviation)\n9C) Feature Definition: Bollinger Bands are a volatility indicator which creates a band of three lines which are plotted in relation to a security's price.\n9D) Feature Parameters: {\"SMA\": \"Simple Moving Average\", \"Standard Deviation\": \"Standard deviation of price\"}\n\n10A) Feature Name: Commodity Channel Index (CCI)\n10B) Feature Formula: CCI = (Typical Price - 20-period SMA of TP) / (0.015 * Mean Deviation)\n10C) Feature Definition: The Commodity Channel Index is a versatile indicator that can be used to identify a new trend or warn of extreme conditions.\n10D) Feature Parameters: {\"Typical Price\": \"(High + Low + Close)/3\", \"SMA of TP\": \"Simple Moving Average of Typical Price\", \"Mean Deviation\": \"Average of the absolute differences between Typical Price and SMA of TP\"}"
      },
      "finish_reason": "stop"
    }
  ],
  "usage": {
    "prompt_tokens": 213,
    "completion_tokens": 1033,
    "total_tokens": 1246
  }
}
2023-09-14 05:32:04,086 [ERROR] - Exception on /handle_query [POST]
Traceback (most recent call last):
  File "D:\Workspace\Upwork\5.Refactor Python OpenAI logic\task.py", line 138, in insert_db
    cursor.execute(sql)
psycopg2.errors.SyntaxError: syntax error at or near "s"
LINE 1: ...ionship between two moving averages of a security's price.',...
                                                             ^


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\flask\app.py", line 2190, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\flask\app.py", line 1486, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\flask_cors\extension.py", line 176, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\flask\app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\flask\app.py", line 1469, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "D:\Workspace\Upwork\5.Refactor Python OpenAI logic\task.py", line 212, in handle_query
    insert_db(user_id, query, features_info)
  File "D:\Workspace\Upwork\5.Refactor Python OpenAI logic\task.py", line 139, in insert_db
    except error:
UnboundLocalError: local variable 'error' referenced before assignment
2023-09-14 05:32:04,089 [INFO] - 127.0.0.1 - - [14/Sep/2023 05:32:04] "[35m[1mPOST /handle_query HTTP/1.1[0m" 500 -
2023-09-14 07:21:55,597 [INFO] - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5010
 * Running on http://198.18.192.23:5010
2023-09-14 07:21:55,598 [INFO] - [33mPress CTRL+C to quit[0m
2023-09-14 07:21:56,621 [INFO] - Processing /selected_papers request...
2023-09-14 07:21:56,623 [INFO] - Data received: {'user_id': 'nereus@outlook.com', 'query': 'tell me which features are related to momentum stock trading'}
2023-09-14 07:21:56,647 [DEBUG] - message='Request to OpenAI API' method=post path=https://api.openai.com/v1/chat/completions
2023-09-14 07:21:56,647 [DEBUG] - api_version=None data='{"model": "gpt-4", "messages": [{"role": "system", "content": "You are an AI assistant that provides helpful answers."}, {"role": "user", "content": "\\n    As an AI, I should understand question and provide information about 10 features in a specific format. For each feature, I need to provide feature in following format\\n\\n    1A) Feature Name: The name of the feature\\n    1B) Feature Formula: The mathematical formula for the feature\\n    1C) Feature Definition: A brief description or definition of the feature\\n    1D) Feature Parameters: Parameters or variables used in the feature formula as json format, pls provide json format\\n\\n    and number each one incrementally (so feature #2 is 2A, 2B..feature #3 is 3A, feature #4 is 4A, feature #5 is 5A... feature #10 is 10A\\n    This is my question:\\n    tell me which features are related to momentum stock trading\\n\\n    Please provide the 10 feature information according to the above format.\\n    "}], "max_tokens": 2000, "n": 1, "stop": null, "temperature": 0.7}' message='Post details'
2023-09-14 07:21:56,648 [DEBUG] - Converted retries value: 2 -> Retry(total=2, connect=None, read=None, redirect=None, status=None)
2023-09-14 07:21:56,651 [DEBUG] - Starting new HTTPS connection (1): api.openai.com:443
2023-09-14 07:23:46,624 [DEBUG] - https://api.openai.com:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2023-09-14 07:23:46,626 [DEBUG] - message='OpenAI API response' path=https://api.openai.com/v1/chat/completions processing_ms=107089 request_id=8f7caf2af2d089c027b2d58ac0c8c515 response_code=200
2023-09-14 07:23:46,636 [INFO] - OpenAI API Response: {
  "id": "chatcmpl-7yfe3M19WjqwiZCTNZVsP6Bddi3Pk",
  "object": "chat.completion",
  "created": 1694694119,
  "model": "gpt-4-0613",
  "choices": [
    {
      "index": 0,
      "message": {
        "role": "assistant",
        "content": "Sure, here are the 10 features related to Momentum Stock Trading:\n\n1A) Feature Name: Relative Strength Index (RSI)\n1B) Feature Formula: RSI = 100 - (100 / (1 + RS))\n1C) Feature Definition: RSI compares the magnitude of recent gains to recent losses in an attempt to determine overbought and oversold conditions of a security.\n1D) Feature Parameters: {\"RS\": \"Average gain of up periods during the specified time frame / Average loss of down periods during the specified time frame\"}\n\n2A) Feature Name: Moving Average Convergence Divergence (MACD)\n2B) Feature Formula: MACD = 12-Period EMA - 26-Period EMA\n2C) Feature Definition: MACD is used to identify changes in the strength, direction, momentum, and duration of a trend in a stock's price.\n2D) Feature Parameters: {\"12-Period EMA\": \"Short-term EMA\", \"26-Period EMA\": \"Long-term EMA\"}\n\n3A) Feature Name: Stochastic Oscillator\n3B) Feature Formula: %K = (Closing Price - Lowest Price)/(Highest Price - Lowest Price) * 100\n3C) Feature Definition: It compares a security's trading price to its price range over a specific period of time.\n3D) Feature Parameters: {\"Closing Price\": \"Most recent closing price\", \"Lowest Price\": \"Lowest price in the look-back period\", \"Highest Price\": \"Highest price in the look-back period\"}\n\n4A) Feature Name: Rate of Change (ROC)\n4B) Feature Formula: ROC = [(Close - Close n periods ago) / (Close n periods ago)] * 100\n4C) Feature Definition: ROC measures the percentage change in price from one period to the next.\n4D) Feature Parameters: {\"Close\": \"Most recent closing price\", \"Close n periods ago\": \"Closing price n periods ago\"}\n\n5A) Feature Name: On Balance Volume (OBV)\n5B) Feature Formula: If close > close of previous day then OBV = previous OBV + today's volume\n5C) Feature Definition: OBV measures buying and selling pressure as a cumulative indicator, adding volume on up days and subtracting it on down days.\n5D) Feature Parameters: {\"Close\": \"Today's closing price\", \"previous close\": \"Previous day's closing price\", \"volume\": \"Today's volume\"}\n\n6A) Feature Name: Money Flow Index (MFI)\n6B) Feature Formula: MFI = 100 - (100 / (1 + Money Flow Ratio))\n6C) Feature Definition: MFI is a momentum indicator that measures the inflow and outflow of money into a security over a specific period of time.\n6D) Feature Parameters: {\"Money Flow Ratio\": \"The ratio of positive money flow to negative money flow\"}\n\n7A) Feature Name: Bollinger Bands\n7B) Feature Formula: Middle Band = 20-day simple moving average (SMA), Upper Band = 20-day SMA + (20-day standard deviation of price x 2), Lower Band = 20-day SMA - (20-day standard deviation of price x 2)\n7C) Feature Definition: Bollinger Bands are volatility bands placed above and below a moving average where the volatility is based on standard deviation which changes as volatility increases or decreases.\n7D) Feature Parameters: {\"SMA\": \"Simple moving average\", \"Standard Deviation\": \"Standard deviation of the price\"}\n\n8A) Feature Name: Average Directional Index (ADX)\n8B) Feature Formula: ADX = 100 x EMA of the absolute value of (+DI - -DI) / (+DI + -DI)\n8C) Feature Definition: The ADX is used to measure the strength or weakness of a trend, not the actual direction.\n8D) Feature Parameters: {\"+DI\": \"Positive directional indicator\", \"-DI\": \"Negative directional indicator\", \"EMA\": \"Exponential moving average\"}\n\n9A) Feature Name: Commodity Channel Index (CCI)\n9B) Feature Formula: CCI = (Typical Price - 20-period SMA of TP) / (0.015 x Mean Deviation)\n9C) Feature Definition: CCI is a versatile indicator that can be used to identify a new trend or warn of extreme conditions.\n9D) Feature Parameters: {\"Typical Price\": \"(High + Low + Close)/3\", \"SMA\": \"Simple moving average\", \"Mean Deviation\": \"Average of absolute differences from the mean price\"}\n\n10A) Feature Name: Volume Weighted Average Price (VWAP)\n10B) Feature Formula: VWAP = Total Dollar Value of Shares Traded / Total Shares Traded\n10C) Feature Definition: VWAP provides the average price a security has traded at throughout the day, based on both volume and price.\n10D) Feature Parameters: {\"Total Dollar Value of Shares Traded\": \"Sum of (Price x Volume) for every transaction\", \"Total Shares Traded\": \"Sum of Volume for every transaction\"}"
      },
      "finish_reason": "stop"
    }
  ],
  "usage": {
    "prompt_tokens": 213,
    "completion_tokens": 1057,
    "total_tokens": 1270
  }
}
2023-09-14 07:23:52,793 [ERROR] - Exception on /handle_query [POST]
Traceback (most recent call last):
  File "D:\Workspace\Upwork\5.Refactor Python OpenAI logic\task.py", line 138, in insert_db
    cursor.execute(sql)
psycopg2.errors.SyntaxError: syntax error at or near "s"
LINE 1: ...ion, momentum, and duration of a trend in a stock's price.',...
                                                             ^


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\flask\app.py", line 2190, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\flask\app.py", line 1486, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\flask_cors\extension.py", line 176, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\flask\app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\flask\app.py", line 1469, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "D:\Workspace\Upwork\5.Refactor Python OpenAI logic\task.py", line 212, in handle_query
    insert_db(user_id, query, features_info)
  File "D:\Workspace\Upwork\5.Refactor Python OpenAI logic\task.py", line 139, in insert_db
    except error:
UnboundLocalError: local variable 'error' referenced before assignment
2023-09-14 07:23:52,796 [INFO] - 127.0.0.1 - - [14/Sep/2023 07:23:52] "[35m[1mPOST /handle_query HTTP/1.1[0m" 500 -
2023-09-14 07:28:47,217 [INFO] - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5010
 * Running on http://198.18.192.23:5010
2023-09-14 07:28:47,218 [INFO] - [33mPress CTRL+C to quit[0m
2023-09-14 07:29:17,426 [INFO] - Processing /selected_papers request...
2023-09-14 07:29:17,427 [INFO] - Data received: {'user_id': 'nereus@outlook.com', 'query': 'tell me which features are related to momentum stock trading'}
2023-09-14 07:29:17,480 [DEBUG] - message='Request to OpenAI API' method=post path=https://api.openai.com/v1/chat/completions
2023-09-14 07:29:17,480 [DEBUG] - api_version=None data='{"model": "gpt-4", "messages": [{"role": "system", "content": "You are an AI assistant that provides helpful answers."}, {"role": "user", "content": "\\n    As an AI, I should understand question and provide information about 10 features in a specific format. For each feature, I need to provide feature in following format\\n\\n    1A) Feature Name: The name of the feature\\n    1B) Feature Formula: The mathematical formula for the feature\\n    1C) Feature Definition: A brief description or definition of the feature\\n    1D) Feature Parameters: Parameters or variables used in the feature formula as json format, pls provide json format\\n\\n    and number each one incrementally (so feature #2 is 2A, 2B..feature #3 is 3A, feature #4 is 4A, feature #5 is 5A... feature #10 is 10A\\n    This is my question:\\n    tell me which features are related to momentum stock trading\\n\\n    Please provide the 10 feature information according to the above format.\\n    "}], "max_tokens": 2000, "n": 1, "stop": null, "temperature": 0.7}' message='Post details'
2023-09-14 07:29:17,481 [DEBUG] - Converted retries value: 2 -> Retry(total=2, connect=None, read=None, redirect=None, status=None)
2023-09-14 07:29:17,483 [DEBUG] - Starting new HTTPS connection (1): api.openai.com:443
2023-09-14 07:31:08,465 [DEBUG] - https://api.openai.com:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2023-09-14 07:31:08,466 [DEBUG] - message='OpenAI API response' path=https://api.openai.com/v1/chat/completions processing_ms=105739 request_id=a5c5709c121bc9a208c49eba223d73e1 response_code=200
2023-09-14 07:31:08,476 [INFO] - OpenAI API Response: {
  "id": "chatcmpl-7yflBNxUfk98sMJuZMZYuhm4u9mfw",
  "object": "chat.completion",
  "created": 1694694561,
  "model": "gpt-4-0613",
  "choices": [
    {
      "index": 0,
      "message": {
        "role": "assistant",
        "content": "1A) Feature Name: Relative Strength Index (RSI)\n1B) Feature Formula: RSI = 100 - (100 / (1 + RS))\n1C) Feature Definition: RSI is a momentum oscillator that measures the speed and change of price movements. It is typically used to identify overbought or oversold conditions in a trade.\n1D) Feature Parameters: {\"RS\": \"Average gain of up periods / Average loss of down periods\"}\n\n2A) Feature Name: Moving Average Convergence Divergence (MACD)\n2B) Feature Formula: MACD = 12-Period EMA - 26-Period EMA\n2C) Feature Definition: MACD is a trend-following momentum indicator that shows the relationship between two moving averages of a security\u2019s price.\n2D) Feature Parameters: {\"EMA\": \"Exponential moving average\"}\n\n3A) Feature Name: Stochastic Oscillator\n3B) Feature Formula: %K = (Current Close - Lowest Low)/(Highest High - Lowest Low) * 100\n3C) Feature Definition: The stochastic oscillator is a momentum indicator comparing a particular closing price of a security to a range of its prices over a certain period of time.\n3D) Feature Parameters: {\"Current Close\": \"Most recent closing price\", \"Lowest Low\": \"Lowest price in the lookback period\", \"Highest High\": \"Highest price in the lookback period\"}\n\n4A) Feature Name: On-Balance Volume (OBV)\n4B) Feature Formula: If close > close_prev then: OBV = OBV_prev + volume. If close < close_prev then: OBV = OBV_prev - volume.\n4C) Feature Definition: OBV is a technical trading momentum indicator that uses volume flow to predict changes in stock price.\n4D) Feature Parameters: {\"volume\": \"The volume of the current period\", \"OBV_prev\": \"On-Balance Volume of the previous period\", \"close\": \"Closing price of the current period\", \"close_prev\": \"Closing price of the previous period\"}\n\n5A) Feature Name: Price Rate Of Change (ROC)\n5B) Feature Formula: ROC = [(Close - Close n periods ago) / (Close n periods ago)] * 100\n5C) Feature Definition: ROC is a momentum oscillator, which measures the percentage change between the current price and the n period past price.\n5D) Feature Parameters: {\"Close\": \"Most recent closing price\", \"Close n periods ago\": \"Closing price n periods ago\"}\n\n6A) Feature Name: Volume Weighted Average Price (VWAP)\n6B) Feature Formula: VWAP = \u2211 (Price * Volume) / \u2211 Volume\n6C) Feature Definition: VWAP is a trading benchmark used by traders that gives the average price a security has traded at throughout the day, based on both volume and price.\n6D) Feature Parameters: {\"Price\": \"Price of each transaction\", \"Volume\": \"Volume of each transaction\"}\n\n7A) Feature Name: Accumulation/Distribution Line (ADL)\n7B) Feature Formula: ADL = ((Close - Low) - (High - Close)) / (High - Low) * Volume\n7C) Feature Definition: ADL is a volume-based indicator designed to measure the cumulative flow of money into and out of a security.\n7D) Feature Parameters: {\"Close\": \"Closing price\", \"High\": \"Highest price\", \"Low\": \"Lowest price\", \"Volume\": \"Volume of transactions\"}\n\n8A) Feature Name: Money Flow Index (MFI)\n8B) Feature Formula: MFI = 100 - (100 / (1 + Money Ratio))\n8C) Feature Definition: MFI is a momentum indicator that uses price and volume to predict the reliability of the current trend.\n8D) Feature Parameters: {\"Money Ratio\": \"Positive money flow / Negative money flow\"}\n\n9A) Feature Name: Average Directional Index (ADX)\n9B) Feature Formula: ADX = 100 * EMA(abs(+DI - -DI) / (+DI + -DI))\n9C) Feature Definition: ADX is an indicator that measures the strength of a trend and can be useful to determine if a trend is strong or weak.\n9D) Feature Parameters: {\"+DI\": \"Positive directional movement\", \"-DI\": \"Negative directional movement\", \"EMA\": \"Exponential moving average\"}\n\n10A) Feature Name: Bollinger Bands\n10B) Feature Formula: Middle Band = 20-day simple moving average (SMA), Upper Band = 20-day SMA + (20-day standard deviation of price * 2), Lower Band = 20-day SMA - (20-day standard deviation of price * 2)\n10C) Feature Definition: Bollinger Bands are a volatility indicator which creates a band of three lines which are plotted in relation to a security's price.\n10D) Feature Parameters: {\"SMA\": \"Simple moving average\", \"standard deviation\": \"Standard deviation of price\"}\n"
      },
      "finish_reason": "stop"
    }
  ],
  "usage": {
    "prompt_tokens": 213,
    "completion_tokens": 1035,
    "total_tokens": 1248
  }
}
2023-09-14 07:31:16,842 [ERROR] - Exception on /handle_query [POST]
Traceback (most recent call last):
  File "D:\Workspace\Upwork\5.Refactor Python OpenAI logic\task.py", line 138, in insert_db
    cursor.execute(sql)
psycopg2.errors.SyntaxError: syntax error at or near "s"
LINE 1: ...ion, momentum, and duration of a trend in a stock's price.',...
                                                             ^


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\flask\app.py", line 2190, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\flask\app.py", line 1486, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\flask_cors\extension.py", line 176, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\flask\app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\flask\app.py", line 1469, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "D:\Workspace\Upwork\5.Refactor Python OpenAI logic\task.py", line 267, in handle_query
    insert_db(user_id, query, features_info)
  File "D:\Workspace\Upwork\5.Refactor Python OpenAI logic\task.py", line 139, in insert_db
    except error:
UnboundLocalError: local variable 'error' referenced before assignment
2023-09-14 07:31:16,844 [INFO] - 127.0.0.1 - - [14/Sep/2023 07:31:16] "[35m[1mPOST /handle_query HTTP/1.1[0m" 500 -
2023-09-14 07:34:51,716 [INFO] - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5010
 * Running on http://198.18.192.23:5010
2023-09-14 07:34:51,717 [INFO] - [33mPress CTRL+C to quit[0m
2023-09-14 07:34:52,091 [INFO] - Processing /selected_papers request...
2023-09-14 07:34:52,092 [INFO] - Data received: {'user_id': 'nereus@outlook.com', 'query': 'tell me which features are related to momentum stock trading'}
2023-09-14 07:34:52,118 [DEBUG] - message='Request to OpenAI API' method=post path=https://api.openai.com/v1/chat/completions
2023-09-14 07:34:52,118 [DEBUG] - api_version=None data='{"model": "gpt-4", "messages": [{"role": "system", "content": "You are an AI assistant that provides helpful answers."}, {"role": "user", "content": "\\n    As an AI, I should understand question and provide information about 10 features in a specific format. For each feature, I need to provide feature in following format\\n\\n    1A) Feature Name: The name of the feature\\n    1B) Feature Formula: The mathematical formula for the feature\\n    1C) Feature Definition: A brief description or definition of the feature\\n    1D) Feature Parameters: Parameters or variables used in the feature formula as json format, pls provide json format\\n\\n    and number each one incrementally (so feature #2 is 2A, 2B..feature #3 is 3A, feature #4 is 4A, feature #5 is 5A... feature #10 is 10A\\n    This is my question:\\n    tell me which features are related to momentum stock trading\\n\\n    Please provide the 10 feature information according to the above format.\\n    "}], "max_tokens": 2000, "n": 1, "stop": null, "temperature": 0.7}' message='Post details'
2023-09-14 07:34:52,119 [DEBUG] - Converted retries value: 2 -> Retry(total=2, connect=None, read=None, redirect=None, status=None)
2023-09-14 07:34:52,121 [DEBUG] - Starting new HTTPS connection (1): api.openai.com:443
2023-09-14 07:36:38,201 [DEBUG] - https://api.openai.com:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2023-09-14 07:36:38,202 [DEBUG] - message='OpenAI API response' path=https://api.openai.com/v1/chat/completions processing_ms=95583 request_id=4768e32597158b8c391ceb8a425b1944 response_code=200
2023-09-14 07:36:38,218 [INFO] - OpenAI API Response: {
  "id": "chatcmpl-7yfqdEd0sqmDRIFtpTRzPUauD0IRe",
  "object": "chat.completion",
  "created": 1694694899,
  "model": "gpt-4-0613",
  "choices": [
    {
      "index": 0,
      "message": {
        "role": "assistant",
        "content": "Sure, here are 10 features related to momentum stock trading:\n\n1A) Feature Name: Relative Strength Index (RSI)\n1B) Feature Formula: RSI = 100 - (100 / (1 + RS))\n1C) Feature Definition: The RSI is an indicator that calculates price momentum. It fluctuates between 0 and 100, providing insights about the speed and change of price movements.\n1D) Feature Parameters: {\"RS\": \"Average gain of up periods during the specified time frame / average loss of down periods during the specified time frame\"}\n\n2A) Feature Name: Moving Average Convergence Divergence (MACD)\n2B) Feature Formula: MACD = 12-day EMA - 26-day EMA\n2C) Feature Definition: The MACD is a trend-following momentum indicator that shows the relationship between two moving averages of a security\u2019s price.\n2D) Feature Parameters: {\"EMA\": \"Exponential moving average\"}\n\n3A) Feature Name: Stochastic Oscillator\n3B) Feature Formula: %K = (Current Close - Lowest Low)/(Highest High - Lowest Low) * 100\n3C) Feature Definition: The stochastic oscillator is a momentum indicator comparing a particular closing price of a security to a range of its prices over a certain period of time.\n3D) Feature Parameters: {\"Current Close\": \"Most recent closing price\", \"Lowest Low\": \"lowest price in the lookback period\", \"Highest High\": \"highest price in the lookback period\"}\n\n4A) Feature Name: Rate of Change (ROC)\n4B) Feature Formula: ROC = [(Close - Close n periods ago) / (Close n periods ago)] * 100\n4C) Feature Definition: The ROC is a momentum oscillator that measures the percentage change in price between the current price and the price a certain number of periods ago.\n4D) Feature Parameters: {\"Close\": \"Most recent closing price\", \"n periods ago\": \"closing price n periods ago\"}\n\n5A) Feature Name: Momentum\n5B) Feature Formula: Momentum = Current Price - Price n periods ago\n5C) Feature Definition: Momentum is the rate of acceleration of a security's price or volume.\n5D) Feature Parameters: {\"Current Price\": \"Most recent price\", \"Price n periods ago\": \"price n periods ago\"}\n\n6A) Feature Name: Volume Weighted Average Price (VWAP)\n6B) Feature Formula: VWAP = \u2211 (Price * Volume) / \u2211 Volume\n6C) Feature Definition: VWAP is a trading benchmark used by traders that gives the average price a security has traded at throughout the day, based on both volume and price.\n6D) Feature Parameters: {\"Price\": \"price of the security\", \"Volume\": \"volume of the security traded\"}\n\n7A) Feature Name: Money Flow Index (MFI)\n7B) Feature Formula: MFI = 100 - (100 / (1 + Money Ratio))\n7C) Feature Definition: The MFI is a momentum indicator that measures the inflow and outflow of money into a security over a specific period of time.\n7D) Feature Parameters: {\"Money Ratio\": \"Positive Money Flow / Negative Money Flow\"}\n\n8A) Feature Name: On Balance Volume (OBV)\n8B) Feature Formula: If close > close of previous day then OBV = previous OBV + current volume\n8C) Feature Definition: OBV is a momentum indicator that uses volume flow to predict changes in stock price.\n8D) Feature Parameters: {\"current volume\": \"volume of the current day\", \"previous OBV\": \"OBV of the previous day\"}\n\n9A) Feature Name: Williams %R\n9B) Feature Formula: %R = (Highest High - Close)/(Highest High - Lowest Low) * -100\n9C) Feature Definition: Williams %R, also known as the Williams Percent Range, is a type of momentum indicator that moves between 0 and -100 and measures overbought and oversold levels.\n9D) Feature Parameters: {\"Highest High\": \"highest price in the lookback period\", \"Lowest Low\": \"lowest price in the lookback period\", \"Close\": \"Most recent closing price\"}\n\n10A) Feature Name: Accumulation/Distribution Line (ADL)\n10B) Feature Formula: ADL = ((Close - Low) - (High - Close)) / (High - Low) * Volume + Previous ADL\n10C) Feature Definition: The ADL is a volume-based indicator designed to measure the cumulative flow of money into and out of a security.\n10D) Feature Parameters: {\"Close\": \"Most recent closing price\", \"Low\": \"Lowest price of the period\", \"High\": \"Highest price of the period\", \"Volume\": \"Volume of the period\", \"Previous ADL\": \"ADL of the previous period\"}"
      },
      "finish_reason": "stop"
    }
  ],
  "usage": {
    "prompt_tokens": 213,
    "completion_tokens": 1011,
    "total_tokens": 1224
  }
}
2023-09-14 07:36:52,139 [ERROR] - Exception on /handle_query [POST]
Traceback (most recent call last):
  File "D:\Workspace\Upwork\5.Refactor Python OpenAI logic\task.py", line 138, in insert_db
    cursor.execute(sql)
psycopg2.errors.SyntaxError: syntax error at or near "s"
LINE 1: ...omentum is the rate of acceleration of a security's price or...
                                                             ^


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\flask\app.py", line 2190, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\flask\app.py", line 1486, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\flask_cors\extension.py", line 176, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\flask\app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\flask\app.py", line 1469, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "D:\Workspace\Upwork\5.Refactor Python OpenAI logic\task.py", line 217, in handle_query
    insert_db(user_id, query, features_info)
  File "D:\Workspace\Upwork\5.Refactor Python OpenAI logic\task.py", line 140, in insert_db
    except error:
UnboundLocalError: local variable 'error' referenced before assignment
2023-09-14 07:36:52,142 [INFO] - 127.0.0.1 - - [14/Sep/2023 07:36:52] "[35m[1mPOST /handle_query HTTP/1.1[0m" 500 -
2023-09-14 07:40:41,233 [INFO] - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5010
 * Running on http://198.18.192.23:5010
2023-09-14 07:40:41,234 [INFO] - [33mPress CTRL+C to quit[0m
2023-09-14 07:40:45,485 [INFO] - Processing /selected_papers request...
2023-09-14 07:40:45,486 [INFO] - Data received: {'user_id': 'nereus@outlook.com', 'query': 'tell me which features are related to momentum stock trading'}
2023-09-14 07:40:45,513 [DEBUG] - message='Request to OpenAI API' method=post path=https://api.openai.com/v1/chat/completions
2023-09-14 07:40:45,513 [DEBUG] - api_version=None data='{"model": "gpt-4", "messages": [{"role": "system", "content": "You are an AI assistant that provides helpful answers."}, {"role": "user", "content": "\\n    As an AI, I should understand question and provide information about 10 features in a specific format. For each feature, I need to provide feature in following format\\n\\n    1A) Feature Name: The name of the feature\\n    1B) Feature Formula: The mathematical formula for the feature\\n    1C) Feature Definition: A brief description or definition of the feature\\n    1D) Feature Parameters: Parameters or variables used in the feature formula as json format, pls provide json format\\n\\n    and number each one incrementally (so feature #2 is 2A, 2B..feature #3 is 3A, feature #4 is 4A, feature #5 is 5A... feature #10 is 10A\\n    This is my question:\\n    tell me which features are related to momentum stock trading\\n\\n    Please provide the 10 feature information according to the above format.\\n    "}], "max_tokens": 2000, "n": 1, "stop": null, "temperature": 0.7}' message='Post details'
2023-09-14 07:40:45,513 [DEBUG] - Converted retries value: 2 -> Retry(total=2, connect=None, read=None, redirect=None, status=None)
2023-09-14 07:40:45,516 [DEBUG] - Starting new HTTPS connection (1): api.openai.com:443
2023-09-14 07:42:14,572 [DEBUG] - https://api.openai.com:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2023-09-14 07:42:14,574 [DEBUG] - message='OpenAI API response' path=https://api.openai.com/v1/chat/completions processing_ms=84288 request_id=c7c1554c0aaa08eba108b7497d886f7a response_code=200
2023-09-14 07:42:14,587 [INFO] - OpenAI API Response: {
  "id": "chatcmpl-7yfwI2niel1cOsPAXjZr6uRuSAUtU",
  "object": "chat.completion",
  "created": 1694695250,
  "model": "gpt-4-0613",
  "choices": [
    {
      "index": 0,
      "message": {
        "role": "assistant",
        "content": "Sure, here are ten features related to momentum stock trading:\n\n1A) Feature Name: Relative Strength Index (RSI)\n1B) Feature Formula: RSI = 100 - (100 / (1 + RS))\n1C) Feature Definition: A momentum indicator that measures the speed and change of price movements.\n1D) Feature Parameters: {\"RS\": \"Average gain of up periods / Average loss of down periods\"}\n\n2A) Feature Name: Moving Average Convergence Divergence (MACD)\n2B) Feature Formula: MACD = 12-day EMA - 26-day EMA\n2C) Feature Definition: A trend-following momentum indicator that shows the relationship between two moving averages of a security\u2019s price.\n2D) Feature Parameters: {\"EMA\": \"Exponential Moving Average\"}\n\n3A) Feature Name: Stochastic Oscillator\n3B) Feature Formula: %K = (Current Close - Lowest Low)/(Highest High - Lowest Low) * 100\n3C) Feature Definition: A momentum indicator comparing a particular closing price of a security to a range of its prices over a certain period of time.\n3D) Feature Parameters: {\"Current Close\": \"Most recent closing price\", \"Lowest Low\": \"Lowest price in the look-back period\", \"Highest High\": \"Highest price in the look-back period\"}\n\n4A) Feature Name: Rate of Change (ROC)\n4B) Feature Formula: ROC = [(Close - Close n periods ago) / (Close n periods ago)] * 100\n4C) Feature Definition: A momentum oscillator that measures the percentage change between the current price and the price a certain number of periods ago.\n4D) Feature Parameters: {\"Close\": \"Most recent closing price\", \"n\": \"Number of periods\"}\n\n5A) Feature Name: On Balance Volume (OBV)\n5B) Feature Formula: If close > close(previous day) then OBV = OBV(previous day) + volume\n5C) Feature Definition: A momentum indicator that uses volume flow to predict changes in stock price.\n5D) Feature Parameters: {\"Close\": \"Most recent closing price\", \"Volume\": \"Number of shares traded\"}\n\n6A) Feature Name: Average Directional Index (ADX)\n6B) Feature Formula: ADX = 100 * smoothed moving average of absolute value (2 * DM - TR) / (2 * DM + TR)\n6C) Feature Definition: An indicator that measures trend strength without regard to trend direction.\n6D) Feature Parameters: {\"DM\": \"Directional Movement\", \"TR\": \"True Range\"}\n\n7A) Feature Name: Commodity Channel Index (CCI)\n7B) Feature Formula: CCI = ( Typical Price - Simple Moving Average ) / ( 0.015 * Mean Deviation )\n7C) Feature Definition: An oscillator that helps identify price reversals, price extremes, and trend strength.\n7D) Feature Parameters: {\"Typical Price\": \"(High + Low + Close)/3\", \"Simple Moving Average\": \"Average of closing price over a specified period\", \"Mean Deviation\": \"Average of price deviations from the average price\"}\n\n8A) Feature Name: Ultimate Oscillator\n8B) Feature Formula: UO = 100 * [(4 * BP1 + 2 * BP2 + BP3) / (4 * TR1 + 2 * TR2 + TR3)]\n8C) Feature Definition: A range-bound oscillator that uses three different time periods to reduce volatility and noise.\n8D) Feature Parameters: {\"BP\": \"Buying Pressure\", \"TR\": \"True Range\"}\n\n9A) Feature Name: Williams %R\n9B) Feature Formula: %R = (Highest High - Close) / (Highest High - Lowest Low) * -100\n9C) Feature Definition: A momentum indicator that measures overbought and oversold levels.\n9D) Feature Parameters: {\"Close\": \"Most recent closing price\", \"Lowest Low\": \"Lowest price in the look-back period\", \"Highest High\": \"Highest price in the look-back period\"}\n\n10A) Feature Name: Money Flow Index (MFI)\n10B) Feature Formula: MFI = 100 - (100 / (1 + Money Ratio))\n10C) Feature Definition: A momentum indicator that uses both price and volume to measure buying and selling pressure.\n10D) Feature Parameters: {\"Money Ratio\": \"(Typical Price * Volume) on up days / (Typical Price * Volume) on down days\"}"
      },
      "finish_reason": "stop"
    }
  ],
  "usage": {
    "prompt_tokens": 213,
    "completion_tokens": 928,
    "total_tokens": 1141
  }
}
2023-09-14 07:42:47,908 [INFO] - feature_name: Relative Strength Index (RSI), feature_formula: RSI = 100 - (100 / (1 + RS)),  feature_definition: A momentum indicator that measures the speed and change of price movements., feature_parameters: {"RS": "Average gain of up periods / Average loss of down periods"}
2023-09-14 07:42:47,908 [INFO] - feature_name: Moving Average Convergence Divergence (MACD), feature_formula: MACD = 12-day EMA - 26-day EMA,  feature_definition: A trend-following momentum indicator that shows the relationship between two moving averages of a securitys price., feature_parameters: {"EMA": "Exponential Moving Average"}
2023-09-14 07:42:47,908 [INFO] - feature_name: Stochastic Oscillator, feature_formula: %K = (Current Close - Lowest Low)/(Highest High - Lowest Low) * 100,  feature_definition: A momentum indicator comparing a particular closing price of a security to a range of its prices over a certain period of time., feature_parameters: {"Current Close": "Most recent closing price", "Lowest Low": "Lowest price in the look-back period", "Highest High": "Highest price in the look-back period"}
2023-09-14 07:42:47,908 [INFO] - feature_name: Rate of Change (ROC), feature_formula: ROC = [(Close - Close n periods ago) / (Close n periods ago)] * 100,  feature_definition: A momentum oscillator that measures the percentage change between the current price and the price a certain number of periods ago., feature_parameters: {"Close": "Most recent closing price", "n": "Number of periods"}
2023-09-14 07:42:47,909 [INFO] - feature_name: On Balance Volume (OBV), feature_formula: If close > close(previous day) then OBV = OBV(previous day) + volume,  feature_definition: A momentum indicator that uses volume flow to predict changes in stock price., feature_parameters: {"Close": "Most recent closing price", "Volume": "Number of shares traded"}
2023-09-14 07:42:47,909 [INFO] - feature_name: Average Directional Index (ADX), feature_formula: ADX = 100 * smoothed moving average of absolute value (2 * DM - TR) / (2 * DM + TR),  feature_definition: An indicator that measures trend strength without regard to trend direction., feature_parameters: {"DM": "Directional Movement", "TR": "True Range"}
2023-09-14 07:42:47,909 [INFO] - feature_name: Commodity Channel Index (CCI), feature_formula: CCI = ( Typical Price - Simple Moving Average ) / ( 0.015 * Mean Deviation ),  feature_definition: An oscillator that helps identify price reversals, price extremes, and trend strength., feature_parameters: {"Typical Price": "(High + Low + Close)/3", "Simple Moving Average": "Average of closing price over a specified period", "Mean Deviation": "Average of price deviations from the average price"}
2023-09-14 07:42:47,909 [INFO] - feature_name: Ultimate Oscillator, feature_formula: UO = 100 * [(4 * BP1 + 2 * BP2 + BP3) / (4 * TR1 + 2 * TR2 + TR3)],  feature_definition: A range-bound oscillator that uses three different time periods to reduce volatility and noise., feature_parameters: {"BP": "Buying Pressure", "TR": "True Range"}
2023-09-14 07:42:47,909 [INFO] - feature_name: Williams %R, feature_formula: %R = (Highest High - Close) / (Highest High - Lowest Low) * -100,  feature_definition: A momentum indicator that measures overbought and oversold levels., feature_parameters: {"Close": "Most recent closing price", "Lowest Low": "Lowest price in the look-back period", "Highest High": "Highest price in the look-back period"}
2023-09-14 07:42:47,911 [INFO] - 127.0.0.1 - - [14/Sep/2023 07:42:47] "POST /handle_query HTTP/1.1" 200 -
2023-09-14 07:44:29,289 [INFO] - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5010
 * Running on http://198.18.192.23:5010
2023-09-14 07:44:29,289 [INFO] - [33mPress CTRL+C to quit[0m
2023-09-14 07:44:30,790 [INFO] - Processing /selected_papers request...
2023-09-14 07:44:30,791 [INFO] - Data received: {'user_id': 'nereus@outlook.com', 'query': 'tell me which features are related to momentum stock trading'}
2023-09-14 07:44:30,818 [DEBUG] - message='Request to OpenAI API' method=post path=https://api.openai.com/v1/chat/completions
2023-09-14 07:44:30,819 [DEBUG] - api_version=None data='{"model": "gpt-4", "messages": [{"role": "system", "content": "You are an AI assistant that provides helpful answers."}, {"role": "user", "content": "\\n    As an AI, I should understand question and provide information about 10 features in a specific format. For each feature, I need to provide feature in following format\\n\\n    1A) Feature Name: The name of the feature\\n    1B) Feature Formula: The mathematical formula for the feature\\n    1C) Feature Definition: A brief description or definition of the feature\\n    1D) Feature Parameters: Parameters or variables used in the feature formula as json format, pls provide json format\\n\\n    and number each one incrementally (so feature #2 is 2A, 2B..feature #3 is 3A, feature #4 is 4A, feature #5 is 5A... feature #10 is 10A\\n    This is my question:\\n    tell me which features are related to momentum stock trading\\n\\n    Please provide the 10 feature information according to the above format.\\n    "}], "max_tokens": 2000, "n": 1, "stop": null, "temperature": 0.7}' message='Post details'
2023-09-14 07:44:30,819 [DEBUG] - Converted retries value: 2 -> Retry(total=2, connect=None, read=None, redirect=None, status=None)
2023-09-14 07:44:30,823 [DEBUG] - Starting new HTTPS connection (1): api.openai.com:443
2023-09-14 07:46:34,642 [DEBUG] - https://api.openai.com:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2023-09-14 07:46:34,643 [DEBUG] - message='OpenAI API response' path=https://api.openai.com/v1/chat/completions processing_ms=108009 request_id=e369d19d8f7f944fd278af956a23b774 response_code=200
2023-09-14 07:46:34,658 [INFO] - OpenAI API Response: {
  "id": "chatcmpl-7yg05EcuWgzQTFWdx452Ns4EkxQAu",
  "object": "chat.completion",
  "created": 1694695485,
  "model": "gpt-4-0613",
  "choices": [
    {
      "index": 0,
      "message": {
        "role": "assistant",
        "content": "Sure, here are 10 features related to momentum stock trading.\n\n1A) Feature Name: Relative Strength Index (RSI)\n1B) Feature Formula: RSI = 100 - (100 / (1 + RS))\n1C) Feature Definition: The Relative Strength Index (RSI) is a momentum indicator that measures the speed and change of price movements. \n1D) Feature Parameters: {\"RS\": \"Average gain of up periods during the specified time frame / Average loss of down periods during the specified time frame\"}\n\n2A) Feature Name: Moving Average Convergence Divergence (MACD) \n2B) Feature Formula: MACD = 12-Period EMA - 26-Period EMA  \n2C) Feature Definition: The MACD is a trend-following momentum indicator that shows the relationship between two moving averages of a security\u2019s price. \n2D) Feature Parameters: {\"12-Period EMA\": \"Short-term EMA\", \"26-Period EMA\": \"Long-term EMA\"}\n\n3A) Feature Name: Stochastic Oscillator\n3B) Feature Formula: %K = (Current Close - Lowest Low) / (Highest High - Lowest Low) * 100\n3C) Feature Definition: The stochastic oscillator is a momentum indicator comparing a particular closing price of a security to a range of its prices over a certain period of time.\n3D) Feature Parameters: {\"Current Close\": \"Most recent closing price\", \"Lowest Low\": \"Lowest price in the lookback period\", \"Highest High\": \"Highest price in the lookback period\"}\n\n4A) Feature Name: Price Rate Of Change (ROC)\n4B) Feature Formula: ROC = [(Close - Close n periods ago) / (Close n periods ago)] * 100\n4C) Feature Definition: ROC is a momentum oscillator, which measures the percentage change between the current price and the price a certain number of periods ago.\n4D) Feature Parameters: {\"Close\": \"Most recent closing price\", \"Close n periods ago\": \"Closing price n periods ago\"}\n\n5A) Feature Name: On Balance Volume (OBV)\n5B) Feature Formula: If today's close > yesterday's close then: OBV = yesterday's OBV + today's volume\n5C) Feature Definition: OBV is a momentum indicator that uses volume flow to predict changes in stock price.\n5D) Feature Parameters: {\"today's close\": \"Current day's closing price\", \"yesterday's close\": \"Previous day's closing price\", \"today's volume\": \"Current day's trading volume\"}\n\n6A) Feature Name: Ultimate Oscillator\n6B) Feature Formula: UO = 100 x [(4 x BP7)+(2 x BP14)+BP28] / [(4 x TR7)+(2 x TR14)+TR28]\n6C) Feature Definition: The ultimate oscillator is a technical indicator used to measure market momentum and to identify potential short-term buying or selling opportunities.\n6D) Feature Parameters: {\"BP7\": \"7-period buying pressure\", \"BP14\": \"14-period buying pressure\", \"BP28\": \"28-period buying pressure\", \"TR7\": \"7-period true range\", \"TR14\": \"14-period true range\", \"TR28\": \"28-period true range\"}\n\n7A) Feature Name: Average Directional Index (ADX)\n7B) Feature Formula: ADX = 100 * EMA[(+DI - -DI)/(+DI + -DI)]\n7C) Feature Definition: The Average Directional Index (ADX) is a technical analysis indicator used by some traders to determine the strength of a trend.\n7D) Feature Parameters: {\"+DI\": \"Positive Directional Indicator\", \"-DI\": \"Negative Directional Indicator\"}\n\n8A) Feature Name: Bollinger Bands\n8B) Feature Formula: Middle Band = 20-day simple moving average (SMA), Upper Band = 20-day SMA + (20-day standard deviation of price x 2), Lower Band = 20-day SMA - (20-day standard deviation of price x 2)\n8C) Feature Definition: Bollinger Bands are a volatility indicator and commonly used in stock trading to identify the volatility and relative price levels over a period.\n8D) Feature Parameters: {\"20-day SMA\": \"20-day simple moving average\", \"20-day standard deviation of price\": \"20-day standard deviation of the price\"}\n\n9A) Feature Name: Money Flow Index (MFI)\n9B) Feature Formula: MFI = 100 - (100 / (1 + Money Ratio))\n9C) Feature Definition: The Money Flow Index (MFI) is a momentum indicator that measures the inflow and outflow of money into a security over a specific period of time.\n9D) Feature Parameters: {\"Money Ratio\": \"Money Flow over the period\"}\n\n10A) Feature Name: Force Index\n10B) Feature Formula: Force Index = [Today\u2019s Close - Yesterday\u2019s Close] x Today\u2019s Volume\n10C) Feature Definition: The Force Index is a measure of the power or force behind a move. This force is determined by multiplying the difference in price by the period's volume.\n10D) Feature Parameters: {\"Today\u2019s Close\": \"Today's closing price\", \"Yesterday\u2019s Close\": \"Previous day's closing price\", \"Today\u2019s Volume\": \"Today's trading volume\"}"
      },
      "finish_reason": "stop"
    }
  ],
  "usage": {
    "prompt_tokens": 213,
    "completion_tokens": 1109,
    "total_tokens": 1322
  }
}
2023-09-14 07:46:56,335 [ERROR] - Exception on /handle_query [POST]
Traceback (most recent call last):
  File "D:\Workspace\Upwork\5.Refactor Python OpenAI logic\task.py", line 139, in insert_db
    cursor.execute(sql)
psycopg2.errors.SyntaxError: syntax error at or near "s"
LINE 1: ...ow to predict changes in stock price.', 'If today's close > ...
                                                             ^


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\flask\app.py", line 2190, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\flask\app.py", line 1486, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\flask_cors\extension.py", line 176, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\flask\app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\flask\app.py", line 1469, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "D:\Workspace\Upwork\5.Refactor Python OpenAI logic\task.py", line 220, in handle_query
    insert_db(user_id, query, features_info)
  File "D:\Workspace\Upwork\5.Refactor Python OpenAI logic\task.py", line 142, in insert_db
    except error:
UnboundLocalError: local variable 'error' referenced before assignment
2023-09-14 07:46:56,338 [INFO] - 127.0.0.1 - - [14/Sep/2023 07:46:56] "[35m[1mPOST /handle_query HTTP/1.1[0m" 500 -
2023-09-14 07:49:26,610 [INFO] - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5010
 * Running on http://198.18.192.23:5010
2023-09-14 07:49:26,610 [INFO] - [33mPress CTRL+C to quit[0m
2023-09-14 07:49:27,526 [INFO] - Processing /selected_papers request...
2023-09-14 07:49:27,527 [INFO] - Data received: {'user_id': 'nereus@outlook.com', 'query': 'tell me which features are related to momentum stock trading'}
2023-09-14 07:49:27,556 [DEBUG] - message='Request to OpenAI API' method=post path=https://api.openai.com/v1/chat/completions
2023-09-14 07:49:27,556 [DEBUG] - api_version=None data='{"model": "gpt-4", "messages": [{"role": "system", "content": "You are an AI assistant that provides helpful answers."}, {"role": "user", "content": "\\n    As an AI, I should understand question and provide information about 10 features in a specific format. For each feature, I need to provide feature in following format\\n\\n    1A) Feature Name: The name of the feature\\n    1B) Feature Formula: The mathematical formula for the feature\\n    1C) Feature Definition: A brief description or definition of the feature\\n    1D) Feature Parameters: Parameters or variables used in the feature formula as json format, pls provide json format\\n\\n    and number each one incrementally (so feature #2 is 2A, 2B..feature #3 is 3A, feature #4 is 4A, feature #5 is 5A... feature #10 is 10A\\n    This is my question:\\n    tell me which features are related to momentum stock trading\\n\\n    Please provide the 10 feature information according to the above format.\\n    "}], "max_tokens": 2000, "n": 1, "stop": null, "temperature": 0.7}' message='Post details'
2023-09-14 07:49:27,556 [DEBUG] - Converted retries value: 2 -> Retry(total=2, connect=None, read=None, redirect=None, status=None)
2023-09-14 07:49:27,559 [DEBUG] - Starting new HTTPS connection (1): api.openai.com:443
2023-09-14 07:51:14,449 [DEBUG] - https://api.openai.com:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2023-09-14 07:51:14,451 [DEBUG] - message='OpenAI API response' path=https://api.openai.com/v1/chat/completions processing_ms=105112 request_id=a549f0917b4868fdcb8f7c329dd4c8bb response_code=200
2023-09-14 07:51:14,465 [INFO] - OpenAI API Response: {
  "id": "chatcmpl-7yg4esVwzFLL9yymwz7WRO8ViHQP5",
  "object": "chat.completion",
  "created": 1694695768,
  "model": "gpt-4-0613",
  "choices": [
    {
      "index": 0,
      "message": {
        "role": "assistant",
        "content": "1A) Feature Name: Moving Average\n1B) Feature Formula: MA = (P1 + P2 + P3 + ... + Pn) / n\n1C) Feature Definition: The Moving Average is a widely used indicator in technical analysis that helps smooth out price action by filtering out the \u201cnoise\u201d from random price fluctuations.\n1D) Feature Parameters: {\"Pn\": \"Price at day n\", \"n\": \"Number of days\"}\n\n2A) Feature Name: Relative Strength Index (RSI)\n2B) Feature Formula: RSI = 100 - (100 / (1 + RS))\n2C) Feature Definition: The Relative Strength Index (RSI) is a momentum indicator that measures the speed and change of price movements.\n2D) Feature Parameters: {\"RS\": \"Average gain / Average loss\"}\n\n3A) Feature Name: Moving Average Convergence Divergence (MACD)\n3B) Feature Formula: MACD = 12-Period EMA - 26-Period EMA\n3C) Feature Definition: MACD is a trend-following momentum indicator that shows the relationship between two moving averages of a security\u2019s price.\n3D) Feature Parameters: {\"EMA\": \"Exponential Moving Average\"}\n\n4A) Feature Name: Stochastic Oscillator\n4B) Feature Formula: %K = (Closing Price - Lowest Low) / (Highest High - Lowest Low) * 100\n4C) Feature Definition: The Stochastic Oscillator is a momentum indicator comparing a particular closing price of a security to a range of its prices over a certain period of time.\n4D) Feature Parameters: {\"Closing Price\": \"Latest closing price\", \"Highest High\": \"Highest price in the lookback period\", \"Lowest Low\": \"Lowest price in the lookback period\"}\n\n5A) Feature Name: Volume\n5B) Feature Formula: V = \u03a3 volume of shares traded\n5C) Feature Definition: Volume is the total number of shares traded in a security or market during a given period.\n5D) Feature Parameters: {\"Volume of shares traded\": \"Number of shares traded during a specific period\"}\n\n6A) Feature Name: On Balance Volume (OBV)\n6B) Feature Formula: If close > close previous day then OBV = OBVprev + volume, else if close < close previous day then OBV = OBVprev - volume\n6C) Feature Definition: OBV is a technical trading momentum indicator that uses volume flow to predict changes in stock price.\n6D) Feature Parameters: {\"OBVprev\": \"Previous OBV value\", \"Volume\": \"Current trading volume\"}\n\n7A) Feature Name: Accumulation/Distribution Line (ADL)\n7B) Feature Formula: ADL = ((Close - Low) - (High - Close)) / (High - Low) * Volume + Previous ADL\n7C) Feature Definition: The Accumulation Distribution Line is a volume-based indicator designed to measure the cumulative flow of money into and out of a security.\n7D) Feature Parameters: {\"Close\": \"Closing price\", \"Low\": \"Lowest price\", \"High\": \"Highest price\", \"Volume\": \"Volume of the period\", \"Previous ADL\": \"Previous period ADL\"}\n\n8A) Feature Name: Price Rate of Change (ROC)\n8B) Feature Formula: ROC = [(Close - Close n periods ago) / (Close n periods ago)] * 100\n8C) Feature Definition: The Price Rate of Change is a momentum oscillator that measures the percentage change in price between the current price and the price a certain number of periods ago.\n8D) Feature Parameters: {\"Close\": \"Current closing price\", \"Close n periods ago\": \"Closing price n periods ago\"}\n\n9A) Feature Name: Money Flow Index (MFI)\n9B) Feature Formula: MFI = 100 - (100 / (1 + Money Ratio))\n9C) Feature Definition: The Money Flow Index is a momentum indicator that measures the flow of money into and out of a security over a specified period of time.\n9D) Feature Parameters: {\"Money Ratio\": \"Positive money flow / Negative money flow over a certain period\"}\n\n10A) Feature Name: Bollinger Bands\n10B) Feature Formula: Middle Band = 20-day simple moving average (SMA), Upper Band = 20-day SMA + (20-day standard deviation of price x 2), Lower Band = 20-day SMA - (20-day standard deviation of price x 2)\n10C) Feature Definition: Bollinger Bands are a volatility indicator and commonly used in stock trading to determine overbought and oversold levels.\n10D) Feature Parameters: {\"SMA\": \"Simple Moving Average\", \"Standard deviation\": \"Standard deviation of price over 20 days\"}"
      },
      "finish_reason": "stop"
    }
  ],
  "usage": {
    "prompt_tokens": 213,
    "completion_tokens": 991,
    "total_tokens": 1204
  }
}
2023-09-14 07:59:31,912 [INFO] - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5010
 * Running on http://198.18.192.23:5010
2023-09-14 07:59:31,912 [INFO] - [33mPress CTRL+C to quit[0m
2023-09-14 08:00:30,795 [INFO] - Processing /selected_papers request...
2023-09-14 08:00:30,796 [INFO] - Data received: {'user_id': 'nereus@outlook.com', 'query': 'tell me which features are related to momentum stock trading'}
2023-09-14 08:00:30,846 [DEBUG] - message='Request to OpenAI API' method=post path=https://api.openai.com/v1/chat/completions
2023-09-14 08:00:30,846 [DEBUG] - api_version=None data='{"model": "gpt-4", "messages": [{"role": "system", "content": "You are an AI assistant that provides helpful answers."}, {"role": "user", "content": "\\n    As an AI, I should understand question and provide information about 10 features in a specific format. For each feature, I need to provide feature in following format\\n\\n    1A) Feature Name: The name of the feature\\n    1B) Feature Formula: The mathematical formula for the feature\\n    1C) Feature Definition: A brief description or definition of the feature\\n    1D) Feature Parameters: Parameters or variables used in the feature formula as json format, pls provide json format\\n\\n    and number each one incrementally (so feature #2 is 2A, 2B..feature #3 is 3A, feature #4 is 4A, feature #5 is 5A... feature #10 is 10A\\n    This is my question:\\n    tell me which features are related to momentum stock trading\\n\\n    Please provide the 10 feature information according to the above format.\\n    "}], "max_tokens": 2000, "n": 1, "stop": null, "temperature": 0.7}' message='Post details'
2023-09-14 08:00:30,847 [DEBUG] - Converted retries value: 2 -> Retry(total=2, connect=None, read=None, redirect=None, status=None)
2023-09-14 08:00:30,849 [DEBUG] - Starting new HTTPS connection (1): api.openai.com:443
2023-09-14 08:02:25,380 [DEBUG] - https://api.openai.com:443 "POST /v1/chat/completions HTTP/1.1" 200 None
2023-09-14 08:02:25,382 [DEBUG] - message='OpenAI API response' path=https://api.openai.com/v1/chat/completions processing_ms=105650 request_id=550ac86bf8606f39bf9b0109dd28feca response_code=200
2023-09-14 08:02:25,396 [INFO] - OpenAI API Response: {
  "id": "chatcmpl-7ygFQXqiv2nxTIIe1dzCSJplAXXcv",
  "object": "chat.completion",
  "created": 1694696436,
  "model": "gpt-4-0613",
  "choices": [
    {
      "index": 0,
      "message": {
        "role": "assistant",
        "content": "1A) Feature Name: Moving Average Convergence Divergence (MACD)\n1B) Feature Formula: MACD = 12-Period EMA - 26-Period EMA\n1C) Feature Definition: The MACD is a trend-following momentum indicator that shows the relationship between two moving averages of a stock's price.\n1D) Feature Parameters: {\"12-Period EMA\": \"Shorter Exponential Moving Average\", \"26-Period EMA\": \"Longer Exponential Moving Average\"}\n\n2A) Feature Name: Relative Strength Index (RSI)\n2B) Feature Formula: RSI = 100 - (100 / (1 + RS))\n2C) Feature Definition: RSI compares the magnitude of recent gains and losses over a specified time period to measure speed and change of price movements.\n2D) Feature Parameters: {\"RS\": \"Average gain / Average loss\"}\n\n3A) Feature Name: Stochastic Oscillator\n3B) Feature Formula: %K = (Current Close - Lowest Low)/(Highest High - Lowest Low) * 100\n3C) Feature Definition: The stochastic oscillator is a momentum indicator comparing a particular closing price of a security to a range of its prices over a certain period of time.\n3D) Feature Parameters: {\"Current Close\": \"Most recent closing price\", \"Lowest Low\": \"Lowest price in lookback period\", \"Highest High\": \"Highest price in lookback period\"}\n\n4A) Feature Name: Bollinger Bands\n4B) Feature Formula: Middle Band = 20-day simple moving average (SMA), Upper Band = 20-day SMA + (20-day standard deviation of price x 2), Lower Band = 20-day SMA - (20-day standard deviation of price x 2)\n4C) Feature Definition: Bollinger Bands are a volatility indicator and commonly used in stock trading to identify 'overbought' or 'oversold' levels.\n4D) Feature Parameters: {\"20-day SMA\": \"20-day Simple Moving Average\", \"20-day standard deviation\": \"Standard deviation of price over last 20 days\"}\n\n5A) Feature Name: Volume\n5B) Feature Formula: Volume = Sum of shares traded\n5C) Feature Definition: Volume is the number of shares or contracts traded in a security or market during a given period.\n5D) Feature Parameters: {\"Shares traded\": \"Number of shares traded during a specific period\"}\n\n6A) Feature Name: On-Balance Volume (OBV)\n6B) Feature Formula: If close > close previous day then OBV = OBVprev + volume today, If close < close previous day then OBV = OBVprev - volume today\n6C) Feature Definition: OBV uses volume flow to predict changes in stock price.\n6D) Feature Parameters: {\"OBVprev\": \"Previous OBV value\", \"volume today\": \"Today's trading volume\"}\n\n7A) Feature Name: Price Rate Of Change (ROC)\n7B) Feature Formula: ROC = [(Close - Close n periods ago) / (Close n periods ago)] * 100\n7C) Feature Definition: ROC is a momentum oscillator that measures the percentage change in price between the current price and the price a certain number of periods ago.\n7D) Feature Parameters: {\"Close\": \"Current close price\", \"Close n periods ago\": \"Close price n periods ago\"}\n\n8A) Feature Name: Average True Range (ATR)\n8B) Feature Formula: ATR = 1/n * \u2211 TR (where TR = max[(high - low), abs(high - close previous), abs(low - close previous)])\n8C) Feature Definition: ATR is a market volatility indicator used in technical analysis.\n8D) Feature Parameters: {\"TR\": \"True Range\", \"n\": \"Time period\"}\n\n9A) Feature Name: Momentum\n9B) Feature Formula: Momentum = Closing Price now - Closing Price n periods ago\n9C) Feature Definition: Momentum is the rate of acceleration of a stock's price or volume.\n9D) Feature Parameters: {\"Closing Price now\": \"The most recent closing price\", \"Closing Price n periods ago\": \"Closing price n periods ago\"}\n\n10A) Feature Name: Money Flow Index (MFI)\n10B) Feature Formula: MFI = 100 - (100 / (1 + Money Ratio))\n10C) Feature Definition: The MFI is a momentum indicator that measures the inflow and outflow of money into a security over a specific period of time.\n10D) Feature Parameters: {\"Money Ratio\": \"Positive money flow / Negative money flow\"}"
      },
      "finish_reason": "stop"
    }
  ],
  "usage": {
    "prompt_tokens": 213,
    "completion_tokens": 952,
    "total_tokens": 1165
  }
}
2023-09-14 08:02:54,507 [ERROR] - Exception on /handle_query [POST]
Traceback (most recent call last):
  File "D:\Workspace\Upwork\5.Refactor Python OpenAI logic\task.py", line 139, in insert_db
    cursor.execute(sql)
psycopg2.errors.SyntaxError: syntax error at or near "s"
LINE 1: ...lationship between two moving averages of a stock's price.',...
                                                             ^


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\flask\app.py", line 2190, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\flask\app.py", line 1486, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\flask_cors\extension.py", line 176, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\flask\app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\flask\app.py", line 1469, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "D:\Workspace\Upwork\5.Refactor Python OpenAI logic\task.py", line 220, in handle_query
    insert_db(user_id, query, features_info)
  File "D:\Workspace\Upwork\5.Refactor Python OpenAI logic\task.py", line 142, in insert_db
    except error:
UnboundLocalError: local variable 'error' referenced before assignment
2023-09-14 08:02:54,510 [INFO] - 127.0.0.1 - - [14/Sep/2023 08:02:54] "[35m[1mPOST /handle_query HTTP/1.1[0m" 500 -
2023-09-14 08:07:28,541 [INFO] - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5010
 * Running on http://172.20.102.14:5010
2023-09-14 08:07:28,541 [INFO] - [33mPress CTRL+C to quit[0m
2023-09-14 08:07:39,212 [INFO] - Processing /selected_papers request...
2023-09-14 08:07:39,213 [INFO] - Data received: {'user_id': 'nereus@outlook.com', 'query': 'tell me which features are related to momentum stock trading'}
2023-09-14 08:07:39,246 [DEBUG] - message='Request to OpenAI API' method=post path=https://api.openai.com/v1/chat/completions
2023-09-14 08:07:39,246 [DEBUG] - api_version=None data='{"model": "gpt-4", "messages": [{"role": "system", "content": "You are an AI assistant that provides helpful answers."}, {"role": "user", "content": "\\n    As an AI, I should understand question and provide information about 10 features in a specific format. For each feature, I need to provide feature in following format\\n\\n    1A) Feature Name: The name of the feature\\n    1B) Feature Formula: The mathematical formula for the feature\\n    1C) Feature Definition: A brief description or definition of the feature\\n    1D) Feature Parameters: Parameters or variables used in the feature formula as json format, pls provide json format\\n\\n    and number each one incrementally (so feature #2 is 2A, 2B..feature #3 is 3A, feature #4 is 4A, feature #5 is 5A... feature #10 is 10A\\n    This is my question:\\n    tell me which features are related to momentum stock trading\\n\\n    Please provide the 10 feature information according to the above format.\\n    "}], "max_tokens": 2000, "n": 1, "stop": null, "temperature": 0.7}' message='Post details'
2023-09-14 08:07:39,247 [DEBUG] - Converted retries value: 2 -> Retry(total=2, connect=None, read=None, redirect=None, status=None)
2023-09-14 08:07:39,252 [DEBUG] - Starting new HTTPS connection (1): api.openai.com:443
2023-09-14 08:08:00,377 [DEBUG] - Incremented Retry for (url='/v1/chat/completions'): Retry(total=1, connect=None, read=None, redirect=None, status=None)
2023-09-14 08:08:00,377 [WARNING] - Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'ConnectTimeoutError(<urllib3.connection.HTTPSConnection object at 0x0000015D376C10C0>, 'Connection to api.openai.com timed out. (connect timeout=600)')': /v1/chat/completions
2023-09-14 08:08:00,377 [DEBUG] - Starting new HTTPS connection (2): api.openai.com:443
2023-09-14 08:08:21,419 [DEBUG] - Incremented Retry for (url='/v1/chat/completions'): Retry(total=0, connect=None, read=None, redirect=None, status=None)
2023-09-14 08:08:21,419 [WARNING] - Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'ConnectTimeoutError(<urllib3.connection.HTTPSConnection object at 0x0000015D376C1240>, 'Connection to api.openai.com timed out. (connect timeout=600)')': /v1/chat/completions
2023-09-14 08:08:21,420 [DEBUG] - Starting new HTTPS connection (3): api.openai.com:443
2023-09-14 08:08:42,468 [ERROR] - Exception on /handle_query [POST]
Traceback (most recent call last):
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\urllib3\connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\urllib3\util\connection.py", line 95, in create_connection
    raise err
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\urllib3\util\connection.py", line 85, in create_connection
    sock.connect(sa)
TimeoutError: [WinError 10060] A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\urllib3\connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\urllib3\connectionpool.py", line 403, in _make_request
    self._validate_conn(conn)
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\urllib3\connectionpool.py", line 1053, in _validate_conn
    conn.connect()
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\urllib3\connection.py", line 363, in connect
    self.sock = conn = self._new_conn()
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\urllib3\connection.py", line 179, in _new_conn
    raise ConnectTimeoutError(
urllib3.exceptions.ConnectTimeoutError: (<urllib3.connection.HTTPSConnection object at 0x0000015D376C13C0>, 'Connection to api.openai.com timed out. (connect timeout=600)')

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\requests\adapters.py", line 440, in send
    resp = conn.urlopen(
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\urllib3\connectionpool.py", line 826, in urlopen
    return self.urlopen(
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\urllib3\connectionpool.py", line 826, in urlopen
    return self.urlopen(
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\urllib3\connectionpool.py", line 798, in urlopen
    retries = retries.increment(
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\urllib3\util\retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='api.openai.com', port=443): Max retries exceeded with url: /v1/chat/completions (Caused by ConnectTimeoutError(<urllib3.connection.HTTPSConnection object at 0x0000015D376C13C0>, 'Connection to api.openai.com timed out. (connect timeout=600)'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\openai\api_requestor.py", line 596, in request_raw
    result = _thread_context.session.request(
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\requests\sessions.py", line 529, in request
    resp = self.send(prep, **send_kwargs)
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\requests\sessions.py", line 645, in send
    r = adapter.send(request, **kwargs)
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\requests\adapters.py", line 507, in send
    raise ConnectTimeout(e, request=request)
requests.exceptions.ConnectTimeout: HTTPSConnectionPool(host='api.openai.com', port=443): Max retries exceeded with url: /v1/chat/completions (Caused by ConnectTimeoutError(<urllib3.connection.HTTPSConnection object at 0x0000015D376C13C0>, 'Connection to api.openai.com timed out. (connect timeout=600)'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\flask\app.py", line 2190, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\flask\app.py", line 1486, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\flask_cors\extension.py", line 176, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\flask\app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\flask\app.py", line 1469, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "D:\Workspace\Upwork\5.Refactor Python OpenAI logic\task.py", line 206, in handle_query
    ai_chat = chat_with_ai(prompt)
  File "D:\Workspace\Upwork\5.Refactor Python OpenAI logic\task.py", line 104, in chat_with_ai
    response = openai.ChatCompletion.create(
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\openai\api_resources\chat_completion.py", line 25, in create
    return super().create(*args, **kwargs)
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\openai\api_resources\abstract\engine_api_resource.py", line 153, in create
    response, _, api_key = requestor.request(
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\openai\api_requestor.py", line 288, in request
    result = self.request_raw(
  File "C:\Users\Umi\AppData\Local\Programs\Python\Python310\lib\site-packages\openai\api_requestor.py", line 607, in request_raw
    raise error.Timeout("Request timed out: {}".format(e)) from e
openai.error.Timeout: Request timed out: HTTPSConnectionPool(host='api.openai.com', port=443): Max retries exceeded with url: /v1/chat/completions (Caused by ConnectTimeoutError(<urllib3.connection.HTTPSConnection object at 0x0000015D376C13C0>, 'Connection to api.openai.com timed out. (connect timeout=600)'))
2023-09-14 08:08:42,775 [INFO] - 127.0.0.1 - - [14/Sep/2023 08:08:42] "[35m[1mPOST /handle_query HTTP/1.1[0m" 500 -
2023-09-14 10:22:50,106 [INFO] - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5010
 * Running on http://198.18.192.32:5010
2023-09-14 10:22:50,106 [INFO] - [33mPress CTRL+C to quit[0m
